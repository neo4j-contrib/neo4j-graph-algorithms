<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.3">
<title>Neo4j Graph Algorithms User Guide</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
body{-webkit-font-smoothing:antialiased}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
body{tab-size:4}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Neo4j Graph Algorithms User Guide</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">Introduction</a>
<ul class="sectlevel2">
<li><a href="#_algorithms">Algorithms</a></li>
<li><a href="#_installation">Installation</a></li>
<li><a href="#_usage">Usage</a></li>
<li><a href="#_graph_loading">Graph Loading</a></li>
<li><a href="#_building_locally">Building Locally</a></li>
</ul>
</li>
<li><a href="#_yelp">Yelp</a>
<ul class="sectlevel2">
<li><a href="#_yelp_open_dataset">Yelp Open Dataset</a></li>
<li><a href="#_data">Data</a></li>
<li><a href="#_graph_model">Graph Model</a></li>
<li><a href="#_import">Import</a></li>
<li><a href="#_networks">Networks</a></li>
</ul>
</li>
<li><a href="#_overview_of_algorithm_procedures">Overview of Algorithm Procedures</a></li>
<li><a href="#_algorithms_2">Algorithms</a>
<ul class="sectlevel2">
<li><a href="#_page_rank">Page Rank</a></li>
<li><a href="#_betweenness_centrality">Betweenness Centrality</a></li>
<li><a href="#_closeness_centrality">Closeness Centrality</a></li>
<li><a href="#_harmonic_centrality">Harmonic Centrality</a></li>
<li><a href="#_minimum_weight_spanning_tree">Minimum Weight Spanning Tree</a></li>
<li><a href="#_single_source_shortest_path">Single Source Shortest Path</a></li>
<li><a href="#_all_pairs_shortest_path">All Pairs Shortest Path</a></li>
<li><a href="#_community_detection_triangle_counting_clustering_coefficient">Community detection: Triangle Counting / Clustering Coefficient</a></li>
<li><a href="#_community_detection_label_propagation">Community detection: Label Propagation</a></li>
<li><a href="#_community_detection_louvain">Community detection: Louvain</a></li>
<li><a href="#_community_detection_connected_components">Community detection: Connected Components</a></li>
<li><a href="#_community_detection_strongly_connected_components">Community detection: Strongly Connected Components</a></li>
</ul>
</li>
<li><a href="#_implementers_section">Implementers Section</a>
<ul class="sectlevel2">
<li><a href="#_algorithm_procedures_api_discussion">Algorithm Procedures API Discussion</a></li>
<li><a href="#_api_documentation">API Documentation</a></li>
<li><a href="#_pagerank">PageRank</a></li>
<li><a href="#_betweenness_centrality_2">Betweenness Centrality</a></li>
<li><a href="#_closeness_centrality_2">Closeness Centrality</a></li>
<li><a href="#_harmonic_centrality_2">Harmonic Centrality</a></li>
<li><a href="#_minimum_weight_spanning_tree_2">Minimum Weight Spanning Tree</a></li>
<li><a href="#_single_shortest_path">Single Shortest Path</a></li>
<li><a href="#_all_pairs_shortest_path_2">All Pairs Shortest Path</a></li>
<li><a href="#_triangle_count">Triangle Count</a></li>
<li><a href="#_label_propagation">Label Propagation</a></li>
<li><a href="#_louvain">Louvain</a></li>
<li><a href="#_weakly_connected_components">Weakly Connected Components</a></li>
<li><a href="#_strongly_connected_components">Strongly Connected Components</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_introduction"><a class="link" href="#_introduction">Introduction</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This library provides efficiently implemented, parallel versions of common graph algorithms for Neo4j 3.x exposed as Cypher procedures.</p>
</div>
<div class="paragraph">
<p>Releases are available here: <a href="https://github.com/neo4j-contrib/neo4j-graph-algorithms/releases" class="bare">https://github.com/neo4j-contrib/neo4j-graph-algorithms/releases</a></p>
</div>
<div class="sect2">
<h3 id="_algorithms"><a class="link" href="#_algorithms">Algorithms</a></h3>
<div class="sect3">
<h4 id="_centralities"><a class="link" href="#_centralities">Centralities</a></h4>
<div class="paragraph">
<p>These algorithms determine the importance of distinct nodes in a network.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Page Rank (<code>algo.pageRank</code>)</p>
</li>
<li>
<p>Betweenness Centrality (<code>algo.betweenness</code>)</p>
</li>
<li>
<p>Closeness Centrality (<code>algo.closeness</code>)</p>
</li>
<li>
<p>Harmonic Centrality (<code>algo.harmonic</code>)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_community_detection"><a class="link" href="#_community_detection">Community Detection</a></h4>
<div class="paragraph">
<p>These algorithms evaluate how a group is clustered or partitioned, as well as its tendency to strengthen or break apart.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Louvain (<code>algo.louvain</code>)</p>
</li>
<li>
<p>Label Propagation (<code>algo.labelPropagation</code>)</p>
</li>
<li>
<p>(Weakly) Connected Components (<code>algo.unionFind</code>)</p>
</li>
<li>
<p>Strongly Connected Components (<code>algo.scc</code>)</p>
</li>
<li>
<p>Triangle Count / Clustering Coefficient (<code>algo.triangleCount</code>)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_path_finding"><a class="link" href="#_path_finding">Path Finding</a></h4>
<div class="paragraph">
<p>These algorithms help find the shortest path or evaluate the availability and quality of routes.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Minimum Weight Spanning Tree (<code>algo.mst</code>)</p>
</li>
<li>
<p>All Pairs- and Single Source - Shortest Path (<code>algo.shortestPath</code>, <code>algo.allShortestPaths</code>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These procedures work either on the whole graph or on a subgraph filtered by label and relationship-type.
You can also use <a href="#cypher-projections">filtering and projection using Cypher queries</a>.</p>
</div>
<div class="paragraph">
<p><strong>We&#8217;d love your feedback</strong>, so please try out these algorithms and let us know how well they work for your use-case.
Also please note things that are missing from the installation instructions or documentation.</p>
</div>
<div class="paragraph">
<p>Please raise <a href="https://github.com/neo4j-contrib/neo4j-graph-algorithms/issues">GitHub issues</a> for anything you encounter or join the <a href="http://neo4j.com/developer/slack">neo4j-users Slack group</a> and ask in the <code>#neo4j-graph-algorithm</code> channel.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_installation"><a class="link" href="#_installation">Installation</a></h3>
<div class="paragraph">
<p>Download <code>graph-algorithms-algo-*.jar</code> from <a href="https://github.com/neo4j-contrib/neo4j-graph-algorithms/releases">the matching release</a> and copy it into your <code>$NEO4J_HOME/plugins</code> directory.</p>
</div>
<div class="paragraph">
<p>Because the algorithms use the lower level Kernel API to read from and write to Neo4j you will also have to enable them in the configuration (for security reasons):</p>
</div>
<div class="listingblock">
<div class="title">Add to $NEO4J_HOME/conf/neo4j.conf</div>
<div class="content">
<pre>dbms.security.procedures.unrestricted=algo.*</pre>
</div>
</div>
<div class="paragraph">
<p>Once you&#8217;ve done that restart Neo4j and execute the query <code>CALL algo.list()</code> to see a list of all the algorithms.</p>
</div>
</div>
<div class="sect2">
<h3 id="_usage"><a class="link" href="#_usage">Usage</a></h3>
<div class="paragraph">
<p>These algorithms are exposed as Neo4j procedures.
We can call them directly from Cypher in your Neo4j Browser, from cypher-shell, or your client code.</p>
</div>
<div class="paragraph">
<p>For most algorithms we provide two procedures:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>one named <code>algo.&lt;name&gt;</code> that writes results back to the graph as node-properties and reports statistics.</p>
</li>
<li>
<p>another named <code>algo.&lt;name&gt;.stream</code> that returns a stream of data, e.g. node-ids and computed values.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For large graphs the streaming procedure might return millions or billions of results, that&#8217;s why it is often more convenient to store the results of the algorithm and then use them with later queries.</p>
</div>
<div class="paragraph">
<p>We can project the graph we want to run algorithms on with either label and relationship-type projection or cypher projection.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/diag-a91a9570a9e43c309a1ec59b4ededc03.png" alt="diag a91a9570a9e43c309a1ec59b4ededc03" width="750" height="126">
</div>
</div>
<div class="paragraph">
<p>Projected graph model is separate from Neo4j&#8217;s stored graph model to allow fast cache for the topology of the graph containing only relevant nodes, relations and in addition the weights.
For now the projected graph model does not support multiple relationships between a single pair of nodes.
During projection we allow only one relationship between a pair of nodes per direction (in, out) in the directed case but two relationships for BOTH the undirected case.</p>
</div>
<div class="sect3">
<h4 id="_label_and_relationship_type_projection"><a class="link" href="#_label_and_relationship_type_projection">Label and relationship-type projection</a></h4>
<div class="paragraph">
<p>We can project the subgraph we want to run the algorithm on using label parameter to describe nodes and relationship-type to describe relationships.</p>
</div>
<div class="paragraph">
<p>The general call syntax is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.&lt;name&gt;([label],[relationshipType],{config})</code></pre>
</div>
</div>
<div class="paragraph">
<p>e.g. Page Rank on DBpedia (11M nodes, 116M relationships):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.pageRank('Page','Link',{iterations:5, dampingFactor:0.85, write: true, writeProperty:'pagerank'});
// YIELD nodes, iterations, loadMillis, computeMillis, writeMillis, dampingFactor, write, writeProperty

CALL algo.pageRank.stream('Page','Link',{iterations:5, dampingFactor:0.85})
YIELD node, score
RETURN node.title, score
ORDER BY score DESC LIMIT 10;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_cypher_projection"><a class="link" href="#_cypher_projection">Cypher projection</a></h4>
<div class="paragraph">
<p>If label and relationship-type projection is not selective enough to describe our subgraph to run the algorithm on, we can use Cypher statements to project subsets of our graph.
Use a node-statement instead of the label parameter and a relationship-statement instead of the relationship-type and use <code>graph:'cypher'</code> in the config.</p>
</div>
<div class="paragraph">
<p>Relationships described in the relationship-statement will only be projected if both source and target nodes are described in the node-statement.
All other relationships that don&#8217;t have both source and target nodes described in node-statement will be ignored in projection.</p>
</div>
<div class="paragraph">
<p>We can also return a property value or weight (according to our config) in addition to the id&#8217;s from these statements.</p>
</div>
<div class="paragraph">
<p>Cypher projection allows us to be more expressive in describing our subgraph we want to analyse, but might take longer to project the graph with more complex cypher queries.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.pageRank(
'MATCH (p:Page) RETURN id(p) as id',
'MATCH (p1:Page)-[:Link]-&gt;(p2:Page) RETURN id(p1) as source, id(p2) as target',
{graph:'cypher', iterations:5, write: true});</code></pre>
</div>
</div>
<div class="paragraph">
<p>Cypher projection can also be used to project a virtual (non-stored) graph.
Here is an example of how to project an undirected graph of people who visited the same web page and run Louvain community detection algorithm on it using the number of common visited web pages between pairs of people as relationship weight.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.louvain(
'MATCH (p:Person) RETURN id(p) as id',
'MATCH (p1:Person)-[:Visit]-&gt;(:Page)&lt;-[:Visit]-(p2:Person)
RETURN id(p1) as source, id(p2) as target, count(*) as weight',
{graph:'cypher', iterations:5, write: true});</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_graph_loading"><a class="link" href="#_graph_loading">Graph Loading</a></h3>
<div class="paragraph">
<p>As it can take some time to load large graphs into the algorithm data structures, you can pre-load graphs and then later refer to them by name for several graph algorithms.
After usage they can be removed from memory to free resources used.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">// Load graph
CALL algo.graph.load('my-graph','Label','REL_TYPE',{graph:'heavy',..other config...})
  YIELD name, graph, direction, undirected, sorted, nodes, loadMillis, alreadyLoaded,
        nodeWeight, relationshipWeight, nodeProperty, loadNodes, loadRelationships;

// Info on loaded graph
CALL algo.graph.info('my-graph')
  YIELD name, type, exists, removed, nodes;

// Use graph
CALL algo.pageRank(null,null,{graph:'my-graph',...})


// Remove graph
CALL algo.graph.remove('my-graph')
  YIELD name, type, exists, removed, nodes;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_building_locally"><a class="link" href="#_building_locally">Building Locally</a></h3>
<div class="paragraph">
<p>Currently aiming at Neo4j 3.x (with a branch per version)</p>
</div>
<div class="listingblock">
<div class="content">
<pre>git clone https://github.com/neo4j-contrib/neo4j-graph-algorithms
cd neo4j-graph-algorithms
git checkout 3.3
mvn clean install
cp algo/target/graph-algorithms-*.jar $NEO4J_HOME/plugins/
$NEO4J_HOME/bin/neo4j restart</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_yelp"><a class="link" href="#_yelp">Yelp</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_yelp_open_dataset"><a class="link" href="#_yelp_open_dataset">Yelp Open Dataset</a></h3>
<div class="paragraph">
<p><a href="https://www.yelp.com/">Yelp.com</a> has been running <a href="https://www.yelp.com/dataset/challenge">Yelp Dataset challenge</a> for about five years now.
It is a competition that encourages people to explore and research Yelp&#8217;s open dataset, which contains almost 5 million reviews from over 1.1 million users on over 150,000 businesses from 12 metropolitan areas in the tenth round of the challenge.
Over the years the dataset has become very popular with <a href="https://scholar.google.com/scholar?q=citation%3A+Yelp+Dataset&amp;btnG=&amp;hl=en&amp;as_sdt=0%2C5">hundreds of academic paper</a> written about it.
It has well-structured and highly relational data and is therefore a great showcase for Neo4j and graph algorithms on a realistic dataset.
We will show how to use graph algorithms on a social network of friends and how to create and analyse an inferred graph (for example, projecting a review co-occurence graph or similarity between users based on their reviews).</p>
</div>
<div class="paragraph">
<p>Check out also <a href="https://www.yelp.com/dataset/challenge/winners">past winners and their work</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_data"><a class="link" href="#_data">Data</a></h3>
<div class="paragraph">
<p>You can   <a href="https://www.yelp.com/dataset/download">get the dataset</a> by filling out their form.
Download the data in JSON format.
We will use <a href="https://github.com/neo4j-contrib/neo4j-apoc-procedures/releases">APOC plugin</a> to help us with importing and batching data in Neo4j.
There are 6 JSON files available (<a href="https://www.yelp.com/dataset/documentation/json">detailed documentation</a>).
Photos and checkins are not the topic of our analysis, so they will not be imported.
From the other files we will import a knowledge graph of Yelp&#8217;s world, that contains data about:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>156639 businesses</p>
</li>
<li>
<p>1005693 tips from users about businesses</p>
</li>
<li>
<p>4736897 reviews of businesses by users</p>
</li>
<li>
<p>9489337 users total</p>
</li>
<li>
<p>35444850 friend relationships</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Depending on your setup import might take some time as <em>user.json</em> contains data about a 10 million person social network of friends.
While <em>review.json</em> is even bigger in size, it is mostly made up of text representing the actual review, so the import will be faster.
We also do not need the actual text, but only meta-data about them e.g. who wrote the review and how he rated a certain business, so the text will not be imported.</p>
</div>
</div>
<div class="sect2">
<h3 id="_graph_model"><a class="link" href="#_graph_model">Graph Model</a></h3>
<div class="imageblock">
<div class="content">
<img src="https://github.com/neo4j-contrib/neo4j-graph-algorithms/raw/3.2/doc/img/yelp_graph_model.png" alt="yelp graph model">
</div>
</div>
<div class="paragraph">
<p>Graph consist of nodes labeled User, that can have a FRIEND relationship with other users. Users also write reviews and tips about businesses. We store all the meta-data ( location of business etc.) as properties of nodes except for categories of the businesses, which are represented by separate nodes labeled Category.</p>
</div>
<div class="paragraph">
<p>Graph model always depends on the application we have in mind for it.
Our application is to analyse ( inferred ) networks with graph algorithms.
If we were to use our graph as a recommendation engine, we might construct a different graph model.
Check this <a href="http://guides.neo4j.com/sandbox/recommendations">great guide</a> or this <a href="https://www.youtube.com/watch?v=oMTmG4ClO5I">educational video</a> on how you can use Neo4j as a recommendation engine.</p>
</div>
</div>
<div class="sect2">
<h3 id="_import"><a class="link" href="#_import">Import</a></h3>
<div class="listingblock">
<div class="title">Define graph schema (constraint/index)</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL apoc.schema.assert(
{Category:['name']},
{Business:['id'],User:['id'],Review:['id']});</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Load businesses</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL apoc.periodic.iterate("
CALL apoc.load.json('file:///dataset/business.json') YIELD value RETURN value
","
MERGE (b:Business{id:value.business_id})
SET b += apoc.map.clean(value, ['attributes','hours','business_id','categories','address','postal_code'],[])
WITH b,value.categories as categories
UNWIND categories as category
MERGE (c:Category{id:category})
MERGE (b)-[:IN_CATEGORY]-&gt;(c)
",{batchSize: 10000, iterateList: true});</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Load tips</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL apoc.periodic.iterate("
CALL apoc.load.json('file:///dataset/tip.json') YIELD value RETURN value
","
MATCH (b:Business{id:value.business_id})
MERGE (u:User{id:value.user_id})
MERGE (u)-[:TIP{date:value.date,likes:value.likes}]-&gt;(b)
",{batchSize: 20000, iterateList: true});</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Load reviews</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL apoc.periodic.iterate("
CALL apoc.load.json('file:///dataset/review.json')
YIELD value RETURN value
","
MERGE (b:Business{id:value.business_id})
MERGE (u:User{id:value.user_id})
MERGE (r:Review{id:value.review_id})
MERGE (u)-[:WROTE]-&gt;(r)
MERGE (r)-[:REVIEWS]-&gt;(b)
SET r += apoc.map.clean(value, ['business_id','user_id','review_id','text'],[0])
",{batchSize: 10000, iterateList: true});</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Load users</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL apoc.periodic.iterate("
CALL apoc.load.json('file:///dataset/user.json')
YIELD value RETURN value
","
MERGE (u:User{id:value.user_id})
SET u += apoc.map.clean(value, ['friends','user_id'],[0])
WITH u,value.friends as friends
UNWIND friends as friend
MERGE (u1:User{id:friend})
MERGE (u)-[:FRIEND]-(u1)
",{batchSize: 100, iterateList: true});</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_networks"><a class="link" href="#_networks">Networks</a></h3>
<div class="sect3">
<h4 id="_social_network"><a class="link" href="#_social_network">Social network</a></h4>
<div class="paragraph">
<p><a href="https://en.wikipedia.org/wiki/Social_network">Social network</a> is a theoretical construct useful in the social sciences to study relationships between individuals, groups, organizations, or even entire societies.
An axiom of the social network approach to understanding social interaction is that social phenomena should be primarily conceived and investigated through the properties of relationships between and within nodes, instead of the properties of these nodes themselves.
Precisely because many different types of relations, singular or in combination, form these network configurations, network analytics are useful to a broad range of research enterprises.</p>
</div>
<div class="paragraph">
<p><a href="https://en.wikipedia.org/wiki/Social_network_analysis">Social network analysis</a> is the process of investigating social structures through the use of networks and graph theory.
It characterizes networked structures in terms of nodes (individual actors, people, or things within the network) and the ties, edges, or links (relationships or interactions) that connect them.
Examples of social structures commonly visualized through social network analysis include social media networks, memes spread, friendship and acquaintance networks, collaboration graphs, kinship, disease transmission.</p>
</div>
<div class="paragraph">
<p>Social network analysis has emerged as a key technique in modern sociology.
It has also gained a significant following in anthropology, biology, demography, communication studies, economics, geography, history, information science, organizational studies, political science, social psychology, development studies, sociolinguistics, and computer science.</p>
</div>
<div class="paragraph">
<p>Yelp&#8217;s friendship network is an <em>undirected</em> graph with <em>unweighted</em> friend relationships between users.
There are 507948 users with no friends. They will be ignored in our analysis.</p>
</div>
<div class="sect4">
<h5 id="_global_graph_statistics"><a class="link" href="#_global_graph_statistics">Global graph statistics:</a></h5>
<div class="paragraph">
<p>Nodes : 8981389</p>
</div>
<div class="paragraph">
<p>Relationships : 35444850</p>
</div>
<div class="paragraph">
<p>Weakly connected components : 18512</p>
</div>
<div class="paragraph">
<p>Nodes in largest WCC : 8938630</p>
</div>
<div class="paragraph">
<p>Edges in largest WCC : 35420520</p>
</div>
<div class="paragraph">
<p>Triangle count :</p>
</div>
<div class="paragraph">
<p>Average clustering coefficient :</p>
</div>
<div class="paragraph">
<p>Graph diameter (longest shortest path):</p>
</div>
</div>
<div class="sect4">
<h5 id="_local_graph_statistics"><a class="link" href="#_local_graph_statistics">Local graph statistics:</a></h5>
<div class="listingblock">
<div class="title">Use apoc to calculate local statistics</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">MATCH (u:User)
RETURN avg(apoc.node.degree(u,'FRIEND')) as average_friends,
       stdev(apoc.node.degree(u,'FRIEND')) as stdev_friends,
       max(apoc.node.degree(u,'FRIEND')) as max_friends,
       min(apoc.node.degree(u,'FRIEND')) as min_friends</code></pre>
</div>
</div>
<div class="paragraph">
<p>Average number of friends : 7.47</p>
</div>
<div class="paragraph">
<p>Standard deviation of friends : 46.96</p>
</div>
<div class="paragraph">
<p>Minimum count of friends : 1</p>
</div>
<div class="paragraph">
<p>Maximum count of friends : 14995</p>
</div>
<div class="paragraph">
<p>Prior work:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://snap.stanford.edu/class/cs224w-2015/projects_2015/Predicting_Yelp_Ratings_From_Social_Network_Data.pdf" class="bare">http://snap.stanford.edu/class/cs224w-2015/projects_2015/Predicting_Yelp_Ratings_From_Social_Network_Data.pdf</a></p>
</li>
<li>
<p><a href="https://arxiv.org/pdf/1512.06915.pdf" class="bare">https://arxiv.org/pdf/1512.06915.pdf</a></p>
</li>
<li>
<p><a href="http://trust.sce.ntu.edu.sg/wit-ec16/paper/davoust.pdf" class="bare">http://trust.sce.ntu.edu.sg/wit-ec16/paper/davoust.pdf</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_projecting_a_review_co_occurence_graph"><a class="link" href="#_projecting_a_review_co_occurence_graph">Projecting a review co-occurence graph</a></h4>
<div class="paragraph">
<p>We can try to find which businesses are often reviewed by same users by inferring a <a href="https://en.wikipedia.org/wiki/Co-occurrence_networks">co-occurence network</a> between them.
By way of definition, co-occurrence networks are the collective interconnection of nodes based on their paired presence within a specified domain.
Our network is generated by connecting pairs of businesses using a set of criteria defining co-occurrence.</p>
</div>
<div class="paragraph">
<p>The co-occurence criteria for this network is that any pair of businesses must have at least 5 common reviewers.
We save the count of common reviewers as a property of the relationship that will be used as a weight in community detection analysis.
Inferred graph is <em>undirected</em>, as changing the direction of the relationships does not imply any semantic difference.
We will limit our network to those businesses, that have more than 10 reviews and project a co-occurent relationship between businesses.</p>
</div>
<div class="listingblock">
<div class="title">Project a review co-occurence between businesses</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL apoc.periodic.iterate('
MATCH (b1:Business)
WHERE size((b1)&lt;-[:REVIEWS]-&gt;()) &gt; 10 AND b1.city="Las Vegas"
RETURN b1
','
MATCH (b1)&lt;-[:REVIEWS]-(r1)
MATCH (r1)&lt;-[:WROTE]-(u)
MATCH (u)-[:WROTE]-&gt;(r2)
MATCH (r2)-[:REVIEWS]-&gt;(b2)
WHERE id(b1) &lt; id(b2) AND b2.city="Las Vegas"
WITH b1, b2, COUNT(*) AS weight where weight &gt; 5
MERGE (b1)-[cr:CO_OCCURENT_REVIEWS]-(b2)
ON CREATE SET cr.weight = weight
',{batchSize: 1});</code></pre>
</div>
</div>
<div class="paragraph">
<p>Prior work:</p>
</div>
</div>
<div class="sect3">
<h4 id="_projecting_a_review_similarity_graph"><a class="link" href="#_projecting_a_review_similarity_graph">Projecting a review similarity graph</a></h4>
<div class="paragraph">
<p>We can try to find similar groups of users by projecting a review similiarity network between them.
The idea is to start with users that have  more than 10 reviews and find all pairs of users who have reviewed more than 10 common businesses.
We do this to filter out users with not enough data.
We could do something similar to filter out users who have reviewed every business (probably bot or bored).
Once we find pairs of users we calculate their similarity of reviews using cosine similarity and only create a relationship if cosine similarity is greater than 0, sometimes also called hard similarity.
We do this so we do not end up with complete graph, where every pair of users is connected.
Most community detection algorithms perform poorly in a complete graph.
Cosine similarity between pairs of users is saved as a property of relationship and can be used as a weight in graph algorithms.
Projected graph is modeled <em>undirected</em> as the direction of the relationship have no semantic value.</p>
</div>
<div class="paragraph">
<p>Projecting a review similarity graph is often used in recommendations. We calculate who are similar users based on review ratings, so we can recommend to a user what similar users liked.</p>
</div>
<div class="listingblock">
<div class="title">Create a review similarity graph</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL apoc.periodic.iterate(
"MATCH (p1:User) WHERE size((p1)-[:WROTE]-&gt;()) &gt; 5 RETURN p1",
"
MATCH (p1)-[:WROTE]-&gt;(r1)--&gt;()&lt;--(r2)&lt;-[:WROTE]-(p2)
WHERE id(p1) &lt; id(p2) AND size((p2)-[:WROTE]-&gt;()) &gt; 10
WITH p1,p2,count(*) as coop, collect(r1.stars) as s1, collect(r2.stars) as s2 where coop &gt; 10
WITH p1,p2, apoc.algo.cosineSimilarity(s1,s2) as cosineSimilarity WHERE cosineSimilarity &gt; 0
MERGE (p1)-[s:SIMILAR_REVIEWS]-(p2) SET s.weight = cosineSimilarity"
, {batchSize:100, parallel:false,iterateList:true});</code></pre>
</div>
</div>
<div class="paragraph">
<p>Prior work:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://snap.stanford.edu/class/cs224w-2015/projects_2015/Predicting_Yelp_Ratings_Using_User_Friendship_Network_Information.pdf" class="bare">http://snap.stanford.edu/class/cs224w-2015/projects_2015/Predicting_Yelp_Ratings_Using_User_Friendship_Network_Information.pdf</a></p>
</li>
<li>
<p><a href="http://snap.stanford.edu/class/cs224w-2013/projects2013/cs224w-038-final.pdf" class="bare">http://snap.stanford.edu/class/cs224w-2013/projects2013/cs224w-038-final.pdf</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overview_of_algorithm_procedures"><a class="link" href="#_overview_of_algorithm_procedures">Overview of Algorithm Procedures</a></h2>
<div class="sectionbody">
<table id="table-all" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16%;">
<col style="width: 83%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">qualified name</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.unionFind.mscoloring</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.unionFind.mscoloring(label:String, relationship:String, {property:'weight', threshold:0.42, defaultValue:1.0, write: true, partitionProperty:'partition', concurrency:4}) YIELD nodes, setCount, loadMillis, computeMillis, writeMillis</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.unionFind.mscoloring.stream</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.unionFind.mscoloring.stream(label:String, relationship:String, {property:'propertyName', threshold:0.42, defaultValue:1.0, concurrency:4) YIELD nodeId, setId - yields a setId to each node id</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.harmonic.stream</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.harmonic.stream(label:String, relationship:String{concurrency:4}) YIELD nodeId, centrality - yields centrality for each node</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.harmonic</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.harmonic(label:String, relationship:String, {write:true, writeProperty:'centrality, concurrency:4'}) YIELD loadMillis, computeMillis, writeMillis, nodes] - yields evaluation details</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.list - lists all algorithm procedures, their description and signature</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.shortestPath.stream</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.shortestPath.stream(startNode:Node, endNode:Node, weightProperty:String{nodeQuery:'labelName', relationshipQuery:'relationshipName', direction:'BOTH', defaultValue:1.0}) YIELD nodeId, cost - yields a stream of {nodeId, cost} from start to end (inclusive)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.shortestPath</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.shortestPath(startNode:Node, endNode:Node, weightProperty:String{nodeQuery:'labelName', relationshipQuery:'relationshipName', direction:'BOTH', defaultValue:1.0, write:'true', writeProperty:'sssp'}) YIELD nodeId, cost, loadMillis, evalMillis, writeMillis - yields nodeCount, totalCost, loadMillis, evalMillis, writeMillis</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.unionFind.forkJoin</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.unionFind(label:String, relationship:String, {property:'weight', threshold:0.42, defaultValue:1.0, write: true, partitionProperty:'partition',concurrency:4}) YIELD nodes, setCount, loadMillis, computeMillis, writeMillis</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.unionFind.forkJoin.stream</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.unionFind.stream(label:String, relationship:String, {property:'propertyName', threshold:0.42, defaultValue:1.0,concurrency:4}) YIELD nodeId, setId - yields a setId to each node id</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.louvain</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.louvain(label:String, relationship:String, {weightProperty:'weight', defaultValue:1.0, write: true, writeProperty:'community', concurrency:4}) YIELD nodes, communityCount, iterations, loadMillis, computeMillis, writeMillis</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.louvain.stream</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.louvain.stream(label:String, relationship:String, {weightProperty:'propertyName', defaultValue:1.0, concurrency:4) YIELD nodeId, community - yields a setId to each node id</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.unionFind.queue</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.unionFind(label:String, relationship:String, {property:'weight', threshold:0.42, defaultValue:1.0, write: true, partitionProperty:'partition',concurrency:4}) YIELD nodes, setCount, loadMillis, computeMillis, writeMillis</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.unionFind.queue.stream</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.unionFind.stream(label:String, relationship:String, {property:'propertyName', threshold:0.42, defaultValue:1.0, concurrency:4}) YIELD nodeId, setId - yields a setId to each node id</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.labelPropagation</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.labelPropagation(label:String, relationship:String, direction:String, {iterations:1, weightProperty:'weight', partitionProperty:'partition', write:true, concurrency:4}) YIELD nodes, iterations, didConverge, loadMillis, computeMillis, writeMillis, write, weightProperty, partitionProperty - simple label propagation kernel</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.closeness.stream</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.closeness.stream(label:String, relationship:String{concurrency:4}) YIELD nodeId, centrality - yields centrality for each node</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.closeness</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.closeness(label:String, relationship:String, {write:true, writeProperty:'centrality, concurrency:4'}) YIELD loadMillis, computeMillis, writeMillis, nodes] - yields evaluation details</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.allShortestPaths.stream</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.allShortestPaths.stream(weightProperty:String{nodeQuery:'labelName', relationshipQuery:'relationshipName', defaultValue:1.0, concurrency:4}) YIELD sourceNodeId, targetNodeId, distance - yields a stream of {sourceNodeId, targetNodeId, distance}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.shortestPaths.stream</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.shortestPaths.stream(startNode:Node, weightProperty:String{nodeQuery:'labelName', relationshipQuery:'relationshipName', defaultValue:1.0}) YIELD nodeId, distance - yields a stream of {nodeId, cost} from start to end (inclusive)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.shortestPaths</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.shortestPaths(startNode:Node, weightProperty:String{write:true, targetProperty:'path', nodeQuery:'labelName', relationshipQuery:'relationshipName', defaultValue:1.0}) YIELD loadDuration, evalDuration, writeDuration, nodeCount, targetProperty - yields nodeCount, totalCost, loadDuration, evalDuration</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.spanningTree.kmax</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.spanningTree.kmax(label:String, relationshipType:String, weightProperty:String, startNodeId:long, k:int, {writeProperty:String}) YIELD loadMillis, computeMillis, writeMillis, effectiveNodeCount</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.spanningTree.kmin</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.spanningTree.kmin(label:String, relationshipType:String, weightProperty:String, startNodeId:long, k:int, {writeProperty:String}) YIELD loadMillis, computeMillis, writeMillis, effectiveNodeCount</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.betweenness.sampled.stream</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.betweenness.sampled.stream(label:String, relationship:String, {strategy:{'random', 'degree'}, probability:double, maxDepth:int, direction:String, concurrency:int}) YIELD nodeId, centrality - yields centrality for each node</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.betweenness.stream</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.betweenness.stream(label:String, relationship:String, {direction:'out', concurrency :4})YIELD nodeId, centrality - yields centrality for each node</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.betweenness</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.betweenness(label:String, relationship:String, {direction:'out',write:true, writeProperty:'centrality', stats:true, concurrency:4}) YIELD loadMillis, computeMillis, writeMillis, nodes, minCentrality, maxCentrality, sumCentrality - yields status of evaluation</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.betweenness.sampled</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.betweenness.sampled(label:String, relationship:String, {strategy:'random', probability:double, maxDepth:5, direction:'out',write:true, writeProperty:'centrality', stats:true, concurrency:4}) YIELD loadMillis, computeMillis, writeMillis, nodes, minCentrality, maxCentrality, sumCentrality - yields status of evaluation</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.mst</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.mst(label:String, relationshipType:String, weightProperty:String, startNodeId:long, {writeProperty:String}) YIELD loadMillis, computeMillis, writeMillis, effectiveNodeCount</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.spanningTree</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.spanningTree(label:String, relationshipType:String, weightProperty:String, startNodeId:long, {writeProperty:String}) YIELD loadMillis, computeMillis, writeMillis, effectiveNodeCount</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.spanningTree.minimum</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.spanningTree.minimum(label:String, relationshipType:String, weightProperty:String, startNodeId:long, {writeProperty:String}) YIELD loadMillis, computeMillis, writeMillis, effectiveNodeCount</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.spanningTree.maximum</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.spanningTree.maximum(label:String, relationshipType:String, weightProperty:String, startNodeId:long, {writeProperty:String}) YIELD loadMillis, computeMillis, writeMillis, effectiveNodeCount</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.scc</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.scc(label:String, relationship:String, config:Map&lt;String, Object&gt;) YIELD loadMillis, computeMillis, writeMillis, setCount, maxSetSize, minSetSize</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.scc.stream</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.scc.stream(label:String, relationship:String, config:Map&lt;String, Object&gt;) YIELD loadMillis, computeMillis, writeMillis, setCount, maxSetSize, minSetSize</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.scc.recursive.tarjan</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.scc.tarjan(label:String, relationship:String, config:Map&lt;String, Object&gt;) YIELD loadMillis, computeMillis, writeMillis, setCount, maxSetSize, minSetSize</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.scc.recursive.tunedTarjan</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.scc.recursive.tunedTarjan(label:String, relationship:String, config:Map&lt;String, Object&gt;) YIELD loadMillis, computeMillis, writeMillis, setCount, maxSetSize, minSetSize</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.scc.recursive.tunedTarjan.stream</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.scc.recursive.tunedTarjan.stream(label:String, relationship:String, config:Map&lt;String, Object&gt;) YIELD nodeId, partition</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.scc.iterative</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.scc.iterative(label:String, relationship:String, config:Map&lt;String, Object&gt;) YIELD loadMillis, computeMillis, writeMillis, setCount, maxSetSize, minSetSize</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.scc.iterative.stream</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.scc.iterative.stream(label:String, relationship:String, config:Map&lt;String, Object&gt;) YIELD nodeId, partition</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.scc.multistep</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.scc.multistep(label:String, relationship:String, {write:true, concurrency:4, cutoff:100000}) YIELD loadMillis, computeMillis, writeMillis, setCount, maxSetSize, minSetSize</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.scc.multistep.stream</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.scc.multistep.stream(label:String, relationship:String, {write:true, concurrency:4, cutoff:100000}) YIELD nodeId, partition</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.scc.forwardBackward.stream</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.scc.forwardBackward.stream(long startNodeId, label:String, relationship:String, {write:true, concurrency:4}) YIELD nodeId, partition</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.graph.load</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.graph.load(name:String, label:String, relationship:String{direction:'OUT/IN/BOTH', undirected:true/false, sorted:true/false, nodeProperty:'value', nodeWeight:'weight', relationshipWeight: 'weight', graph:'heavy/huge/cypher'}) YIELD nodes, relationships, loadMillis, computeMillis, writeMillis, write, nodeProperty, nodeWeight, relationshipWeight - load named graph</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.graph.remove</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.graph.remove(name:String</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.graph.info</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.graph.info(name:String</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.triangle.stream</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.triangle.stream(label, relationship, {concurrency:4}) YIELD nodeA, nodeB, nodeC - yield nodeA, nodeB and nodeC which form a triangle</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.triangleCount.stream</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.triangleCount.stream(label, relationship, {concurrency:8}) YIELD nodeId, triangles - yield nodeId, number of triangles</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.triangleCount.forkJoin.stream</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.triangleCount.forkJoin.stream(label, relationship, {concurrency:8}) YIELD nodeId, triangles - yield nodeId, number of triangles</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.triangleCount</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.triangleCount(label, relationship, {concurrency:4, write:true, writeProperty:'triangles', clusteringCoefficientProperty:'coefficient'}) YIELD loadMillis, computeMillis, writeMillis, nodeCount, triangleCount, averageClusteringCoefficient</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.triangleCount.forkJoin</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.triangleCount.forkJoin(label, relationship, {concurrency:4, write:true, writeProperty:'triangles', clusteringCoefficientProperty:'coefficient'}) YIELD loadMillis, computeMillis, writeMillis, nodeCount, triangleCount, averageClusteringCoefficient</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.pageRank</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.pageRank(label:String, relationship:String, {iterations:5, dampingFactor:0.85, write: true, writeProperty:'pagerank', concurrency:4}) YIELD nodes, iterations, loadMillis, computeMillis, writeMillis, dampingFactor, write, writeProperty - calculates page rank and potentially writes back</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.pageRank.stream</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.pageRank.stream(label:String, relationship:String, {iterations:20, dampingFactor:0.85, concurrency:4}) YIELD node, score - calculates page rank and streams results</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.shortestPath.deltaStepping.stream</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.shortestPath.deltaStepping.stream(startNode:Node, weightProperty:String, delta:Double{label:'labelName', relationship:'relationshipName', defaultValue:1.0, concurrency:4}) YIELD nodeId, distance - yields a stream of {nodeId, distance} from start to end (inclusive)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.shortestPath.deltaStepping</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.shortestPath.deltaStepping(startNode:Node, weightProperty:String, delta:Double{label:'labelName', relationship:'relationshipName', defaultValue:1.0, write:true, writeProperty:'sssp'}) YIELD loadDuration, evalDuration, writeDuration, nodeCount</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.unionFind</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.unionFind(label:String, relationship:String, {weightProperty:'weight', threshold:0.42, defaultValue:1.0, write: true, partitionProperty:'partition'}) YIELD nodes, setCount, loadMillis, computeMillis, writeMillis</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.unionFind.stream</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.unionFind.stream(label:String, relationship:String, {weightProperty:'propertyName', threshold:0.42, defaultValue:1.0) YIELD nodeId, setId - yields a setId to each node id</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.unionFind.forkJoinMerge</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.unionFind(label:String, relationship:String, {property:'weight', threshold:0.42, defaultValue:1.0, write: true, partitionProperty:'partition', concurrency:4}) YIELD nodes, setCount, loadMillis, computeMillis, writeMillis</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.unionFind.forkJoinMerge.stream</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.unionFind.stream(label:String, relationship:String, {property:'propertyName', threshold:0.42, defaultValue:1.0, concurrency:4}) YIELD nodeId, setId - yields a setId to each node id</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.isFinite</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.isFinite(value) - return true iff the given argument is a finite value (not Infinity, NaN, or null), false otherwise.</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.isInfinite</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.isInfinite(value) - return true iff the given argument is not a finite value (Infinity, NaN, or null), false otherwise.</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.Infinity</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.Infinity() - returns Double.POSITIVE_INFINITY as a value.</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algo.NaN</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALL algo.NaN() - returns Double.NaN as a value.</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_algorithms_2"><a class="link" href="#_algorithms_2">Algorithms</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Graph algorithms are used to compute metrics for graphs, nodes or relationships.</p>
</div>
<div class="paragraph">
<p>They can provide insights on relevant entities (centralities, ranking) in the graph or inherent structures like communities (community-detection, graph-partitioning, clustering).</p>
</div>
<div class="paragraph">
<p>Many of them are iterative approaches that frequently traverse the graph for the computation using random walks, breadth-first- or depth-first searches or pattern matching.</p>
</div>
<div class="paragraph">
<p>Due to the exponential growth of possible paths with increasing distance, many of the approaches also have high algorithmic complexity.</p>
</div>
<div class="paragraph">
<p>Fortunately optimized algorithms exist that utilize certain structures of the graph, memoize already explored parts, and parallelize operations.
Whenever possible we&#8217;ve applied these optimizations.</p>
</div>
<div class="sect2">
<h3 id="_page_rank"><a class="link" href="#_page_rank">Page Rank</a></h3>
<div class="paragraph">
<p>PageRank is Google&#8217;s popular search algorithm.
PageRank counts the number and quality of links to a page to determine an estimate of how important the website is.
The underlying assumption is that more important websites are likely to receive more links from other websites.</p>
</div>
<div class="sect3">
<h4 id="_history_explanation"><a class="link" href="#_history_explanation">History, Explanation</a></h4>
<div class="paragraph">
<p>In order to measure the relative importance of web pages, Sergey Brin and Larry Page proposed PageRank, a method for computing a ranking for every web page based on the graph of the web.
PageRank has applications in search, browsing, and traffic estimation.</p>
</div>
<div class="paragraph">
<p>PageRank is defined in the original Google paper as follows:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>We assume page A has pages T1&#8230;&#8203;Tn which point to it (i.e., are citations). The parameter d is a damping factor which can be set between 0 and 1. We usually set d to 0.85. Also C(A) is defined as the number of links going out of page A. The PageRank of a page A is given as follows:</p>
</div>
<div class="paragraph">
<p>PR(A) = (1-d) + d (PR(T1)/C(T1) + &#8230;&#8203; + PR(Tn)/C(Tn))</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Note that the PageRanks form a probability distribution over web pages, so the sum of all web pages' PageRanks will be one.</p>
</div>
<div class="paragraph">
<p>The underlying mathematics of PageRank has to do with random walks on networks, akin to how random surfers propagate through a network.
Random surfers follow links, but occasionally teleport to random vertices.
The PageRank of a node is the probability it is visited by a random surfer with teleportation.
PageRank is now widely recognized as a way of detecting central nodes in a network.</p>
</div>
</div>
<div class="sect3">
<h4 id="_when_to_use_it_use_cases"><a class="link" href="#_when_to_use_it_use_cases">When to use it / use-cases</a></h4>
<div class="paragraph">
<p>The mathematics of PageRank are entirely general and apply to any graph or network in any domain.
PageRank is regularly used in bibliometrics, social and information network analysis, and for link prediction and recommendation.
It&#8217;s even used for systems analysis of road networks, as well as biology, chemistry, neuroscience, and physics.</p>
</div>
<div class="paragraph">
<p>These are some other notable uses:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In neuroscience, the PageRank of a neuron in a neural network has been found to correlate with its relative firing rate.</p>
</li>
<li>
<p>Personalized PageRank is used by Twitter to present users with other accounts they may wish to follow <a href="https://web.stanford.edu/class/msande233/handouts/lecture8.pdf">[4]</a>.</p>
</li>
<li>
<p>PageRank has been used to rank spaces or streets to predict how many pedestrians or vehicles come to individual spaces or streets.</p>
</li>
<li>
<p>In lexical semantics it has been used to perform Word Sense Disambiguation, Semantic similarity, and to automatically rank WordNet synsets according to how strongly they possess a given semantic property, such as positivity or negativity <a href="http://nmis.isti.cnr.it/sebastiani/Publications/ACL07.pdf">[2]</a>.</p>
</li>
<li>
<p>In any ecosystem, a modified version of PageRank may be used to determine species that are essential to the continuing health of the environment <a href="http://news.bbc.co.uk/2/hi/8238462.stm">[3]</a>.</p>
</li>
<li>
<p>For the analysis of protein networks in biology PageRank is also a useful tool <a href="https://bmcbioinformatics.biomedcentral.com/track/pdf/10.1186/1471-2105-15-204?site=bmcbioinformatics.biomedcentral.com">[6]</a>.</p>
</li>
<li>
<p>PageRank has been used to quantify the scientific impact of researchers <a href="http://ilpubs.stanford.edu:8090/422/1/1999-66.pdf">[5]</a>.
The underlying citation and collaboration networks are used in conjunction with PageRank algorithm to come up with a ranking system for individual publications that propagates to individual authors.
The new index known as pagerank-index (Pi) is demonstrated to be fairer compared to h-index and addresses many of the drawbacks exhibited by h-index.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_constraints_when_not_to_use_it"><a class="link" href="#_constraints_when_not_to_use_it">Constraints / when not to use it</a></h4>
<div class="paragraph">
<p>There are some major limitations of the PageRank algorithm.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Spider traps - if there are no links from within the group to outside the groups then the group of pages is a spider trap.</p>
</li>
<li>
<p>Rank sink - this occurs when a network of pages form an infinite cycle.</p>
</li>
<li>
<p>Dead-ends and Dangling links - Dead-ends occurs when pages have no out links. If a page contains a link to another page which has no out links, the link would be known as a dangling link. [1]</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can read <a href="http://www.cs.princeton.edu/~chazelle/courses/BIB/pagerank.htm">[7]</a> for more.</p>
</div>
</div>
<div class="sect3">
<h4 id="_algorithm_explanation_on_simple_sample_graph"><a class="link" href="#_algorithm_explanation_on_simple_sample_graph">Algorithm explanation on simple sample graph</a></h4>
<div class="imageblock">
<div class="content">
<img src="https://github.com/neo4j-contrib/neo4j-graph-algorithms/raw/3.2/doc/img/pagerank.png" alt="pagerank">
</div>
</div>
<div class="listingblock">
<div class="title">Create sample graph</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CREATE (home:Page{name:'Home'})
,(about:Page{name:'About'})
,(product:Page{name:'Product'})
,(links:Page{name:'Links'})
,(a:Page{name:'Site A'})
,(b:Page{name:'Site B'})
,(c:Page{name:'Site C'})
,(d:Page{name:'Site D'})
CREATE (home)-[:LINKS]-&gt;(about)
,(about)-[:LINKS]-&gt;(home)
,(product)-[:LINKS]-&gt;(home)
,(home)-[:LINKS]-&gt;(product)
,(links)-[:LINKS]-&gt;(home)
,(home)-[:LINKS]-&gt;(links)
,(links)-[:LINKS]-&gt;(a)-[:LINKS]-&gt;(home)
,(links)-[:LINKS]-&gt;(b)-[:LINKS]-&gt;(home)
,(links)-[:LINKS]-&gt;(c)-[:LINKS]-&gt;(home)
,(links)-[:LINKS]-&gt;(d)-[:LINKS]-&gt;(home)</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Running algorithm and streaming results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.pageRank.stream('Page', 'LINKS', {iterations:20, dampingFactor:0.85})
YIELD node, score
RETURN node,score order by score desc limit 20</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Running algorithm and writing back results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.pageRank('Page', 'LINKS',
  {iterations:20, dampingFactor:0.85, write: true,writeProperty:"pagerank"})
YIELD nodes, iterations, loadMillis, computeMillis, writeMillis, dampingFactor, write, writeProperty</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Results</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">pageRank</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Home</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.232</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Product</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.059</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Links</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.059</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">About</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.059</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Site A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.328</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Site B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.328</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Site C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.328</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Site D</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.328</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>As we might expect, the Home page has the highest PageRank because it has incoming links from all other pages.
We can also observe that its not only the number of incoming links is important, but also the importance of the pages that link to us.</p>
</div>
</div>
<div class="sect3">
<h4 id="_example_usage"><a class="link" href="#_example_usage">Example Usage</a></h4>
<div class="paragraph">
<p>We will run PageRank on Yelp&#8217;s social network to find potential influencers.</p>
</div>
<div class="paragraph">
<p>In the <a href="#_import">import section</a> we stored the social network as a <a href="https://en.wikipedia.org/wiki/Bidirected_graph" target="_blank">undirected graph</a>.
Relationships in Neo4j always have a direction but in this domain the direction is irrelevant.
If <code>Person A</code> is a <code>FRIEND</code> with <code>Person B</code> we can say that <code>Person B</code> is also a <code>FRIEND</code> with <code>Person A</code>.</p>
</div>
<div class="paragraph">
<p>The default label and relationship-type selection syntax won&#8217;t work for us here because it will project a directed social network.
Instead, we can project our undirected social network using <strong>Cypher loading</strong>.
We can also apply this approach to other algorithms that use <strong>Cypher loading</strong>.</p>
</div>
<div class="listingblock">
<div class="title">Running algorithm on Yelp social network</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.pageRank.stream(
  'MATCH (u:User) WHERE exists( (u)-[:FRIENDS]-() ) RETURN id(u) as id',
  'MATCH (u1:User)-[:FRIENDS]-(u2:User) RETURN id(u1) as source, id(u2) as target',
  {graph:'cypher'}
) YIELD node,score with node,score order by score desc limit 10
RETURN node {.name, .review_count, .average_stars,.useful,.yelping_since,.funny}, score</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_syntax"><a class="link" href="#_syntax">Syntax</a></h4>
<div class="listingblock">
<div class="title">running algorithm and writing back results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.pageRank(label:String, relationship:String,
    {iterations:20, dampingFactor:0.85, write: true, writeProperty:'pagerank', concurrency:4})
YIELD nodes, iterations, loadMillis, computeMillis, writeMillis, dampingFactor, write, writeProperty</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 2. parameters</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">optional</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">label</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">label to load from the graph. If null load all nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship-type to load from the graph. If null load all relationships</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">iterations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">20</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">how many iterations of page-rank to run</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">concurrency</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">available CPUs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of concurrent threads</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dampingFactor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.85</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">damping factor of the page-rank calculation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">write</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if result should be written back as node property</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">writeProperty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'pagerank'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">property name written back to</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">graph</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'heavy'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">use 'heavy' when describing the subset of the graph with label and relationship-type parameter, 'cypher' for describing the subset with cypher node-statement and relationship-statement</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 3. results</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nodes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of nodes considered</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">iterations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of iterations run</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dampingFactor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">damping factor used</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">writeProperty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">property name written back to</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">write</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if result was written back as node property</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">loadMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for loading data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">computeMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for running the algorithm</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">writeMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for writing result data back</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">running algorithm and streaming results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.pageRank.stream(label:String, relationship:String,
  {iterations:20, dampingFactor:0.85, concurrency:4})
YIELD node, score - calculates page rank and streams results</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 4. parameters</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">optional</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">label</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">label to load from the graph, if null load all nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship-type to load from the graph, if null load all nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">iterations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">20</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">how many iterations of page-rank to run</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">concurrency</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">available CPUs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of concurrent threads</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dampingFactor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.85</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">damping factor of the page-rank calculation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">graph</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'heavy'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">use 'heavy' when describing the subset of the graph with label and relationship-type parameter, 'cypher' for describing the subset with cypher node-statement and relationship-statement</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 5. results</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">node</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">node id</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">score</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">page-rank weight</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_cypher_projection_2"><a class="link" href="#_cypher_projection_2">Cypher projection</a></h4>
<div class="paragraph">
<p>If label and relationship-type are not selective enough to describe a subgraph to run the algorithm on, you can use Cypher statements to load or project subsets of your graph.
Don&#8217;t forget to set <code>graph:'cypher'</code> in the config.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.pageRank(
  'MATCH (p:Page) RETURN id(p) as id',
  'MATCH (p1:Page)-[:Link]-&gt;(p2:Page) RETURN id(p1) as source, id(p2) as target',
  {graph:'cypher', iterations:5, write: true}
)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_versions"><a class="link" href="#_versions">Versions</a></h4>
<div class="paragraph">
<p>We support the following versions of the pageRank algorithm:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10003; directed, unweighted</p>
</li>
<li>
<p>&#10063; directed, weighted</p>
</li>
<li>
<p>&#10003; undirected, unweighted</p>
<div class="ulist">
<ul>
<li>
<p>Only with cypher projection</p>
</li>
</ul>
</div>
</li>
<li>
<p>&#10063; undirected, weighted</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_references"><a class="link" href="#_references">References</a></h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://en.wikipedia.org/wiki/PageRank" class="bare">https://en.wikipedia.org/wiki/PageRank</a></p>
</li>
<li>
<p><a href="http://infolab.stanford.edu/~ullman/mmds/book.pdf" class="bare">http://infolab.stanford.edu/~ullman/mmds/book.pdf</a></p>
</li>
<li>
<p><a href="https://anthonybonato.com/2016/04/13/the-mathematics-of-game-of-thrones/" class="bare">https://anthonybonato.com/2016/04/13/the-mathematics-of-game-of-thrones/</a></p>
</li>
<li>
<p>[1] <a href="http://research.ijcaonline.org/volume110/number12/pxc3901035.pdf" class="bare">http://research.ijcaonline.org/volume110/number12/pxc3901035.pdf</a></p>
</li>
<li>
<p>[2] <a href="http://nmis.isti.cnr.it/sebastiani/Publications/ACL07.pdf" class="bare">http://nmis.isti.cnr.it/sebastiani/Publications/ACL07.pdf</a></p>
</li>
<li>
<p>[3] <a href="http://news.bbc.co.uk/2/hi/8238462.stm" class="bare">http://news.bbc.co.uk/2/hi/8238462.stm</a></p>
</li>
<li>
<p>[4] <a href="https://web.stanford.edu/class/msande233/handouts/lecture8.pdf" class="bare">https://web.stanford.edu/class/msande233/handouts/lecture8.pdf</a></p>
</li>
<li>
<p>[5] <a href="http://ilpubs.stanford.edu:8090/422/1/1999-66.pdf" class="bare">http://ilpubs.stanford.edu:8090/422/1/1999-66.pdf</a></p>
</li>
<li>
<p>[6] <a href="https://bmcbioinformatics.biomedcentral.com/track/pdf/10.1186/1471-2105-15-204?site=bmcbioinformatics.biomedcentral.com" class="bare">https://bmcbioinformatics.biomedcentral.com/track/pdf/10.1186/1471-2105-15-204?site=bmcbioinformatics.biomedcentral.com</a></p>
</li>
<li>
<p>[7] <a href="http://www.cs.princeton.edu/~chazelle/courses/BIB/pagerank.htm" class="bare">http://www.cs.princeton.edu/~chazelle/courses/BIB/pagerank.htm</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_betweenness_centrality"><a class="link" href="#_betweenness_centrality">Betweenness Centrality</a></h3>
<div class="paragraph">
<p><em>Betweenness Centrality</em> is a measure of centrality in a graph based on calculating geodesic (shortest) paths between nodes.
There is at least one shortest path between every pair of nodes in a connected graph.
The shortest path can be based on the number of relationships that the path passes through in an unweighted network or the sum of the weights of the relationships in a weighted network.</p>
</div>
<div class="paragraph">
<p>The betweenness centrality for each node is the number of these shortest paths that pass through that node.
The nodes that most frequently lie on these shortest paths are will have a higher betweenness centrality score.</p>
</div>
<div class="sect3">
<h4 id="_history_explanation_2"><a class="link" href="#_history_explanation_2">History, Explanation</a></h4>
<div class="paragraph">
<p>The original idea behind betweenness centrality was introduced by J. M. Anthonisse in his 1971 paper <a href="http://oai.cwi.nl/oai/asset/9791/9791A.pdf" target="_blank">The rush in a directed graph</a>.
Anthonisse defined the <em>rush</em> in a graph as the amount a node in a network has to intermediate between other nodes.</p>
</div>
<div class="paragraph">
<p>Linton Freeman gave the first formal definition of betweenness centrality as one of the three distinct intuitive conceptions of centrality in his paper <a href="http://moreno.ss.uci.edu/23.pdf" target="_blank">A Set of Measures of Centrality Based on Betweenness</a>.
It is calculated by a breath-first search algorithm that computes the shortest paths from every node to all other nodes.
Ulrik Brandes' <a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.11.2024&amp;rep=rep1&amp;type=pdf" target="_blank">Faster Algorithm for Betweenness Centrality</a> is often used to make the calculation.</p>
</div>
</div>
<div class="sect3">
<h4 id="_when_to_use_it_use_cases_2"><a class="link" href="#_when_to_use_it_use_cases_2">When to use it / use-cases</a></h4>
<div class="imageblock">
<div class="content">
<img src="https://github.com/neo4j-contrib/neo4j-graph-algorithms/raw/3.2/doc/img/betweenness_centrality.png" alt="betweenness centrality">
</div>
</div>
<div class="paragraph">
<p><em>Betweenness centrality</em> is useful for finding nodes that serve as a bridge from one part of a graph to another.
As a result, it is a rudimentary measure of the control that a node exerts over the flow throughout the graph.</p>
</div>
<div class="paragraph">
<p>In the above example Alice is the main connection in the graph.
If Alice is removed all connections in the graph would be cut off.
This makes Alice important because she ensures that no nodes are isolated.</p>
</div>
<div class="paragraph">
<p>The betweenness score for a node can be non intuitive.
The node may have low degree, be connected to others that have low degree, and even be a long way from others on average, yet still have high betweenness.
Consider a node A that lies on a bridge between two groups of nodes within a network.
Since any path between nodes in different groups must go through this bridge, node A acquires high betweenness even though it is not well connected within either group.</p>
</div>
<div class="paragraph">
<p><em>Betweenness Centrality</em> has wide applicability in network theory.
It represents the degree to which nodes stand between each other.
It has founds uses in a variety of different domains [1] including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>analyzing social and protein networks.</p>
</li>
<li>
<p>identifying important bloggers</p>
</li>
<li>
<p>measuring network traffic in communication networks</p>
</li>
<li>
<p>studying the interaction patterns of players in massively multi player online games</p>
</li>
<li>
<p>analyzing the importance of people in mobile phone call networks</p>
</li>
<li>
<p>finding the controlling nodes in a telecommunications network</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_constraints_when_not_to_use_it_2"><a class="link" href="#_constraints_when_not_to_use_it_2">Constraints / when not to use it</a></h4>
<div class="paragraph">
<p>Betweeness centrality makes the assumption that all communication between nodes happens along the shortest path and with the same frequency, which isn&#8217;t the case in real life.
It therefore doesn&#8217;t give us a perfect view of the most influential nodes in a graph, but rather a good approximation. [4]</p>
</div>
</div>
<div class="sect3">
<h4 id="_algorithm_explanation_on_simple_sample_graph_2"><a class="link" href="#_algorithm_explanation_on_simple_sample_graph_2">Algorithm explanation on simple sample graph</a></h4>
<div class="paragraph">
<p>People with high betweenness tend to be the innovators and brokers in social networks.
They combine different perspectives, transfer ideas between groups, and get power from their ability to make introductions and pull strings.</p>
</div>
<div class="listingblock">
<div class="title">Create sample graph</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CREATE (nAlice:User {id:'Alice'})
,(nBridget:User {id:'Bridget'})
,(nCharles:User {id:'Charles'})
,(nDoug:User {id:'Doug'})
,(nMark:User {id:'Mark'})
,(nMichael:User {id:'Michael'})
CREATE (nAlice)-[:MANAGE]-&gt;(nBridget)
,(nAlice)-[:MANAGE]-&gt;(nCharles)
,(nAlice)-[:MANAGE]-&gt;(nDoug)
,(nMark)-[:MANAGE]-&gt;(nAlice)
,(nCharles)-[:MANAGE]-&gt;(nMichael);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Running algorithm and streaming results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.betweenness.stream('User','MANAGE',{direction:'out'})
YIELD nodeId, centrality
RETURN nodeId,centrality order by centrality desc limit 20;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Running algorithm and writing back results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.betweenness('User','MANAGE', {direction:'out',write:true, writeProperty:'centrality'})
YIELD nodes, minCentrality, maxCentrality, sumCentrality, loadMillis, computeMillis, writeMillis;</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 6. Results</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">centrality weight</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Alice</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Charles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bridget</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Michael</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Doug</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mark</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>We can see that Alice is the main broker in this network and Charles is a minor broker.</p>
</div>
</div>
<div class="sect3">
<h4 id="_approximation_of_betweenness_centrality"><a class="link" href="#_approximation_of_betweenness_centrality">Approximation of betweenness centrality</a></h4>
<div class="paragraph">
<p>The fastest known algorithm for exactly computing betweenness of all the nodes, designed by Brandes, requires at least <code>O(nm)</code> time for unweighted graphs, where <code>n</code> is the number of nodes and <code>m</code> is the number of relationships.
For large-scale graphs exact centrality computation isn&#8217;t practical [2], but we can work with a subset of the nodes and calculate an approximate score.</p>
</div>
<div class="sect4">
<h5 id="_ra_brandes_algorithm"><a class="link" href="#_ra_brandes_algorithm">RA-Brandes Algorithm</a></h5>
<div class="paragraph">
<p>RA-Brandes algorithm, proposed by Brandes and Pich[3], is different from original Brandes algorithm in only one main respect:
Brandes algorithm considers all nodes within the graph, whereas RA-Brandes considers only a subset of nodes, also known as pivots, from the graph.</p>
</div>
<div class="paragraph">
<p>We implement two strategies of selecting the subset of nodes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>random: nodes are selected uniformly at random with defined probability of selection. Default probability is <code>log10(N) / e^2</code>. If probability is 1 then the algorithm works as original Brandes where all nodes are loaded.</p>
</li>
<li>
<p>degree: first calculates the mean degree of the nodes and then only visits nodes whose degree is higher then the mean. i.e. only dense nodes are visited</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>First step in calculating betweenness centrality is to collect all shortest paths that run through specific node. With parameter <code>maxDepth</code> you can limit the depth of all shortest paths traversal.</p>
</div>
<div class="listingblock">
<div class="title">Running algorithm and streaming results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.betweenness.sampled.stream('User','FRIEND',
  {strategy:'random', probability:1.0, maxDepth:5})
YIELD nodeId, centrality</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Running algorithm and writing back results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.betweenness.sampled('User','FRIEND',
  {strategy:'random', probability:1.0, writeProperty:'centrality', maxDepth:5})
YIELD nodes, minCentrality, maxCentrality</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_example_usage_2"><a class="link" href="#_example_usage_2">Example Usage</a></h4>

</div>
<div class="sect3">
<h4 id="_syntax_2"><a class="link" href="#_syntax_2">Syntax</a></h4>
<div class="listingblock">
<div class="title">Running Brandes algorithm and writing back results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.betweenness(label:String, relationship:String,
  {direction:'out',write:true, stats:true, writeProperty:'centrality',concurrency:1})
YIELD nodes, minCentrality, maxCentrality, sumCentrality, loadMillis, computeMillis, writeMillis
- calculates betweenness centrality and potentially writes back</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 7. Parameters</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">optional</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">label</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">label to load from the graph. If null load all nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship-type to load from the graph. If null load all relationships</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">direction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">outgoing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship direction to load from the graph, if 'both' treats the relationships as undirected</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">write</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if result should be written back as node property</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">stats</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if stats about centrality should be returned</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">writeProperty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'centrality'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">property name written back to</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">graph</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'heavy'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">use 'heavy' when describing the subset of the graph with label and relationship-type parameter, 'cypher' for describing the subset with cypher node-statement and relationship-statement</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">concurrency</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">available CPUs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of concurrent threads</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 8. Results</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nodes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of nodes considered</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">minCentrality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">minimum centrality value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">maxCentrality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">maximum centrality value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sumCentrality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sum of all centrality values</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">loadMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for loading data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">evalMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for running the algorithm</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">writeMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for writing result data back</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Running Brandes algorithm and streaming results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.betweenness.stream(label:String, relationship:String,
{direction:'out',concurrency:1})
YIELD nodeId, centrality - yields centrality for each node</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 9. Parameters</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">optional</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">label</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">label to load from the graph, if null load all nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship-type to load from the graph, if null load all relationships</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">concurrency</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">available CPUs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of concurrent threads</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">direction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">outgoing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship direction to load from the graph, if 'both' treats the relationships as undirected</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 10. Results</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">node</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">node id</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">centrality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">betweenness centrality weight</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Running RA-Brandes algorithm and writing back results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.betweenness.sampled(label:String, relationship:String,
  {direction:'out', strategy:'random', probability: 1, maxDepth: 4, stats:true,
 writeProperty:'centrality',concurrency:1})
YIELD nodes, minCentrality, maxCentrality, sumCentrality, loadMillis, computeMillis, writeMillis
- calculates betweenness centrality and potentially writes back</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 11. Parameters</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">optional</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">label</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">label to load from the graph, if null load all nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship-type to load from the graph, if null load all nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">direction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">outgoing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship direction to load from the graph, if 'both' treats the relationships as undirected</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">write</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if result should be written back as node property</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">strategy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'random'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">node selection strategy</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">probability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">log10(N) / e^2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">probability a node is selected. Values between 0 and 1.  If 1 selects all nodes and works like original Brandes algorithm</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">maxDepth</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer.MAX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">depth of the shortest paths traversal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">stats</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if stats about centrality should be returned</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">writeProperty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'centrality'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">property name written back to</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">graph</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'heavy'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">use 'heavy' when describing the subset of the graph with label and relationship-type parameter, 'cypher' for describing the subset with cypher node-statement and relationship-statement</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">concurrency</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">available CPUs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of concurrent threads</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 12. Results</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nodes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of nodes considered</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">minCentrality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">minimum centrality value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">maxCentrality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">maximum centrality value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sumCentrality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sum of all centrality values</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">loadMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for loading data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">evalMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for running the algorithm</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">writeMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for writing result data back</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Running RA-Brandes algorithm and streaming results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.betweenness.sampled.stream(label:String, relationship:String,
  {direction:'out',concurrency:1, strategy:'random', probability: 1, maxDepth: 4})
YIELD nodeId, centrality - yields centrality for each node</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 13. Parameters</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">optional</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">label</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">label to load from the graph, if null load all nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship-type to load from the graph, if null load all relationships</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">concurrency</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">available CPUs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of concurrent threads</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">direction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">outgoing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship direction to load from the graph, if 'both' treats the relationships as undirected</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">strategy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'random'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">node selection strategy</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">probability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">log10(N) / e^2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">probability a node is selected. Values between 0 and 1.  If 1 selects all nodes and works like original Brandes algorithm</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">maxDepth</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer.MAX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">depth of the shortest paths traversal</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 14. Results</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">node</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">node id</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">centrality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">betweenness centrality weight</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_cypher_projection_3"><a class="link" href="#_cypher_projection_3">Cypher projection</a></h4>
<div class="paragraph">
<p>If label and relationship-type are not selective enough to describe your subgraph to run the algorithm on, you can use Cypher statements to load or project subsets of your graph.
Can be also used to run algorithms on a virtual graph.
Set <code>graph:'cypher'</code> in the config.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.betweenness(
  'MATCH (p:User) RETURN id(p) as id',
  'MATCH (p1:User)-[:MANAGE]-&gt;(p2:User) RETURN id(p1) as source, id(p2) as target',
  {graph:'cypher', write: true}
);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_versions_2"><a class="link" href="#_versions_2">Versions</a></h4>
<div class="paragraph">
<p>We support the following versions of the betweenness centrality algorithm:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10003; directed, unweighted</p>
<div class="ulist">
<ul>
<li>
<p>loading incoming relationships: 'INCOMING','IN','I' or '&lt;'</p>
</li>
<li>
<p>loading outgoing relationships: 'OUTGOING','OUT','O' or '&gt;'</p>
</li>
</ul>
</div>
</li>
<li>
<p>&#10063; directed, weighted</p>
</li>
<li>
<p>&#10003; undirected, unweighted</p>
<div class="ulist">
<ul>
<li>
<p>direction:'both' or '&lt;&gt;'</p>
</li>
</ul>
</div>
</li>
<li>
<p>&#10063; undirected, weighted</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_implementations"><a class="link" href="#_implementations">Implementations</a></h4>
<div class="paragraph">
<p><code>algo.betweenness()</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>implementation of brandes-bc algorithm and nodePartitioning extension</p>
</li>
<li>
<p>if concurrency parameter is set (and &gt;1) ParallelBetweennessCentrality is used</p>
</li>
<li>
<p>ParallelBC spawns N(given by the concurrency param) concurrent threads for calculation where each one
calculates the BC for one node at a time</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>algo.betweenness.exp1()</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>brandes-like algorithm which uses successor sets instead of predecessor sets</p>
</li>
<li>
<p>The algorithm is based on Brandes definition but with some changes
regarding the dependency-accumulation step.</p>
</li>
<li>
<p>Does not support undirected graph</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>algo.betweenness.sampled()</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Calculates betweenness-dependencies on a subset of pivot nodes (instead of all nodes). Up to now 2 randomization strategies are implemented which can be set using the optional argument strategy:</p>
</li>
<li>
<p>random selection(default): strategy:'random': (takes optional argument probability:double(0-1) or log10(N) / e^2 as default)</p>
</li>
<li>
<p>degree based randomization: strategy:'degree': (makes dense nodes more likely)</p>
</li>
<li>
<p>optional Arguments: maxDepth:int</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_references_2"><a class="link" href="#_references_2">References</a></h4>
<div class="ulist">
<ul>
<li>
<p><a href="http://cass-mt.pnnl.gov/docs/pubs/georgiatechlbnlpnnlfastbc-mtaap2009.pdf" class="bare">http://cass-mt.pnnl.gov/docs/pubs/georgiatechlbnlpnnlfastbc-mtaap2009.pdf</a></p>
</li>
<li>
<p><a href="http://www.algo.uni-konstanz.de/publications/b-fabc-01.pdf" class="bare">http://www.algo.uni-konstanz.de/publications/b-fabc-01.pdf</a></p>
</li>
<li>
<p><a href="https://www.sci.unich.it/~francesc/teaching/network/betweeness.html" class="bare">https://www.sci.unich.it/~francesc/teaching/network/betweeness.html</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Centrality" class="bare">https://en.wikipedia.org/wiki/Centrality</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Betweenness_centrality" class="bare">https://en.wikipedia.org/wiki/Betweenness_centrality</a></p>
</li>
<li>
<p><a href="http://www.fmsasg.com/SocialNetworkAnalysis/" class="bare">http://www.fmsasg.com/SocialNetworkAnalysis/</a></p>
</li>
<li>
<p><a href="https://econsultancy.com/blog/63682-twitter-network-analysis-identifying-influencers-and-innovators/" class="bare">https://econsultancy.com/blog/63682-twitter-network-analysis-identifying-influencers-and-innovators/</a></p>
</li>
<li>
<p><a href="http://iima.org/wp/wp-content/uploads/2017/04/Curriculum-Structure-and-Assessment-Placement_Lightfoot.pdf" class="bare">http://iima.org/wp/wp-content/uploads/2017/04/Curriculum-Structure-and-Assessment-Placement_Lightfoot.pdf</a></p>
</li>
<li>
<p>[1] <a href="https://arxiv.org/pdf/1702.06087.pdf" class="bare">https://arxiv.org/pdf/1702.06087.pdf</a></p>
</li>
<li>
<p>[2] <a href="https://www.cc.gatech.edu/~mihail/WAW07.pdf" class="bare">https://www.cc.gatech.edu/~mihail/WAW07.pdf</a></p>
</li>
<li>
<p>[3] <a href="https://pdfs.semanticscholar.org/2e0d/94d072d79ba73c9a153a228b93520b3ce670.pdf" class="bare">https://pdfs.semanticscholar.org/2e0d/94d072d79ba73c9a153a228b93520b3ce670.pdf</a></p>
</li>
<li>
<p>[4] <a href="https://global.oup.com/academic/product/networks-9780199206650?cc=us&amp;lang=en&amp;" target="_blank">Newman, Mark. Networks: An Introduction (Page 186). OUP Oxford.</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_closeness_centrality"><a class="link" href="#_closeness_centrality">Closeness Centrality</a></h3>
<div class="paragraph">
<p>The <em>Closeness Centrality</em> of a node measures the distance from that node to all other nodes.
Nodes with a high closeness score have the shortest distances to all other nodes.
The premise of this algorithm is that nodes with short distance to other nodes can spread information very efficiently through the network.
This is important for the availability of knowledge and resources.</p>
</div>
<div class="sect3">
<h4 id="_history_explanation_3"><a class="link" href="#_history_explanation_3">History, Explanation</a></h4>
<div class="paragraph">
<p>Sabidussi (1966) described the sum of the shortest path distances from one node to every other node as the nodes farness.
Freeman (1979) used this idea to define closeness centrality of a node as the inverse of Sabidussis farness.</p>
</div>
<div class="paragraph">
<p>Closeness centrality is defined as the total number of relationships separating a node from all others along the shortest possible paths.</p>
</div>
<div class="paragraph">
<p>The algorithm operates as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>calculate the shortest path for each for each pair of nodes in the graph</p>
</li>
<li>
<p>for each node sum the total distance from the node to all other nodes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The greater the <strong>raw closeness centrality</strong>, the longer it takes for information originating at random points in the graph to arrive at the node.
We could also interpret closeness as the potential ability of a node to reach all other nodes as quickly as possible.</p>
</div>
<div class="paragraph">
<p>It is important to note that <strong>raw closeness centrality</strong> is an inverse measure of centrality.
i.e. nodes with smaller scores that are the most central.
Our algorithm returns a <strong>normalized closeness centrality</strong> score where nodes with a higher score are more central.</p>
</div>
</div>
<div class="sect3">
<h4 id="_when_to_use_it_use_cases_3"><a class="link" href="#_when_to_use_it_use_cases_3">When to use it / use-cases</a></h4>
<div class="paragraph">
<p>This algorithm is useful for finding the nodes that can access the entire network most quickly.</p>
</div>
<div class="paragraph">
<p>We might use it if we&#8217;re trying to identify where in the city to place a new public service so that it&#8217;s easily accessible for residents.
If we&#8217;re trying to spread a message on social media we could use the algorithm to find the key influencers that can help us achieve our goal.</p>
</div>
<div class="paragraph">
<p>This measure is preferable to degree centrality, because takes both indirected and direct connections into account.
For closeness centrality in directed networks, we split the concept into in-closeness and out-closeness.
The in-closeness variable measures the extent to which a node is easily reached by others
i.e. paths from others to the node
The out-closeness variable measures the extent to which a node can easily reach others
i.e paths from the node to others</p>
</div>
</div>
<div class="sect3">
<h4 id="_constraints_when_not_to_use_it_3"><a class="link" href="#_constraints_when_not_to_use_it_3">Constraints / when not to use it</a></h4>
<div class="paragraph">
<p>Closeness centrality works best on connected graphs.
On unconnected graphs we can end up with an infinite distance between two nodes in separate connected components.
This means that we&#8217;ll end up with an infinite closeness centrality score when we sum up all the distances from that node. [1]</p>
</div>
<div class="paragraph">
<p>We may therefore choose to run the strongly connected component over our dataset before trying closeness centrality.</p>
</div>
</div>
<div class="sect3">
<h4 id="_algorithm_explanation_on_simple_sample_graph_3"><a class="link" href="#_algorithm_explanation_on_simple_sample_graph_3">Algorithm explanation on simple sample graph</a></h4>
<div class="imageblock">
<div class="content">
<img src="https://github.com/neo4j-contrib/neo4j-graph-algorithms/raw/3.2/doc/img/closeness_centrality.png" alt="closeness centrality">
</div>
</div>
<div class="listingblock">
<div class="title">Create sample graph</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CREATE (a:Node{id:"A"}),
       (b:Node{id:"B"}),
       (c:Node{id:"C"}),
       (d:Node{id:"D"}),
       (e:Node{id:"E"})
CREATE (a)-[:LINK]-&gt;(b),
       (b)-[:LINK]-&gt;(a),
       (b)-[:LINK]-&gt;(c),
       (c)-[:LINK]-&gt;(b),
       (c)-[:LINK]-&gt;(d),
       (d)-[:LINK]-&gt;(c),
       (d)-[:LINK]-&gt;(e),
       (e)-[:LINK]-&gt;(d);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Running algorithm and streaming results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.closeness.stream('Node', 'LINKS') YIELD nodeId, centrality
RETURN nodeId,centrality order by centrality desc limit 20;

- yields centrality for each node</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Running algorithm and writing back results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.closeness('Node', 'LINK', {write:true, writeProperty:'centrality'})
YIELD nodes,loadMillis, computeMillis, writeMillis;

- calculates closeness centrality and potentially writes back</code></pre>
</div>
</div>
<div class="paragraph">
<p>Calculation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>count farness in each msbfs-callback</p>
</li>
<li>
<p>divide by N-1</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>N = 5</code>        // number of nodes</p>
</div>
<div class="paragraph">
<p><code>k = N-1 = 4</code>  // used for normalization</p>
</div>
<div class="literalblock">
<div class="content">
<pre>     A     B     C     D     E
 --|-----------------------------
 A | 0     1     2     3     4       // farness between each pair of nodes
 B | 1     0     1     2     3
 C | 2     1     0     1     2
 D | 3     2     1     0     1
 E | 4     3     2     1     0
 --|-----------------------------
 S | 10    7     6     7     10      // raw closeness centrality
 ==|=============================
k/S| 0.4  0.57  0.67  0.57   0.4     // normalized closeness centrality</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_example_usage_3"><a class="link" href="#_example_usage_3">Example Usage</a></h4>

</div>
<div class="sect3">
<h4 id="_syntax_3"><a class="link" href="#_syntax_3">Syntax</a></h4>
<div class="listingblock">
<div class="title">Running algorithm and writing back results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.closeness(label:String, relationship:String,
{write:true, writeProperty:'centrality',graph:'heavy', concurrency:4})
YIELD nodes,loadMillis, computeMillis, writeMillis
- calculates closeness centrality and potentially writes back</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 15. Parameters</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">optional</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">label</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">label to load from the graph. If null load all nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship-type to load from the graph. If null load all relationships</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">write</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if result should be written back as node property</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">concurrency</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">available CPUs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of concurrent threads</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">writeProperty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'centrality'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">property name written back to</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">graph</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'heavy'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">use 'heavy' when describing the subset of the graph with label and relationship-type parameter, 'cypher' for describing the subset with cypher node-statement and relationship-statement</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 16. Results</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nodes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of nodes considered</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">loadMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for loading data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">evalMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for running the algorithm</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">writeMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for writing result data back</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Running algorithm and streaming results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.closeness.stream(label:String, relationship:String,{concurrency:4})
YIELD nodeId, centrality - yields centrality for each node</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 17. Parameters</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">optional</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">label</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">label to load from the graph, if null load all nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship-type to load from the graph, if null load all relationships</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">concurrency</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">available CPUs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of concurrent threads</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">graph</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'heavy'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">use 'heavy' when describing the subset of the graph with label and relationship-type parameter, 'cypher' for describing the subset with cypher node-statement and relationship-statement</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 18. Results</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">node</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">node id</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">centrality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">closeness centrality weight</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_cypher_projection_4"><a class="link" href="#_cypher_projection_4">Cypher projection</a></h4>
<div class="paragraph">
<p>If label and relationship-type are not selective enough to describe your subgraph to run the algorithm on, you can use Cypher statements to load or project subsets of your graph.
Can be also used to run algorithms on a virtual graph.
Set <code>graph:'cypher'</code> in the config.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.closeness(
  'MATCH (p:Node) RETURN id(p) as id',
  'MATCH (p1:Node)-[:LINK]-&gt;(p2:Node) RETURN id(p1) as source, id(p2) as target',
  {graph:'cypher', write: true}
);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_versions_3"><a class="link" href="#_versions_3">Versions</a></h4>
<div class="paragraph">
<p>We support the following versions of the closeness centrality algorithm:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10003; directed, unweighted</p>
</li>
<li>
<p>&#10063; directed, weighted</p>
</li>
<li>
<p>&#10003; undirected, unweighted</p>
<div class="ulist">
<ul>
<li>
<p>Only with cypher projection</p>
</li>
</ul>
</div>
</li>
<li>
<p>&#10063; undirected, weighted</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_references_3"><a class="link" href="#_references_3">References</a></h4>
<div class="ulist">
<ul>
<li>
<p>[1] https://infoscience.epfl.ch/record/200525/files/[EN]ASNA09.pdf?</p>
</li>
<li>
<p><a href="https://toreopsahl.com/2010/03/20/closeness-centrality-in-networks-with-disconnected-components/" class="bare">https://toreopsahl.com/2010/03/20/closeness-centrality-in-networks-with-disconnected-components/</a></p>
</li>
<li>
<p><a href="http://www.casos.cs.cmu.edu/publications/papers/CMU-ISR-11-113.pdf" class="bare">http://www.casos.cs.cmu.edu/publications/papers/CMU-ISR-11-113.pdf</a></p>
</li>
<li>
<p><a href="http://mrvar.fdv.uni-lj.si/sola/info4/uvod/part4.pdf" class="bare">http://mrvar.fdv.uni-lj.si/sola/info4/uvod/part4.pdf</a></p>
</li>
<li>
<p><a href="http://qualquant.org/wp-content/uploads/networks/2008%201-7-3.pdf" class="bare">http://qualquant.org/wp-content/uploads/networks/2008%201-7-3.pdf</a></p>
</li>
<li>
<p><a href="https://www.andrew.cmu.edu/user/andersok/Katharine_A._Anderson/Social_Economic_and_Information_Networks_files/CentralitySlides.pdf" class="bare">https://www.andrew.cmu.edu/user/andersok/Katharine_A._Anderson/Social_Economic_and_Information_Networks_files/CentralitySlides.pdf</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_harmonic_centrality"><a class="link" href="#_harmonic_centrality">Harmonic Centrality</a></h3>
<div class="paragraph">
<p>The harmonic mean has been known since the time of Pythagoras and Plato as the mean expressing harmonious and tuneful ratios, and later has been employed by musicians to formalize the diatonic scale, and by architects as paradigm for beautiful proportions.[1]</p>
</div>
<div class="paragraph">
<p>Social network analysis is a rapid expanding interdisciplinary field, growing from work of sociologists, physicists, historians, mathematicians, political scientists, etc.
Some methods have been commonly accepted in spite of defects, perhaps because of the rareness of synthetic work like (Freeman, 1978; Faust &amp; Wasserman, 1992).
Harmonic centrality was proposed as an alternative index of closeness centrality defined on undirected networks.
Results show its computation on real cases are identical to those of the closeness centrality index, with same computational complexity and we give some interpretations.
An important property is its use in the case of unconnected networks.[2]</p>
</div>
<div class="sect3">
<h4 id="_history_explanation_4"><a class="link" href="#_history_explanation_4">History, Explanation</a></h4>
<div class="paragraph">
<p>Main problem of closeness centrality lies in the presence of pairs of unreachable nodes.
We get inspiration from Marchiori and Latora [1]: faced with the problem of providing a sensible notion of average shortest path for a generic directed network, they propose to replace the average distance with the harmonic mean of all distances (i.e., the n(n  1) distances between every pair of distinct nodes).
Indeed, in case a large number of pairs of nodes are not reachable, the average of finite distances can be misleading: a graph might have a very low average distance while it is almost completely disconnected (e.g., a perfect matching has average distance 1/2).
The harmonic mean has the useful property of handling  cleanly.
For example, the harmonic mean of distances of a perfect matching is n  1: in fact, for every node there is exactly another node at a non-infinite distance, and its distance is 1; so the sum of the inverse of all distances is n, making the harmonic average equal to n(n  1)/n = n  1.
In general, for each graph-theoretical notion based on arithmetic averaging or maximization there is an equivalent notion based on the harmonic mean.
If we consider closeness the reciprocal of a denormalized average of distances, it is natural to consider also the reciprocal of a denormalized harmonic mean of distances.[3]</p>
</div>
<div class="paragraph">
<p>The difference with might seem minor, but actually it is a radical change.
Harmonic centrality is strongly correlated to closeness centrality in simple networks, but naturally also accounts for nodes y that cannot reach x.
Thus, it can be fruitfully applied to graphs that are not strongly connected.[3]</p>
</div>
<div class="paragraph">
<p>Harmonic centrality was proposed independently by Dekker (2005)[4], using the name "valued centrality," and by Rochat (2009)[2].</p>
</div>
</div>
<div class="sect3">
<h4 id="_when_to_use_it_use_cases_4"><a class="link" href="#_when_to_use_it_use_cases_4">When to use it / use-cases</a></h4>
<div class="paragraph">
<p>Because harmonic centrality was proposed as an alternative to closeness centrality, they have similar use cases.
As an example, one can consider identifying the location within a city where to place a new public service, so that it is easily accessible for everyone.
Similarly, identifying central people that have ideal social network location for the purpose of information dissemination or network influence.
In such kind of applications, the nodes who can access the entire network faster need to be selected.
As mentioned above it can be fruitfully applied to graphs that are not connected.</p>
</div>
</div>
<div class="sect3">
<h4 id="_constraints_when_not_to_use_it_4"><a class="link" href="#_constraints_when_not_to_use_it_4">Constraints / when not to use it</a></h4>

</div>
<div class="sect3">
<h4 id="_algorithm_explanation_on_simple_sample_graph_4"><a class="link" href="#_algorithm_explanation_on_simple_sample_graph_4">Algorithm explanation on simple sample graph</a></h4>
<div class="imageblock">
<div class="content">
<img src="https://github.com/neo4j-contrib/neo4j-graph-algorithms/raw/3.2/doc/img/harmonic_centrality.png" alt="harmonic centrality">
</div>
</div>
<div class="listingblock">
<div class="title">Create sample graph</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CREATE (a:Node{id:"A"}),
       (b:Node{id:"B"}),
       (c:Node{id:"C"}),
       (d:Node{id:"D"}),
       (e:Node{id:"E"})
CREATE (a)-[:LINK]-&gt;(b),
       (b)-[:LINK]-&gt;(c),
       (d)-[:LINK]-&gt;(e);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Running algorithm and streaming results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.harmonic.stream('Node', 'LINKS') YIELD nodeId, centrality
RETURN nodeId,centrality order by centrality desc limit 20;

- yields centrality for each node</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Running algorithm and writing back results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.harmonic('Node', 'LINK', {writeProperty:'centrality'})
YIELD nodes,loadMillis, computeMillis, writeMillis;

- calculates closeness centrality and potentially writes back</code></pre>
</div>
</div>
<div class="paragraph">
<p>Calculation:</p>
</div>
<div class="paragraph">
<p>k = N-1 = 4</p>
</div>
<div class="literalblock">
<div class="content">
<pre>     A     B     C     D     E
 ---|-----------------------------
 A  | 0     1     2     -     -    // distance between each pair of nodes
 B  | 1     0     1     -     -    // or infinite if no path exists
 C  | 2     1     0     -     -
 D  | -     -     -     0     1
 E  | -     -     -     1     0
 ---|------------------------------
 A  | 0     1    1/2    0     0    // inverse
 B  | 1     0     1     0     0
 C  |1/2    1     0     0     0
 D  | 0     0     0     0     1
 E  | 0     0     0     1     0
 ---|------------------------------
sum |1.5    2    1.5    1     1
 ---|------------------------------
 *k |0.37  0.5  0.37  0.25  0.25</pre>
</div>
</div>
<div class="paragraph">
<p>instead of calculating the farness we sum the inverse
of each cell and multiply by 1/(n-1)</p>
</div>
</div>
<div class="sect3">
<h4 id="_example_usage_4"><a class="link" href="#_example_usage_4">Example Usage</a></h4>

</div>
<div class="sect3">
<h4 id="_syntax_4"><a class="link" href="#_syntax_4">Syntax</a></h4>
<div class="listingblock">
<div class="title">Running algorithm and writing back results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.harmonic(label:String, relationship:String,
{write:true, writeProperty:'centrality',graph:'heavy', concurrency:4})
YIELD nodes,loadMillis, computeMillis, writeMillis
- calculates closeness centrality and potentially writes back</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 19. Parameters</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">optional</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">label</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">label to load from the graph. If null load all nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship-type to load from the graph. If null load all relationships</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">write</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if result should be written back as node property</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">concurrency</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">available CPUs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of concurrent threads</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">writeProperty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'centrality'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">property name written back to</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">graph</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'heavy'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">use 'heavy' when describing the subset of the graph with label and relationship-type parameter, 'cypher' for describing the subset with cypher node-statement and relationship-statement</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 20. Results</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nodes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of nodes considered</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">loadMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for loading data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">evalMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for running the algorithm</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">writeMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for writing result data back</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Running algorithm and streaming results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.harmonic.stream(label:String, relationship:String,{concurrency:4})
YIELD nodeId, centrality - yields centrality for each node</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 21. Parameters</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">optional</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">label</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">label to load from the graph, if null load all nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship-type to load from the graph, if null load all relationships</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">concurrency</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">available CPUs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of concurrent threads</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 22. Results</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">node</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">node id</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">centrality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">closeness centrality weight</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_cypher_projection_5"><a class="link" href="#_cypher_projection_5">Cypher projection</a></h4>
<div class="paragraph">
<p>If label and relationship-type are not selective enough to describe your subgraph to run the algorithm on, you can use Cypher statements to load or project subsets of your graph.
Can be also used to run algorithms on a virtual graph.
Set <code>graph:'cypher'</code> in the config.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.harmonic(
  'MATCH (p:Node) RETURN id(p) as id',
  'MATCH (p1:Node)-[:LINK]-(p2:Node) RETURN id(p1) as source, id(p2) as target',
  {graph:'cypher', writeProperty: 'centrality'}
);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_versions_4"><a class="link" href="#_versions_4">Versions</a></h4>
<div class="paragraph">
<p>We support the following versions of the harmonic centrality algorithm:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10003; undirected, unweighted</p>
</li>
<li>
<p>&#10063; undirected, weighted</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_references_4"><a class="link" href="#_references_4">References</a></h4>
<div class="ulist">
<ul>
<li>
<p>[1] <a href="https://arxiv.org/pdf/cond-mat/0008357.pdf" class="bare">https://arxiv.org/pdf/cond-mat/0008357.pdf</a></p>
</li>
<li>
<p>[2] https://infoscience.epfl.ch/record/200525/files/[EN]ASNA09.pdf?</p>
</li>
<li>
<p>[3] <a href="https://arxiv.org/pdf/1308.2140.pdf" class="bare">https://arxiv.org/pdf/1308.2140.pdf</a></p>
</li>
<li>
<p>[4] <a href="https://www.cmu.edu/joss/content/articles/volume6/dekker/index.html" class="bare">https://www.cmu.edu/joss/content/articles/volume6/dekker/index.html</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_minimum_weight_spanning_tree"><a class="link" href="#_minimum_weight_spanning_tree">Minimum Weight Spanning Tree</a></h3>
<div class="paragraph">
<p>A <em>Minimum Weight Spanning Tree</em> (MST) is a subgraph that contains all the nodes from the original graph and the set of relationships that connect the nodes together with the minimum possible weight.
Our current approach uses <em>Prim&#8217;s Algorithm</em> to calculate the MST starting at a given node.
The K-Means variant can be used to detect clusters in the graph.</p>
</div>
<div class="sect3">
<h4 id="_history_explanation_5"><a class="link" href="#_history_explanation_5">History, Explanation</a></h4>
<div class="paragraph">
<p>In graph theory, a tree is a way of connecting all the nodes together, so that there is exactly one path from a node to any other node in the tree.
If the graph represents cities connected by roads, one could select a number of roads, so that each city can be reached from every other, but that there is no more than one way to travel from one city to another.</p>
</div>
<div class="paragraph">
<p>Most of the time, graphs are weighted; each connection between two cities has a weight: It might cost something to travel on a given road, or one connection may be longer than the other, this means it takes more time to travel on that connection.</p>
</div>
<div class="paragraph">
<p>A graph might have more than one minimum spanning tree.
In a graph where all the relationships have the same weight, every tree is a minimum spanning tree.
If all the relationships have different weights there is exactly one minimal spanning tree.</p>
</div>
<div class="paragraph">
<p>Czech scientist Otakar Borvka developed the first known algorithm for finding a minimum spanning tree in 1926, while trying to find an efficient electricity network for Moravia.
This algorithm is known as Borvka&#8217;s algorithm.</p>
</div>
<div class="paragraph">
<p>Prim&#8217;s algorithm (sometimes known as the Jarnk-Prim algorithm) is one of the simplest and best-known minimum spanning tree algorithms.
It is similar to Dijkstra&#8217;s algorithm, but rather than minimizing the total length of a path ending at each relationship we minimize the length of each relationship individually.
Unlike Dijkstra&#8217;s, Prim&#8217;s can tolerate negative-weight relationships.
It is optimal for dense graphs.</p>
</div>
<div class="paragraph">
<p>The algorithm operates as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>start with a trivial tree containing only one node (and no relationship). It does not matter which node is chosen.</p>
</li>
<li>
<p>select the minimal-weight relationship coming from that node and add it to our tree.</p>
</li>
<li>
<p>repeatedly choose a minimal-weight relationship that joins any node in the tree to one not in the tree, adding the new relationship and node to our tree. Such a relationship will always exist when the tree is incomplete because otherwise the partially built tree would be an isolated component but we know the graph consists of a single connected component.</p>
</li>
<li>
<p>when there are no more nodes to add, the tree we have built is a minimum spanning tree.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_when_to_use_it_use_cases_5"><a class="link" href="#_when_to_use_it_use_cases_5">When to use it / use-cases</a></h4>
<div class="paragraph">
<p>Imagine a telecommunications company is trying to lay out cables in new neighborhood.
If the company is only able to lay the cable along certain paths (e.g. along roads), we could derive a graph that represents the points connected by those paths.
Some of those paths might be more expensive, because they are longer, or require the cable to be buried deeper; these paths would be represented by relationships with larger weights.
A spanning tree for that graph would be a subset of those paths that has no cycles but still connects to every house; in fact several spanning trees might be possible.
A minimum spanning tree would be the one with the lowest total cost, which would represent the least expensive path for laying the cable.</p>
</div>
<div class="paragraph">
<p>There are also some indirect applications such as LDPC codes for error correction, image registration with Renyi entropy, learning salient features for real-time face verification, model locality of particle interactions in turbulent fluid flows and autoconfig protocol for Ethernet bridging to avoid cycles in a network.</p>
</div>
</div>
<div class="sect3">
<h4 id="_constraints_when_not_to_use_it_5"><a class="link" href="#_constraints_when_not_to_use_it_5">Constraints / when not to use it</a></h4>
<div class="paragraph">
<p>The MST algorithm only gives meaningful results when run on a graph where the relationships have different weights.
If the graph has no weights or all relationships have the same weight then any spanning tree is a minimum spanning tree.</p>
</div>
</div>
<div class="sect3">
<h4 id="_algorithm_explanation_on_simple_sample_graph_5"><a class="link" href="#_algorithm_explanation_on_simple_sample_graph_5">Algorithm explanation on simple sample graph</a></h4>
<div class="imageblock">
<div class="content">
<img src="https://github.com/neo4j-contrib/neo4j-graph-algorithms/raw/3.2/doc/img/mst.png" alt="mst">
</div>
</div>
<div class="listingblock">
<div class="title">Create sample graph</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CREATE (a:Place{id:"A"}),
       (b:Place{id:"B"}),
       (c:Place{id:"C"}),
       (d:Place{id:"D"}),
       (e:Place{id:"E"})
CREATE (d)-[:LINK{cost:4}]-&gt;(b),
       (d)-[:LINK{cost:6}]-&gt;(e),
       (b)-[:LINK{cost:1}]-&gt;(a),
       (b)-[:LINK{cost:3}]-&gt;(c),
       (a)-[:LINK{cost:2}]-&gt;(c),
       (c)-[:LINK{cost:5}]-&gt;(e);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Minimum weighted spanning tree visits all nodes that are in the same connected component as the starting node and returns a spanning tree of all nodes in the component where the total weight of the relationships is minimized.</p>
</div>
<div class="listingblock">
<div class="title">Running minimum spanning tree algorithm and writing back results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">MATCH (n:Place{id:"D"})
CALL algo.spanningTree.minimum('Place','LINK', 'cost',id(n), {write:true, writeProperty:"MINST"})
YIELD loadMillis, computeMillis, writeMillis, effectiveNodeCount
RETURN loadMillis,computeMillis,writeMillis, effectiveNodeCount;</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="https://github.com/neo4j-contrib/neo4j-graph-algorithms/raw/3.2/doc/img/minst_result.png" alt="minst result">
</div>
<div class="title">Figure 1. Results</div>
</div>
<div class="paragraph">
<p>Maximum weighted tree spanning algorithm is similar to the mininum one, except that it returns a spanning tree of all nodes in the component where the total weight of the relationships is maximized.</p>
</div>
<div class="listingblock">
<div class="title">Running maximum spanning tree algorithm and writing back results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">MATCH (n:Place{id:"D"})
CALL algo.spanningTree.maximum('Place', 'LINK', 'cost',id(n), {write:true, writeProperty:"MAXST"})
YIELD loadMillis, computeMillis, writeMillis, effectiveNodeCount
RETURN loadMillis,computeMillis,writeMillis, effectiveNodeCount;</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="https://github.com/neo4j-contrib/neo4j-graph-algorithms/raw/3.2/doc/img/maxst_result.png" alt="maxst result">
</div>
</div>
<div class="sect4">
<h5 id="_k_spanning_tree"><a class="link" href="#_k_spanning_tree">k-Spanning tree</a></h5>
<div class="paragraph">
<p>Sometimes we want to limit the size of our spanning tree result as we are only interested in finding a smaller tree within our graph that does not span across all nodes.
K-Spanning tree algorithm returns a tree with k nodes and k  1 relationships.</p>
</div>
<div class="paragraph">
<p>In our sample graph we have 5 nodes.
When we ran MST above we got returned a 5-minimum spanning tree, that covered all five nodes.
By setting the <code>k=3</code> we define that we want to get returned a 3-minimum spanning tree that covers 3 nodes and has 2 relationships.</p>
</div>
<div class="listingblock">
<div class="title">Running k-minimum spanning tree algorithm and writing back results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">MATCH (n:Place{id:"D"})
CALL algo.spanningTree.kmin('Place', 'LINK', 'cost',id(n), 3, {writeProperty:"kminst"})
YIELD loadMillis, computeMillis, writeMillis, effectiveNodeCount
RETURN loadMillis,computeMillis,writeMillis, effectiveNodeCount;</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 23. Results</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Place</th>
<th class="tableblock halign-left valign-top">partition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">D</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">E</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Nodes A, B and C are the result 3-minimum spanning tree of our graph.</p>
</div>
<div class="listingblock">
<div class="title">Running k-maximum spanning tree algorithm and writing back results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">MATCH (n:Place{id:"D"})
CALL algo.spanningTree.kmax('Place', 'LINK', 'cost',id(n), 3, {writeProperty:"kmaxst"})
YIELD loadMillis, computeMillis, writeMillis, effectiveNodeCount
RETURN loadMillis,computeMillis,writeMillis, effectiveNodeCount;</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 24. Results</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Place</th>
<th class="tableblock halign-left valign-top">partition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">D</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">E</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Nodes C, D and E are the result 3-maximum spanning tree of our graph.</p>
</div>
<div class="paragraph">
<p>When we run this algorithm on a bigger graph we can use the following query to find nodes that belong to our k-spanning tree result.</p>
</div>
<div class="listingblock">
<div class="title">Find nodes that belong to our k-spanning tree result.</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">MATCH (n:Place)
WITH n.partition as partition, count(*) as count
WHERE count = k
RETURN n</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_example_usage_5"><a class="link" href="#_example_usage_5">Example Usage</a></h4>

</div>
<div class="sect3">
<h4 id="_syntax_5"><a class="link" href="#_syntax_5">Syntax</a></h4>
<div class="listingblock">
<div class="title">Running algorithm and writing back results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.spanningTree(label:String, relationshipType:String, weightProperty:String, startNodeId:int, {writeProperty:String})
YIELD loadMillis, computeMillis, writeMillis, effectiveNodeCount</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 25. Parameters</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">optional</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">label</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">label to load from the graph. If null load all nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationshipType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship-type to load from the graph. If null load all nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">weightProperty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">property name that contains weight. Must be numeric.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">startNodeId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">start node id</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">write</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if result should be written back as relationships</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">writeProperty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'mst'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship-type written back as result</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 26. Results</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">effectiveNodeCount</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of visited nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">loadMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for loading data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">computeMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for running the algorithm</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">writeMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for writing result data back</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Running k-spanning tree algorithm and writing back results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.spanningTree.k*(label:String, relationshipType:String, weightProperty:String, startNodeId:int, k:int, {writeProperty:String})
YIELD loadMillis, computeMillis, writeMillis, effectiveNodeCount</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 27. Parameters</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">optional</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">label</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">label to load from the graph. If null load all nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationshipType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">weightProperty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">property name that contains weight. Must be numeric.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">startNodeId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">start node id</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">k</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">result is a tree with k nodes and k  1 relationships</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">write</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if result should be written back as node property</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">writeProperty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'mst'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship-type written back as result</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 28. Results</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">effectiveNodeCount</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of visited nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">loadMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for loading data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">computeMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for running the algorithm</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">writeMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for writing result data back</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_versions_5"><a class="link" href="#_versions_5">Versions</a></h4>
<div class="paragraph">
<p>We support the following versions of the minimum weight spanning tree algorithm:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10003; undirected, weighted</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_references_5"><a class="link" href="#_references_5">References</a></h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://en.wikipedia.org/wiki/Minimum_spanning_tree" class="bare">https://en.wikipedia.org/wiki/Minimum_spanning_tree</a></p>
</li>
<li>
<p><a href="http://www.statisticshowto.com/minimum-spanning-tree" class="bare">http://www.statisticshowto.com/minimum-spanning-tree</a></p>
</li>
<li>
<p><a href="http://algs4.cs.princeton.edu/43mst/" class="bare">http://algs4.cs.princeton.edu/43mst/</a></p>
</li>
<li>
<p><a href="https://www.cs.princeton.edu/~rs/AlgsDS07/14MST.pdf" class="bare">https://www.cs.princeton.edu/~rs/AlgsDS07/14MST.pdf</a></p>
</li>
<li>
<p><a href="https://www.cs.cmu.edu/~wlovas/15122-r11/lectures/old/26-spanning.pdf" class="bare">https://www.cs.cmu.edu/~wlovas/15122-r11/lectures/old/26-spanning.pdf</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_single_source_shortest_path"><a class="link" href="#_single_source_shortest_path">Single Source Shortest Path</a></h3>
<div class="paragraph">
<p>The <em>Single Source Shortest Path</em> algorithm calculates the shortest weight path between a pair of nodes.
A common algorithm used is Dijkstra.</p>
</div>
<div class="sect3">
<h4 id="_history_explanation_6"><a class="link" href="#_history_explanation_6">History, Explanation</a></h4>
<div class="paragraph">
<p>Path finding has a long history and is considered to be one of the classical graph problems.
It has been researched as far back as the 19th century.
Classical references are Wiener [1873], Lucas [1882] (describing a method due to C.P. Tremaux), and Tarry [1895]  see Biggs, Lloyd, and Wilson [1976].</p>
</div>
<div class="paragraph">
<p>Dijkstra thought about the shortest path problem when working as a programmer at the Mathematical Center in Amsterdam in 1956 to demonstrate the capabilities of the new ARMAC computer.
His wanted to choose both a problem and an answer (that would be produced by computer) that non-computing people could understand.
He designed what is now known as Dijkstra&#8217;s algorithm and later implemented it on the ARMAC for a slightly simplified transportation map of 64 cities in the Netherlands.</p>
</div>
<div class="paragraph">
<p>It gained prominence in the early 1950s in the context of alternate routing
i.e. finding a second shortest route if the shortest route is blocked.
It found uses in urban planning <a href="http://onlinepubs.trb.org/Onlinepubs/hrbbulletin/61/61-003.pdf">[1</a>] as well as telephone call routing.</p>
</div>
</div>
<div class="sect3">
<h4 id="_when_to_use_it_use_cases_6"><a class="link" href="#_when_to_use_it_use_cases_6">When to use it / use-cases</a></h4>
<div class="paragraph">
<p>The most common usage of the single source shortest path algorithm is finding directions between physical locations.
Web mapping websites such as MapQuest or Google Maps use it to provide driving directions.</p>
</div>
<div class="paragraph">
<p>It has also found uses in several other areas including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Telecommunications and networking</p>
</li>
<li>
<p>Operations research - plant and facility layout, robotics, transportation, and VLSI design.</p>
</li>
<li>
<p>Social networks - find the degrees of separation between people</p>
</li>
<li>
<p>IP routing - find the <a href="https://en.wikipedia.org/wiki/Open_Shortest_Path_First" target="_blank">Open Shortest Path First</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_constraints_when_not_to_use_it_6"><a class="link" href="#_constraints_when_not_to_use_it_6">Constraints / when not to use it</a></h4>
<div class="paragraph">
<p>Dijkstra does not support negative weights.
The algorithm assumes that adding a relationship to a path can never make a path shorter - an invariant that would be violated with negative weights.</p>
</div>
</div>
<div class="sect3">
<h4 id="_algorithm_explanation_on_simple_sample_graph_6"><a class="link" href="#_algorithm_explanation_on_simple_sample_graph_6">Algorithm explanation on simple sample graph</a></h4>
<div class="imageblock">
<div class="content">
<img src="https://github.com/neo4j-contrib/neo4j-graph-algorithms/raw/3.2/doc/img/sssp.png" alt="sssp">
</div>
</div>
<div class="listingblock">
<div class="title">Create sample graph</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CREATE (a:Loc{name:'A'}), (b:Loc{name:'B'}), (c:Loc{name:'C'}),
       (d:Loc{name:'D'}), (e:Loc{name:'E'}), (f:Loc{name:'F'}),
       (a)-[:ROAD {cost:50}]-&gt;(b),
       (a)-[:ROAD {cost:50}]-&gt;(c),
       (a)-[:ROAD {cost:100}]-&gt;(d),
       (a)-[:RAIL {cost:50}]-&gt;(d),
       (b)-[:ROAD {cost:40}]-&gt;(d),
       (c)-[:ROAD {cost:40}]-&gt;(d),
       (c)-[:ROAD {cost:80}]-&gt;(e),
       (d)-[:ROAD {cost:30}]-&gt;(e),
       (d)-[:ROAD {cost:80}]-&gt;(f),
       (e)-[:ROAD {cost:40}]-&gt;(f),
       (e)-[:RAIL {cost:20}]-&gt;(f);</code></pre>
</div>
</div>
<div class="sect5">
<h6 id="_dijkstra_single_source_shortest_path_algorithm"><a class="link" href="#_dijkstra_single_source_shortest_path_algorithm">Dijkstra single source shortest path algorithm</a></h6>
<div class="listingblock">
<div class="title">Running algorithm and streaming results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">MATCH (start:Loc{name:'A'}), (end:Loc{name:'F'})
CALL algo.shortestPath.stream(start, end, 'cost')
YIELD nodeId, cost
RETURN nodeId, cost LIMIT 20</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Running algorithm and writing back results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">MATCH (start:Loc{name:'A'}), (end:Loc{name:'F'})
CALL algo.shortestPath(start, end, 'cost',{write:true,writeProperty:'sssp'})
YIELD writeMillis,loadMillis,nodeCount, totalCost
RETURN writeMillis,loadMillis,nodeCount,totalCost</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_delta_stepping_algorithm"><a class="link" href="#_delta_stepping_algorithm">Delta stepping algorithm</a></h6>
<div class="listingblock">
<div class="title">Running algorithm and streaming results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">MATCH (n:Loc {name:'A'})
CALL algo.shortestPath.deltaStepping.stream(n, 'cost', 3.0)
YIELD nodeId, distance
RETURN nodeId, distance LIMIT 20</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Running algorithm and writing back results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">MATCH (n:Loc {name:'A'})
CALL algo.shortestPath.deltaStepping(n, 'cost', 3.0, {defaultValue:1.0, write:true, writeProperty:'sssp'})
YIELD nodeCount, loadDuration, evalDuration, writeDuration
RETURN nodeCount, loadDuration, evalDuration, writeDuration</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_example_usage_6"><a class="link" href="#_example_usage_6">Example Usage</a></h4>

</div>
<div class="sect3">
<h4 id="_syntax_6"><a class="link" href="#_syntax_6">Syntax</a></h4>
<div class="listingblock">
<div class="title">Running algorithm and writing back results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.shortestPath(startNode:Node, endNode:Node, weightProperty:String
{nodeQuery:'labelName', relationshipQuery:'relationshipName', defaultValue:1.0,write:'true',writeProperty:'sssp',direction:'OUTGOING'})
YIELD nodeCount, totalCost, loadMillis, evalMillis, writeMillis</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 29. Parameters</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">optional</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">startNode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">node</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">start node</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">endNode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">node</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">end node</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">weightProperty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">property name that contains weight, if null treats the graph as unweighted. Must be numeric.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">defaultValue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">default value of the weight in case it is missing or invalid</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">write</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if result should be written back as node property</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">writeProperty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'sssp'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">property name written back to the node sequence of the node in the path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nodeQuery</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">label to load from the graph, if null load all nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationshipQuery</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship-type to load from the graph, if null load all nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">direction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">outgoing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship direction to load from the graph, if 'both' treats the relationships as undirected</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 30. Results</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nodeCount</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of nodes considered</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">totalCost</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sum of all weights along the path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">loadMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for loading data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">evalMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for running the algorithm</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">writeMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for writing result data back</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Running algorithm and streaming results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.shortestPath.stream(startNode:Node, endNode:Node, weightProperty:String
{nodeQuery:'labelName', relationshipQuery:'relationshipName', defaultValue:1.0, direction:'OUTGOING'})
 YIELD nodeId, cost</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 31. Parameters</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">optional</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">startNode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">node</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">start node</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">endNode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">node</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">end node</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">weightProperty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">property name that contains weight, if null treats the graph as unweighted. Must be numeric.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nodeQuery</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">label to load from the graph, if null load all nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationshipQuery</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship-type to load from the graph, if null load all nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">defaultValue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">default value of the weight in case it is missing or invalid</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">direction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">outgoing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship direction to load from the graph, if 'both' treats the relationships as undirected</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 32. Results</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nodeId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">node id</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cost</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cost it takes to get from start node to specific node</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_versions_6"><a class="link" href="#_versions_6">Versions</a></h4>
<div class="paragraph">
<p>We support the following versions of the shortest path algorithms:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10003; directed, unweighted:</p>
<div class="ulist">
<ul>
<li>
<p>direction: 'OUTGOING' or INCOMING, weightProperty: null</p>
</li>
</ul>
</div>
</li>
<li>
<p>&#10003; directed, weighted</p>
<div class="ulist">
<ul>
<li>
<p>direction: 'OUTGOING' or INCOMING, weightProperty: 'cost'</p>
</li>
</ul>
</div>
</li>
<li>
<p>&#10003; undirected, unweighted</p>
<div class="ulist">
<ul>
<li>
<p>direction: 'BOTH', weightProperty: null</p>
</li>
</ul>
</div>
</li>
<li>
<p>&#10003; undirected, weighted</p>
<div class="ulist">
<ul>
<li>
<p>direction: 'BOTH', weightProperty: 'cost'</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_implementations_2"><a class="link" href="#_implementations_2">Implementations</a></h4>
<div class="paragraph">
<p><code>algo.shortestPath</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>specify start and end node, find the shortest path between them</p>
</li>
<li>
<p>Dijkstra single source shortest path algorithm</p>
</li>
<li>
<p>there may be more then one shortest path, algo returns only one</p>
</li>
<li>
<p>if initialized with an non-existing weight-property it will treat the graph as unweighted</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>algo.shortestPath.deltaStepping</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>specify start node, find the shortest paths to all other nodes</p>
</li>
<li>
<p>parallel non-negative single source shortest path algorithm for weighted graphs</p>
</li>
<li>
<p>It can be tweaked using the delta-parameter which controls the grade of concurrency.</p>
</li>
<li>
<p>if initialized with an non-existing weight-property it will treat the graph as unweighted</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>algo.shortestPaths</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>specify start node, find the shortest paths to all other nodes</p>
</li>
<li>
<p>Dijkstra single source shortest path algorithm</p>
</li>
<li>
<p>if initialized with an non-existing weight-property it will treat the graph as unweighted</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_references_6"><a class="link" href="#_references_6">References</a></h4>
<div class="ulist">
<ul>
<li>
<p>[1] <a href="http://onlinepubs.trb.org/Onlinepubs/hrbbulletin/61/61-003.pdf" target="_blank">Effect of travel time and distance on freeway usage</a></p>
</li>
<li>
<p><a href="http://www.math.uiuc.edu/documenta/vol-ismp/32_schrijver-alexander-sp.pdf" class="bare">http://www.math.uiuc.edu/documenta/vol-ismp/32_schrijver-alexander-sp.pdf</a></p>
</li>
<li>
<p><a href="http://www.math.ias.edu/~pooyahat/Dijkstra.pdf" class="bare">http://www.math.ias.edu/~pooyahat/Dijkstra.pdf</a></p>
</li>
<li>
<p><a href="https://arxiv.org/pdf/1604.02113v1.pdf" class="bare">https://arxiv.org/pdf/1604.02113v1.pdf</a></p>
</li>
<li>
<p><a href="https://www.cc.gatech.edu/~bader/papers/ShortestPaths-ALENEX2007.pdf" class="bare">https://www.cc.gatech.edu/~bader/papers/ShortestPaths-ALENEX2007.pdf</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_all_pairs_shortest_path"><a class="link" href="#_all_pairs_shortest_path">All Pairs Shortest Path</a></h3>
<div class="paragraph">
<p><em>All Pairs Shortest Path</em> calculates the shortest weight path between all pairs of nodes.
An algorithm to solve this is Floyd Warshall or Parallel Johnson&#8217;s algorithm.</p>
</div>
<div class="sect3">
<h4 id="_history_explanation_7"><a class="link" href="#_history_explanation_7">History, Explanation</a></h4>
<div class="paragraph">
<p>This algorithm finds shortest paths between all pairs of nodes in the graph.
Some pairs of nodes might not be reachable between each other, so no shortest path exist between these pairs of nodes.
In this scenario the algorithm will return <code>Infinity</code> value as a result between these pairs of nodes.</p>
</div>
<div class="paragraph">
<p>Plain cypher does not support filtering <code>Infinity</code> values, so <code>algo.isFinite</code> function was added to help filter <code>Infinity</code> values from results.</p>
</div>
</div>
<div class="sect3">
<h4 id="_when_to_use_it_use_cases_7"><a class="link" href="#_when_to_use_it_use_cases_7">When to use it / use-cases</a></h4>
<div class="paragraph">
<p>The all pairs shortest path algorithm has found uses in the following areas:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>urban planning and simulation <a href="http://web.mit.edu/urban_or_book/www/book/">[1</a>]</p>
</li>
<li>
<p>datacenter network design <a href="https://cs.uwaterloo.ca/research/tr/2011/CS-2011-21.pdf">[2</a>]</p>
</li>
<li>
<p>traffic routing</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_constraints_when_not_to_use_it_7"><a class="link" href="#_constraints_when_not_to_use_it_7">Constraints / when not to use it</a></h4>

</div>
<div class="sect3">
<h4 id="_algorithm_explanation_on_simple_sample_graph_7"><a class="link" href="#_algorithm_explanation_on_simple_sample_graph_7">Algorithm explanation on simple sample graph</a></h4>
<div class="imageblock">
<div class="content">
<img src="https://github.com/neo4j-contrib/neo4j-graph-algorithms/raw/3.2/doc/img/sssp.png" alt="sssp">
</div>
</div>
<div class="listingblock">
<div class="title">Create sample graph</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CREATE (a:Loc{name:'A'}), (b:Loc{name:'B'}), (c:Loc{name:'C'}),
       (d:Loc{name:'D'}), (e:Loc{name:'E'}), (f:Loc{name:'F'}),
       (a)-[:ROAD {cost:50}]-&gt;(b),
       (a)-[:ROAD {cost:50}]-&gt;(c),
       (a)-[:ROAD {cost:100}]-&gt;(d),
       (a)-[:RAIL {cost:50}]-&gt;(d),
       (b)-[:ROAD {cost:40}]-&gt;(d),
       (c)-[:ROAD {cost:40}]-&gt;(d),
       (c)-[:ROAD {cost:80}]-&gt;(e),
       (d)-[:ROAD {cost:30}]-&gt;(e),
       (d)-[:ROAD {cost:80}]-&gt;(f),
       (e)-[:ROAD {cost:40}]-&gt;(f),
       (e)-[:RAIL {cost:20}]-&gt;(f);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Running algorithm and streaming results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.allShortestPaths.stream('cost',{nodeQuery:'Loc',defaultValue:1.0})
YIELD sourceNodeId, targetNodeId, distance
WITH sourceNodeId, targetNodeId, distance
WHERE algo.isFinite(distance) = true
RETURN sourceNodeId, targetNodeId, distance LIMIT 20</code></pre>
</div>
</div>
<div class="paragraph">
<p>For now only single-source shortest path support loading the relationship as undirected, but we can use cypher loading to help us solve this.
Undirected graph can be represented as <a href="https://en.wikipedia.org/wiki/Bidirected_graph">Bidirected graph</a>, that is a directed graph in which the reverse of every relationship is also a relationship.</p>
</div>
<div class="paragraph">
<p>We do not have to save this reversed relationship, we can project it using <strong>cypher loading</strong>.
Note that relationship query does not specify direction of the relationship.
This is applicable to all other algorithms, that use <strong>cypher loading</strong>.</p>
</div>
<div class="listingblock">
<div class="title">Running all pairs shortest path treating the graph as undirected</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.allShortestPaths.stream('cost', {
nodeQuery:'MATCH (n:Loc) RETURN id(n) as id',
relationshipQuery:'MATCH (n:Loc)-[r]-(p:Loc) RETURN id(n) as source, id(p) as target, r.cost as weight',
graph:'cypher', defaultValue:1.0})</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_when_to_use_it_use_cases_8"><a class="link" href="#_when_to_use_it_use_cases_8">When to use it / use-cases</a></h4>

</div>
<div class="sect3">
<h4 id="_constraints_when_not_to_use_it_8"><a class="link" href="#_constraints_when_not_to_use_it_8">Constraints / when not to use it</a></h4>

</div>
<div class="sect3">
<h4 id="_implementations_3"><a class="link" href="#_implementations_3">Implementations</a></h4>
<div class="paragraph">
<p><code>algo.allShortestPaths.stream</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>find shortest paths between all pairs of nodes</p>
</li>
<li>
<p>returns a stream of source-target node to distance tuples for each pair of nodes</p>
</li>
<li>
<p>writeback not supported</p>
</li>
<li>
<p>if initialized with an non-existing weight-property it will treat the graph as unweighted</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_community_detection_triangle_counting_clustering_coefficient"><a class="link" href="#_community_detection_triangle_counting_clustering_coefficient">Community detection: Triangle Counting / Clustering Coefficient</a></h3>
<div class="paragraph">
<p>Triangle counting is a community detection graph algorithm that is used to determine the number of triangles passing through each node in the graph.
A triangle is a set of three nodes where each node has a relationship to all other nodes.</p>
</div>
<div class="sect3">
<h4 id="_history_explanation_8"><a class="link" href="#_history_explanation_8">History, Explanation</a></h4>
<div class="paragraph">
<p>Triangle counting gained popularity in social network analysis where it is used to detect communities and measure the cohesiveness of those communities.
It is often used as part of the computation of network indices such as the clustering coefficient.</p>
</div>
<div class="paragraph">
<p>There are two types of clustering coefficient:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <strong>local clustering coefficient</strong> of a node is the likelihood that its neighbours are also connected. The computation of this score involves triangle counting.</p>
</li>
<li>
<p>The <strong>global clustering coefficient</strong> is the normalized sum of those local clustering coefficients.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The transitivity coefficient of a graph, which is just three times the number of triangles divided by the number of triples in the graph is sometimes used.[2]</p>
</div>
</div>
<div class="sect3">
<h4 id="_when_to_use_it_use_cases_9"><a class="link" href="#_when_to_use_it_use_cases_9">When to use it / use-cases</a></h4>
<div class="paragraph">
<p>Triangle counting has gained popularity in many other domains including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>computer network security - intrusion detection and spamming</p>
</li>
<li>
<p>web applications - community detection and blog analysis</p>
</li>
<li>
<p>social network analysis - link prediction, spam filters, content quality control <a href="https://pdfs.semanticscholar.org/110b/55a017f52abfedca220036ea129d84b7cadc.pdf">[5]</a></p>
</li>
<li>
<p>biological networks - protein-protein interaction analysis <a href="https://bmcbioinformatics.biomedcentral.com/track/pdf/10.1186/1471-2105-6-270?site=bmcbioinformatics.biomedcentral.com">[7]</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_constraints_when_not_to_use_it_9"><a class="link" href="#_constraints_when_not_to_use_it_9">Constraints / when not to use it</a></h4>

</div>
<div class="sect3">
<h4 id="_algorithm_explanation_on_simple_sample_graph_8"><a class="link" href="#_algorithm_explanation_on_simple_sample_graph_8">Algorithm explanation on simple sample graph</a></h4>
<div class="imageblock">
<div class="content">
<img src="https://github.com/neo4j-contrib/neo4j-graph-algorithms/raw/3.2/doc/img/triangle_count.png" alt="triangle count">
</div>
</div>
<div class="listingblock">
<div class="title">Create sample graph</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CREATE (alice:Person{id:"Alice"}),
       (michael:Person{id:"Michael"}),
       (karin:Person{id:"Karin"}),
       (chris:Person{id:"Chris"}),
       (will:Person{id:"Will"}),
       (mark:Person{id:"Mark"})
CREATE (michael)-[:KNOWS]-&gt;(karin),
       (michael)-[:KNOWS]-&gt;(chris),
       (will)-[:KNOWS]-&gt;(michael),
       (mark)-[:KNOWS]-&gt;(michael),
       (mark)-[:KNOWS]-&gt;(will),
       (alice)-[:KNOWS]-&gt;(michael),
       (will)-[:KNOWS]-&gt;(chris),
       (chris)-[:KNOWS]-&gt;(karin);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">returns a stream of triples with nodeIds for each triangle.</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.triangle.stream('Person','KNOWS')
yield nodeA,nodeB,nodeC;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">counts the number of triangles a node is member of and writes it back. Returns total triangle count and average clustering coefficient of the given graph.</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.triangleCount('Person', 'KNOWS',
  {concurrency:4, write:true, writeProperty:'triangles',clusteringCoefficientProperty:'coefficient'})
YIELD loadMillis, computeMillis, writeMillis, nodeCount, triangleCount, averageClusteringCoefficient;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">counts number of triangles a node is member of and returns a stream with nodeId and triangleCount</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.triangleCount.stream('Person', 'KNOWS', {concurrency:4})
YIELD nodeId, triangles;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_example_usage_7"><a class="link" href="#_example_usage_7">Example Usage</a></h4>
<div class="paragraph">
<p>In graph theory, a clustering coefficient is a measure of the degree to which nodes in a graph tend to cluster together.
Evidence suggests that in most real-world networks, and in particular social networks, nodes tend to create tightly knit groups characterised by a relatively high density of ties; this likelihood tends to be greater than the average probability of a tie randomly established between two nodes.[4]</p>
</div>
<div class="paragraph">
<p>We check if this holds true for Yelp&#8217;s social network of friends.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.triangleCount('User', 'FRIEND',
  {concurrency:4, write:true, writeProperty:'triangles',clusteringCoefficientProperty:'coefficient'})
YIELD loadMillis, computeMillis, writeMillis, nodeCount, triangleCount, averageClusteringCoefficient;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Average clustering coefficient is 0.0523, which is really low for a social network.
This indicates that groups of friends are not tightly knit together, but rather sparse.
We can assume that users are not on Yelp for finding and creating friends, like for example Facebook, but rather something else, like finding good restaurant recommendations.</p>
</div>
<div class="paragraph">
<p>Local triangle count and clustering coefficient of nodes can be used as features in finding influencers in social networks.</p>
</div>
</div>
<div class="sect3">
<h4 id="_syntax_7"><a class="link" href="#_syntax_7">Syntax</a></h4>
<div class="listingblock">
<div class="title">returns a stream of triples with nodeIds for each triangle.</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.triangle.stream(label:String, relationship:String, {concurrency:4})
YIELD nodeA, nodeB, nodeC - yield nodeA, nodeB and nodeC which form a triangle</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 33. Parameters</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">optional</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">label</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">label to load from the graph, if null load all nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship-type to load from the graph, if null load all nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">concurrency</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">available CPUs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of concurrent threads</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 34. Results</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nodeA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">id of node in the given triangle</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nodeB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">id of node in the given triangle</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nodeC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">id of node in the given triangle</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">counts number of triangles a node is member of and returns a stream with nodeId and triangleCount</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.triangleCount.stream(label:String, relationship:String, {concurrency:4})
YIELD nodeId, triangles - yield nodeId, number of triangles</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 35. Parameters</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">optional</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">label</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">label to load from the graph. If null load all nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship-type to load from the graph. If null load all relationships</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">concurrency</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">available CPUs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of concurrent threads</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 36. Results</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nodeId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">id of node</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">triangles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of triangles a node is member of</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">counts the number of triangles a node is member of and writes it back. Returns total triangle count and average clustering coefficient of the given graph.</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.triangleCount(label:String, relationship:String,
{concurrency:4, write:true, writeProperty:'triangles', clusteringCoefficientProperty:'coefficient'})
YIELD loadMillis, computeMillis, writeMillis, nodeCount, triangleCount, averageClusteringCoefficient</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 37. Parameters</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">optional</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">label</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">label to load from the graph. If null load all nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship-type to load from the graph. If null load all relationships</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">concurrency</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">available CPUs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of concurrent threads</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">write</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if result should be written back as node property</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">writeProperty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'triangles'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">property name the number of triangles a node is member of is written to</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">clusteringCoefficientProperty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'coefficient'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">property name clustering coefficient of the node is written to</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 38. Results</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nodeCount</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of nodes considered</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">loadMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for loading data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">evalMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for running the algorithm</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">writeMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for writing result data back</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">triangleCount</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of triangles in the given graph.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">averageClusteringCoefficient</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">average clustering coefficient of the given graph</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_cypher_projection_6"><a class="link" href="#_cypher_projection_6">Cypher projection</a></h4>
<div class="paragraph">
<p>If label and relationship-type are not selective enough to describe your subgraph to run the algorithm on, you can use Cypher statements to load or project subsets of your graph.
Can be also used to run algorithms on a virtual graph.
Set <code>graph:'cypher'</code> in the config.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.triangleCount(
  'MATCH (p:Person) RETURN id(p) as id',
  'MATCH (p1:Person)-[:KNOWS]-&gt;(p2:Person) RETURN id(p1) as source,id(p2) as target',
  {concurrency:4, write:true, writeProperty:'triangle',graph:'cypher', clusteringCoefficientProperty:'coefficient'})
yield loadMillis, computeMillis, writeMillis, nodeCount, triangleCount, averageClusteringCoefficient</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_versions_7"><a class="link" href="#_versions_7">Versions</a></h4>
<div class="paragraph">
<p>We support the following versions of the triangle count algorithms:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10003; undirected, unweighted</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_references_7"><a class="link" href="#_references_7">References</a></h4>
<div class="ulist">
<ul>
<li>
<p>[1] <a href="https://www.infoq.com/articles/apache-spark-graphx" class="bare">https://www.infoq.com/articles/apache-spark-graphx</a></p>
</li>
<li>
<p>[2] <a href="http://i11www.iti.kit.edu/extra/publications/sw-fclt-05_t.pdf" class="bare">http://i11www.iti.kit.edu/extra/publications/sw-fclt-05_t.pdf</a></p>
</li>
<li>
<p>[3] <a href="http://www.math.cmu.edu/~ctsourak/tsourICDM08.pdf" class="bare">http://www.math.cmu.edu/~ctsourak/tsourICDM08.pdf</a></p>
</li>
<li>
<p>[4] <a href="https://en.wikipedia.org/wiki/Clustering_coefficient" class="bare">https://en.wikipedia.org/wiki/Clustering_coefficient</a></p>
</li>
<li>
<p>[5] <a href="https://pdfs.semanticscholar.org/110b/55a017f52abfedca220036ea129d84b7cadc.pdf" class="bare">https://pdfs.semanticscholar.org/110b/55a017f52abfedca220036ea129d84b7cadc.pdf</a></p>
</li>
<li>
<p>[6] <a href="http://www.pnas.org/content/99/9/5825.full.pdf" class="bare">http://www.pnas.org/content/99/9/5825.full.pdf</a></p>
</li>
<li>
<p>[7] <a href="https://bmcbioinformatics.biomedcentral.com/track/pdf/10.1186/1471-2105-6-270?site=bmcbioinformatics.biomedcentral.com" class="bare">https://bmcbioinformatics.biomedcentral.com/track/pdf/10.1186/1471-2105-6-270?site=bmcbioinformatics.biomedcentral.com</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_community_detection_label_propagation"><a class="link" href="#_community_detection_label_propagation">Community detection: Label Propagation</a></h3>
<div class="paragraph">
<p><em>Label Propagation</em> (LPA) is an algorithm for finding communities in near linear time <a href="http://shodhganga.inflibnet.ac.in/bitstream/10603/36003/4/chapter3.pdf">[1]</a>.
It detects these communities using network structure alone as its guide and requires neither a pre-defined objective function nor prior information about the communities.</p>
</div>
<div class="paragraph">
<p>Community detection is an important methodology for understanding the organization of various real-world networks and has applications in problems as diverse as consensus formation in social communities or the identification of functional modules in biochemical networks.</p>
</div>
<div class="sect3">
<h4 id="_history_explanation_9"><a class="link" href="#_history_explanation_9">History, Explanation</a></h4>
<div class="paragraph">
<p>Many community detection algorithms have been proposed and utilized with varying degrees of effectiveness in community detection research.</p>
</div>
<div class="paragraph">
<p>The idea of label flooding through a network originated from the L-shell method proposed by Bagrow and Bollt. (2005) <a href="https://arxiv.org/pdf/cond-mat/0412482.pdf">[2]</a>
The main idea behind LPA is to propagate the labels of node throughout the network and form communities through the process of label propagation.
The intuition of label flooding is that a single label can quickly become dominant in a densely connected group of nodes whereas it has trouble crossing a sparsely connected region.
Labels will get trapped inside a densely connected group of nodes.
Based on the idea of local trapping of labels, the author proposed a local community detection method where a node is initialized with a label which propagates step by step through the neighbours until the end of the community is reached.</p>
</div>
<div class="paragraph">
<p>LPA, which was first proposed by Raghavan et al. (2007) <a href="https://arxiv.org/pdf/0709.2938.pdf">[3]</a>, uses unique identifiers of nodes as labels and propagates the labels based on an agreement with the majority of the neighbour nodes.</p>
</div>
<div class="paragraph">
<p>The algorithm works as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Every node is initialized with a unique label (an identifier)</p>
</li>
<li>
<p>These labels propagate through the network</p>
</li>
<li>
<p>At every iteration of propagation, each node updates its label to the one that the maximum numbers of its neighbours belongs to. Ties are broken uniformly and randomly.</p>
</li>
<li>
<p>LPA reaches convergence when each node has the majority label of its neighbours.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As labels propagate, densely connected groups of nodes quickly reach a consensus on a unique label.
At the end of the propagation only a few labels will remain - most will have disappeared.
Nodes that have the same label at convergence are said to belong to the same community.</p>
</div>
</div>
<div class="sect3">
<h4 id="_when_to_use_it_use_cases_10"><a class="link" href="#_when_to_use_it_use_cases_10">When to use it / use-cases</a></h4>
<div class="paragraph">
<p>Community structure is considered one of the most interesting features in complex networks.
Many real-world complex systems exhibit community structure, where individuals with similar properties form a community (partition).
The identification of partitions in a network is important for understanding its structure.</p>
</div>
<div class="paragraph">
<p>There are many algorithms that identify community structures in large-scale real-world networks and a lot of them require prior information about the number and size of communities.
In complex networks this size of community is very difficult to calculate.
With social networks, which are often huge and heterogeneous in nature, it is impossible to predict the number of initial communities.</p>
</div>
<div class="paragraph">
<p>Algorithms that are able to detect communities from complex networks without having any knowledge about the number of communities or the size of communities are essential.
LPA is such an algorithm and requires neither a pre-defined objective function nor prior information about the communities.</p>
</div>
</div>
<div class="sect3">
<h4 id="_constraints_when_not_to_use_it_10"><a class="link" href="#_constraints_when_not_to_use_it_10">Constraints / when not to use it</a></h4>
<div class="paragraph">
<p>In contrast with other algorithms label propagation can result in different community structures from the same initial condition.
The range of solutions can be narrowed if some nodes are given preliminary labels while others are held unlabelled.
Consequently, unlabelled nodes will be more likely to adapt to the labelled ones.
For a more accurate finding of communities, Jaccards index is used to aggregate multiple community structures, containing all important information.[3]</p>
</div>
</div>
<div class="sect3">
<h4 id="_algorithm_explanation_on_simple_sample_graph_9"><a class="link" href="#_algorithm_explanation_on_simple_sample_graph_9">Algorithm explanation on simple sample graph</a></h4>
<div class="imageblock">
<div class="content">
<img src="https://github.com/neo4j-contrib/neo4j-graph-algorithms/raw/3.2/doc/img/label_propagation.png" alt="label propagation">
</div>
</div>
<div class="listingblock">
<div class="title">Create sample graph</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CREATE (nAlice:User {id:'Alice',predefined_label:52})
,(nBridget:User {id:'Bridget',predefined_label:21})
,(nCharles:User {id:'Charles',predefined_label:43})
,(nDoug:User {id:'Doug',predefined_label:21})
,(nMark:User {id:'Mark',predefined_label: 19})
,(nMichael:User {id:'Michael', predefined_label: 52})
CREATE (nAlice)-[:FOLLOW]-&gt;(nBridget)
,(nAlice)-[:FOLLOW]-&gt;(nCharles)
,(nMark)-[:FOLLOW]-&gt;(nDoug)
,(nBridget)-[:FOLLOW]-&gt;(nMichael)
,(nDoug)-[:FOLLOW]-&gt;(nMark)
,(nMichael)-[:FOLLOW]-&gt;(nAlice)
,(nAlice)-[:FOLLOW]-&gt;(nMichael)
,(nBridget)-[:FOLLOW]-&gt;(nAlice)
,(nMichael)-[:FOLLOW]-&gt;(nBridget)
,(nCharles)-[:FOLLOW]-&gt;(nDoug);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Running algorithm and writing back results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.labelPropagation('User', 'FOLLOW','OUTGOING',
  {iterations:10,partitionProperty:'partition', write:true})
YIELD nodes, iterations, loadMillis, computeMillis, writeMillis, write, partitionProperty;</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 39. Results</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">partition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Alice</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Charles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bridget</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Michael</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Doug</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mark</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Our algorithm found two communities with 3 members each.</p>
</div>
<div class="sect4">
<h5 id="_using_pre_defined_labels"><a class="link" href="#_using_pre_defined_labels">Using pre-defined labels</a></h5>
<div class="paragraph">
<p><em>At the beginning of the algorithm, every node is initialized with unique label (called as identifier) and the labels propagate through the network.</em></p>
</div>
<div class="paragraph">
<p>It is possible to define preliminary labels (identifiers) of nodes using <code>partition</code> parameter.
We need to save preliminary set of labels we would like to run the LPA algorithm with as a property of nodes (must be a number).
In our example graph we saved them as property <em>predefined_label</em>.
Algorithm first checks if there is a <em>predefined label</em> assigned to the node and loads it, if there is one.
If there isn&#8217;t one it assigns the node new unique label(node id are used).
Using this preliminary set of labels (identifiers) it then sequentially updates each node&#8217;s label to a new one, which is the most frequent label among its neighbors at every label propagation step(iteration).</p>
</div>
<div class="paragraph">
<p>Can be used as semi-supervised way of finding communities, where we hand-pick some initial communities.</p>
</div>
<div class="listingblock">
<div class="title">Running algorithm with pre-defined labels</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.labelPropagation('User', 'FOLLOW','OUTGOING',
  {iterations:10,partitionProperty:'predefined_label', write:true})
YIELD nodes, iterations, loadMillis, computeMillis, writeMillis, write, partitionProperty;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_example_usage_8"><a class="link" href="#_example_usage_8">Example Usage</a></h4>

</div>
<div class="sect3">
<h4 id="_syntax_8"><a class="link" href="#_syntax_8">Syntax</a></h4>
<div class="listingblock">
<div class="title">Running algorithm and writing back results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.labelPropagation(label:String, relationship:String, direction:String, {iterations:1,
weightProperty:'weight', partitionProperty:'partition', write:true, concurrency:4})
YIELD nodes, iterations, didConverge, loadMillis, computeMillis, writeMillis, write, weightProperty,
partitionProperty - simple label propagation kernel</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 40. Parameters</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">optional</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">label</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">label to load from the graph. If null load all nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship-type to load from the graph. If null load all relationships</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">direction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'OUTGOING'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship-direction to use in the algorithm</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">concurrency</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">available CPUs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of concurrent threads</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">iterations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the maximum number of iterations to run</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">weightProperty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'weight'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">property name of node and/or relationship that contain weight. Must be numeric.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">partitionProperty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'partition'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">property name written back the partition of the graph in which the node reside, can be used to define initial set of labels (must be a number)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">write</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if result should be written back as node property</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">graph</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'heavy'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">use 'heavy' when describing the subset of the graph with label and relationship-type parameter, 'cypher' for describing the subset with cypher node-statement and relationship-statement</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 41. Results</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nodes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of nodes considered</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">iterations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of iterations that were executed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">didConverge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true if the algorithm did converge to a stable labelling within the provided number of maximum iterations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">loadMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for loading data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">computeMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for running the algorithm</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">writeMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for writing result data back</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">weightProperty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">property name that contains weight</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">partitionProperty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">property name written back to</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">write</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_cypher_projection_7"><a class="link" href="#_cypher_projection_7">Cypher projection</a></h4>
<div class="paragraph">
<p>If label and relationship-type are not selective enough to describe your subgraph to run the algorithm on, you can use Cypher statements to load or project subsets of your graph.
Can be also used to run algorithms on a virtual graph.
Set <code>graph:'cypher'</code> in the config.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.labelPropagation(
  'MATCH (p:User) RETURN id(p) as id, p.weight as weight, id(p) as value',
  'MATCH (p1:User)-[f:FRIEND]-&gt;(p2:User)
   RETURN id(p1) as source, id(p2) as target, f.weight as weight',
  "OUT",
  {graph:'cypher',write:true});</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_versions_8"><a class="link" href="#_versions_8">Versions</a></h4>
<div class="paragraph">
<p>We support the following versions of the label propagation algorithms:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10003; directed, unweighted:</p>
<div class="ulist">
<ul>
<li>
<p>direction: 'INCOMING' or 'OUTGOING', weightProperty: null</p>
</li>
</ul>
</div>
</li>
<li>
<p>&#10003; directed, weighted</p>
<div class="ulist">
<ul>
<li>
<p>direction: 'INCOMING' or 'OUTGOING', weightProperty : 'weight'</p>
</li>
</ul>
</div>
</li>
<li>
<p>&#10003; undirected, unweighted</p>
<div class="ulist">
<ul>
<li>
<p>direction: 'BOTH', weightProperty: null</p>
</li>
</ul>
</div>
</li>
<li>
<p>&#10003; undirected, weighted</p>
<div class="ulist">
<ul>
<li>
<p>direction: 'BOTH', weightProperty: 'weight'</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_references_8"><a class="link" href="#_references_8">References</a></h4>
<div class="ulist">
<ul>
<li>
<p>[1] <a href="http://shodhganga.inflibnet.ac.in/bitstream/10603/36003/4/chapter3.pdf" target="_blank">Label Propagation in Community Detection</a></p>
</li>
<li>
<p>[2] <a href="https://arxiv.org/pdf/0709.2938.pdf" target="_blank">A Local Method for Detecting Communities</a></p>
</li>
<li>
<p>[3] <a href="https://arxiv.org/abs/cond-mat/0412482" class="bare">https://arxiv.org/abs/cond-mat/0412482</a></p>
</li>
<li>
<p><a href="http://cpb.iphy.ac.cn/fileup/PDF/2014-9-098902.pdf" class="bare">http://cpb.iphy.ac.cn/fileup/PDF/2014-9-098902.pdf</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_community_detection_louvain"><a class="link" href="#_community_detection_louvain">Community detection: Louvain</a></h3>
<div class="paragraph">
<p>The <em>Louvain</em> method of community detection is an algorithm for detecting communities in networks that relies upon a heuristic for maximizing the modularity.
Communities are groups of nodes within a network that are more densely connected to one another than to other nodes.
A typical heuristic would be modularity, which quantifies the quality of an assignment of nodes to communities by evaluating how much more densely connected the nodes within a community are compared to how connected they would be in a random network.</p>
</div>
<div class="paragraph">
<p>The method consists of repeated application of two steps.
The first step is a "greedy" assignment of nodes to communities, favoring local optimizations of modularity.
The second step is the definition of a new coarse-grained network based on the communities found in the first step.
These two steps are repeated until no further modularity-increasing reassignments of communities are possible.</p>
</div>
<div class="paragraph">
<p>The <em>Louvain</em> method achieves modularities comparable to pre-existing algorithms, typically in less time, so it enables the study of much larger networks.
It also reveals a hierarchy of communities at different scales, and this hierarchical perspective can be useful for understanding the global functioning of a network.
While there are pitfalls to interpreting the community structure uncovered by the Louvain Method, these difficulties are shared by all modularity optimization algorithms.[2]</p>
</div>
<div class="paragraph">
<p>Link to the <a href="https://arxiv.org/pdf/0803.0476.pdf">original paper</a>[1]</p>
</div>
<div class="sect3">
<h4 id="_history_explanation_10"><a class="link" href="#_history_explanation_10">History, Explanation</a></h4>
<div class="paragraph">
<p>A fairly common feature of complex networks is that they consist of sets of nodes that interact more with one another than with nodes outside the set.
Social networks, for instance, might consist of tightly knit communities of friends with rarer friendship ties between different communities.
In protein interaction networks, certain groups of proteins interact with one another more frequently than they do with proteins in other groups.
If you map out a network of projects going on in a large company, certain projects will likely have more conceptual overlap and mutual dependency than others.</p>
</div>
<div class="paragraph">
<p>In 1962, H.A. Simon proposed that this type of community structure might be a defining characteristic of complex systems, or at least those like the protein interaction network, in which many interacting constituent elements adaptively organize to achieve some higher-order function (e.g., the functioning of an organism).
His reasoning was that individual actors have a much higher chance of collectively achieving a higher-order function if that function can be iteratively achieved by constructing intermediate stable forms (also called communities or modules) that achieve simpler functions.
The first-order intermediate forms would be communities in terms of the original nodes, but then interactions between these first-order communities could generate second-order communities that accomplish somewhat more complicated functions, and so on.
In this way, a hierarchical structure can emerge in complex adaptive systems.
However, even when there isn&#8217;t necessarily adaptive pressure towards achieving some higher-order function (as in the case of some social networks), community structure is a common observed feature of complex networks.</p>
</div>
<div class="paragraph">
<p>The algorithm is initialized with each node in its own community.</p>
</div>
<div class="paragraph">
<p>In the first stage we iterate through each of the nodes in the network.
For each node, we consider the change in modularity if we remove the node from its current community and place it in the community of one of its neighbors.
We compute the modularity change for each of the node&#8217;s neighbors.
If none of these modularity changes are positive, we keep the node in its current community.
If some of the modularity changes are positive, we move the node into the community where the modularity change is most positive.
Ties are resolved arbitrarily.
We repeat this process for each node until one pass through all nodes yields no community assignment changes.</p>
</div>
<div class="paragraph">
<p>The second stage in the Louvain Method uses the communities that were discovered in the community reassignment stage to define a new coarse-grained network.
In this network the newly discovered communities are the nodes.
The edge weight between the nodes representing two communities is the sum of the edge weights between the constituent, lower-level nodes of each community.
The links within each community generate self-loops in the new, coarse-grained network.</p>
</div>
<div class="paragraph">
<p>The rest of the Louvain Method consists of repeated application of stages 1 and 2.
By applying stage 1 (the community reassignment phase) to the coarse-grained graph, we find a second tier of communities of communities of nodes.
Then, in the next application of stage 2, we define a new coarse-grained graph at this higher-level of the hierarchy.
We keep going like this until an application of stage 1 yields no reassignments.
At that point repeated application of stages 1 and 2 will not yield any more modularity-optimizing changes, so the process is complete.[2]</p>
</div>
</div>
<div class="sect3">
<h4 id="_when_to_use_it_use_cases_11"><a class="link" href="#_when_to_use_it_use_cases_11">When to use it / use-cases</a></h4>
<div class="paragraph">
<p>One of the applications reported in the original Louvain Method paper was a study of a large Belgian phone call network in which nodes represented customers and weighted links represented the number of phone calls between two customers over a six-month period.
The Louvain Method revealed a hierarchy of six levels of communities.
At the top level of this hierarchy, the communities representing more than 10,000 customers were strongly segregated by primary language.
All except one of these communities had an 85% or greater majority of either French or Dutch speakers.
The sole community with a more equitable distribution was positioned at the interface between French and Dutch clusters in the top-level coarse-grained network.</p>
</div>
<div class="paragraph">
<p>Since 2008 the Louvain Method has found a wide range of applications in analyzing real-world networks.
Several of these can be found on <a href="https://perso.uclouvain.be/vincent.blondel/research/louvain.html">the website of the method</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>analysis of online social networks such as Twitter, LinkedIn, Flickr, Youtube, and LiveJournal</p>
</li>
<li>
<p>analysis of collaboration communities in citation networks</p>
</li>
<li>
<p>analysis of a network of retail transactions</p>
</li>
<li>
<p>study of <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2784301/">brain networks</a> using the Louvain Method [4]</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_constraints_when_not_to_use_it_11"><a class="link" href="#_constraints_when_not_to_use_it_11">Constraints / when not to use it</a></h4>
<div class="paragraph">
<p>Although the <em>Louvain</em> Method, and modularity optimization algorithms more generally, have found wide application across many domains, some problems with these algorithms have been identified.</p>
</div>
<div class="paragraph">
<p>The <em>resolution</em> limit:</p>
</div>
<div class="paragraph">
<p>For larger networks the Louvain Method doesn&#8217;t stop with the "intuitive" communities.
Instead there&#8217;s a second pass through the community modification and coarse-graining stages, in which several of the intuitive communities are merged together.
This is a general problem with modularity optimization algorithms - they have trouble detecting small communities in large networks.
It&#8217;s a virtue of the Louvain Method that something close to the intuitive community structure is available as an intermediate step in the process.</p>
</div>
<div class="paragraph">
<p>The <em>degeneracy</em> problem:</p>
</div>
<div class="paragraph">
<p>There are typically an exponentially large (in network size) number of community assignments with modularities close to the maximum.
This can be a severe problem because, in the presence of a large number of high modularity solutions, it&#8217;s hard to find the global maximum and difficult to determine if the global maximum is truly more scientifically important than local maxima that achieve similar modularity.
<a href="https://arxiv.org/abs/0910.0165">Research</a> undertaken at Universite Catholique de Louvain showed that the different locally optimal community assignments can have quite different structural properties.[3]</p>
</div>
</div>
<div class="sect3">
<h4 id="_algorithm_explanation_on_simple_sample_graph_10"><a class="link" href="#_algorithm_explanation_on_simple_sample_graph_10">Algorithm explanation on simple sample graph</a></h4>
<div class="imageblock">
<div class="content">
<img src="https://github.com/neo4j-contrib/neo4j-graph-algorithms/raw/3.2/doc/img/louvain.png" alt="louvain">
</div>
</div>
<div class="listingblock">
<div class="title">Create sample graph</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CREATE (nAlice:User {id:'Alice'})
,(nBridget:User {id:'Bridget'})
,(nCharles:User {id:'Charles'})
,(nDoug:User {id:'Doug'})
,(nMark:User {id:'Mark'})
,(nMichael:User {id:'Michael'})
CREATE (nAlice)-[:FRIEND]-&gt;(nBridget)
,(nAlice)-[:FRIEND]-&gt;(nCharles)
,(nMark)-[:FRIEND]-&gt;(nDoug)
,(nBridget)-[:FRIEND]-&gt;(nMichael)
,(nCharles)-[:FRIEND]-&gt;(nMark)
,(nAlice)-[:FRIEND]-&gt;(nMichael)
,(nCharles)-[:FRIEND]-&gt;(nDoug);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Running algorithm and streaming results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.louvain.stream('User', 'FRIEND', {})
YIELD nodeId, community
RETURN nodeId, community LIMIT 20;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Running algorithm and writing back results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.louvain('User', 'FRIEND',
  {write:true, writeProperty:'community'})
YIELD nodes, communityCount, iterations, loadMillis, computeMillis, writeMillis;</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 42. Results</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">community</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Alice</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bridget</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Michael</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Charles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Doug</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mark</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_example_usage_9"><a class="link" href="#_example_usage_9">Example Usage</a></h4>

</div>
<div class="sect3">
<h4 id="_syntax_9"><a class="link" href="#_syntax_9">Syntax</a></h4>
<div class="listingblock">
<div class="title">Running algorithm and writing back results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.louvain(label:String, relationship:String,
  {weightProperty:'weight', defaultValue:1.0, write: true,
   writeProperty:'community', concurrency:4})
YIELD nodes, communityCount, iterations, loadMillis, computeMillis, writeMillis</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 43. Parameters</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">optional</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">label</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">label to load from the graph. If null load all nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship-type to load from the graph. If null load all relationships</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">weightProperty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">property name that contains weight. If null treats the graph as unweighted. Must be numeric.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">write</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if result should be written back as node property</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">writeProperty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'community'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">property name written back the id of the community particular node belongs to</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">defaultValue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">default value of the weight in case it is missing or invalid</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">concurrency</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">available CPUs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of concurrent threads</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">graph</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'heavy'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">use 'heavy' when describing the subset of the graph with label and relationship-type parameter, 'cypher' for describing the subset with cypher node-statement and relationship-statement</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 44. Results</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nodes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of nodes considered</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">communityCount</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of communities found</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">iterations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of iterations run</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">loadMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for loading data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">computeMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for running the algorithm</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">writeMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for writing result data back</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Running algorithm and streaming results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.louvain.stream(label:String, relationship:String,
  {weightProperty:'propertyName', defaultValue:1.0, concurrency:4})
YIELD nodeId, community - yields a community to each node id</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 45. Parameters</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">optional</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">label</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">label to load from the graph. If null load all nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship-type to load from the graph. If null load all relationships</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">weightProperty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">property name that contains weight. If null treats the graph as unweighted. Must be numeric.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">defaultValue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">default value of the weight if it is missing or invalid</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">graph</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'heavy'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">use 'heavy' when describing the subset of the graph with label and relationship-type parameter, 'cypher' for describing the subset with cypher node-statement and relationship-statement</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 46. Results</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nodeId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">node id</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">community</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">community id</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_cypher_projection_8"><a class="link" href="#_cypher_projection_8">Cypher projection</a></h4>
<div class="paragraph">
<p>If label and relationship-type are not selective enough to describe your subgraph to run the algorithm on, you can use Cypher statements to load or project subsets of your graph.
Can be also used to run algorithms on a virtual graph.
Set <code>graph:'cypher'</code> in the config.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.louvain(
  'MATCH (p:User) RETURN id(p) as id',
  'MATCH (p1:User)-[f:FRIEND]-(p2:User)
   RETURN id(p1) as source, id(p2) as target, f.weight as weight',
  {graph:'cypher',write:true});</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_versions_9"><a class="link" href="#_versions_9">Versions</a></h4>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10003; undirected, unweighted</p>
<div class="ulist">
<ul>
<li>
<p>weightProperty: null</p>
</li>
</ul>
</div>
</li>
<li>
<p>&#10003; undirected, weighted</p>
<div class="ulist">
<ul>
<li>
<p>weightProperty : 'weight'</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_references_9"><a class="link" href="#_references_9">References</a></h4>
<div class="ulist">
<ul>
<li>
<p>[1] <a href="https://arxiv.org/pdf/0803.0476.pdf" class="bare">https://arxiv.org/pdf/0803.0476.pdf</a></p>
</li>
<li>
<p>[2] <a href="https://www.quora.com/Is-there-a-simple-explanation-of-the-Louvain-Method-of-community-detection" class="bare">https://www.quora.com/Is-there-a-simple-explanation-of-the-Louvain-Method-of-community-detection</a></p>
</li>
<li>
<p>[3] <a href="https://arxiv.org/abs/0910.0165" class="bare">https://arxiv.org/abs/0910.0165</a></p>
</li>
<li>
<p>[4] <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2784301/" class="bare">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2784301/</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_community_detection_connected_components"><a class="link" href="#_community_detection_connected_components">Community detection: Connected Components</a></h3>
<div class="paragraph">
<p><em>Connected Components</em> or <em>UnionFind</em> basically finds sets of connected nodes where each node is reachable from any other node in the same set.
In graph theory, a connected component of an undirected graph is a subgraph in which any two vertices are connected to each other by paths, and which is connected to no additional vertices in the graph.</p>
</div>
<div class="sect3">
<h4 id="_history_explanation_11"><a class="link" href="#_history_explanation_11">History, Explanation</a></h4>
<div class="paragraph">
<p>The <em>Connected Components</em> of a graph represent, in general terms, the pieces of the graph.
Two vertices are in the same component of graph if and only if there is some path between them.</p>
</div>
<div class="paragraph">
<p>Finding connected components is at the heart of many graph applications.
For example, consider the problem of identifying partitions in a set of items.
We can represent each item by a node and add an edge between each pair of items that are deemed similar.
The connected components of this graph correspond to different classes of items.</p>
</div>
</div>
<div class="sect3">
<h4 id="_when_to_use_it_use_cases_12"><a class="link" href="#_when_to_use_it_use_cases_12">When to use it / use-cases</a></h4>
<div class="paragraph">
<p>Testing whether a graph is connected is an essential preprocessing step for every graph algorithm.
Such tests can be performed so quickly and easily that you should always verify that your input graph is connected, even when you know it has to be.
Subtle, difficult-to-detect bugs often result when your algorithm is run only on one component of a disconnected graph.</p>
</div>
<div class="paragraph">
<p>Connected components have other practical use cases, for example, if we are analysing a social network and we want to find all the disconnected groups of people that exist in our graph.</p>
</div>
</div>
<div class="sect3">
<h4 id="_constraints_when_not_to_use_it_12"><a class="link" href="#_constraints_when_not_to_use_it_12">Constraints / when not to use it</a></h4>

</div>
<div class="sect3">
<h4 id="_algorithm_explanation_on_simple_sample_graph_11"><a class="link" href="#_algorithm_explanation_on_simple_sample_graph_11">Algorithm explanation on simple sample graph</a></h4>
<div class="paragraph">
<p>Recall that an undirected graph is connected if for every pair of vertices, there is a path in the graph between those vertices.
A connected component of an undirected graph is a maximal connected subgraph of the graph.
That means that the direction of the relationships in our graph have no influence as we treat our graph as undirected.
We have two implementations of connected components algorithm.
First implementations treats the graph as unweighted and the second version is weighted, where you can define the threshold of the weight above which relationships are created.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://github.com/neo4j-contrib/neo4j-graph-algorithms/raw/3.2/doc/img/connected_components.png" alt="connected components">
</div>
</div>
<div class="listingblock">
<div class="title">Create sample graph</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CREATE (nAlice:User {id:'Alice'})
,(nBridget:User {id:'Bridget'})
,(nCharles:User {id:'Charles'})
,(nDoug:User {id:'Doug'})
,(nMark:User {id:'Mark'})
,(nMichael:User {id:'Michael'})
CREATE (nAlice)-[:FRIEND{weight:0.5}]-&gt;(nBridget)
,(nAlice)-[:FRIEND{weight:4}]-&gt;(nCharles)
,(nMark)-[:FRIEND{weight:1}]-&gt;(nDoug)
,(nMark)-[:FRIEND{weight:2}]-&gt;(nMichael);</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_unweighted_version"><a class="link" href="#_unweighted_version">Unweighted version:</a></h5>
<div class="listingblock">
<div class="title">Running algorithm and streaming results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.unionFind.stream('User', 'FRIEND', {})
YIELD nodeId,setId
RETURN nodeId,setId LIMIT 20;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Running algorithm and writing back results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.unionFind('User', 'FRIEND', {write:true, partitionProperty:"partition"})
YIELD nodes, setCount, loadMillis, computeMillis, writeMillis;</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 47. Results</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">partition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Alice</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Charles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bridget</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Michael</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Doug</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mark</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Results show us, that we have two distinct group of users that have no link between them. First group has members Alice,Charles,Bridget and the second group are Michael,Doug,Mark.</p>
</div>
<div class="listingblock">
<div class="title">We can also easily check the number and size of partitions using cypher.</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">MATCH (u:User)
RETURN u.partition as partition,count(*) as size_of_partition
ORDER by size_of_partition DESC LIMIT 20;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_weighted_version"><a class="link" href="#_weighted_version">Weighted version:</a></h5>
<div class="paragraph">
<p>If you define the property that holds the weight(weightProperty) and the threshold,it means the nodes are only connected, if the threshold on the weight of the relationship is high enough otherwise the relationship is thrown away.</p>
</div>
<div class="listingblock">
<div class="title">Running algorithm and streaming results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.unionFind.stream('User', 'FRIEND', {weightProperty:'weight', defaultValue:0.0, threshold:1.0})
YIELD nodeId,setId;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Running algorithm and writing back results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.unionFind('User', 'FRIEND', {write:true, partitionProperty:"partition",weightProperty:'weight', defaultValue:0.0, threshold:1.0})
YIELD nodes, setCount, loadMillis, computeMillis, writeMillis;</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 48. Results</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">partition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Alice</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Charles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bridget</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Michael</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Doug</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mark</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>We can observe, that because the weight of the relationship betwen Bridget and Alice is only 0.5, the relationship was thrown away and regarded as not existing.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_example_usage_10"><a class="link" href="#_example_usage_10">Example Usage</a></h4>
<div class="paragraph">
<p>As said Connected Components are an essential step in preprocessing your data.
One reason is that most centralities suffer from disconnected components or you just want to find disconnected groups of nodes.
Yelp&#8217;s social network will be used to demonstrate how to proceed when dealing with real world data.
A typical social network consist of one big component and a number of small disconnected components.</p>
</div>
<div class="listingblock">
<div class="title">Get the count of connected components</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.unionFind.stream('User', 'FRIEND', {})
YIELD nodeId,setId
RETURN count(distinct setId) as count_of_components;</code></pre>
</div>
</div>
<div class="paragraph">
<p>We get back count of disconnected components being 18512 if we do not count users without friends.
Let&#8217;s now check the size of top 20 components to get a better picture</p>
</div>
<div class="listingblock">
<div class="title">Get the size of top 20 components</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.unionFind.stream('User', 'FRIEND', {})
YIELD nodeId,setId
RETURN setId,count(*) as size_of_component
ORDER BY size_of_component LIMIT 20;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The biggest component has 8938630 out of total 8981389 (99,5%).
It is quite high, but not shocking as we have a friendship social network, where we can expect small world effect and 6 degree of separation rule, where you can get to any person in a social network, just depends how long is the path.</p>
</div>
<div class="paragraph">
<p>We can now move on to next step of analysis and run centralities only on the biggest components, so that our results will be more accurate.
We just simply write back the results to the node, and use centralities with cypher loading or set a new label for the biggest component.</p>
</div>
</div>
<div class="sect3">
<h4 id="_syntax_10"><a class="link" href="#_syntax_10">Syntax</a></h4>
<div class="listingblock">
<div class="title">Running algorithm and writing back results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.unionFind(label:String, relationship:String, {threshold:0.42,
defaultValue:1.0, write: true, partitionProperty:'partition',weightProperty:'weight',graph:'heavy',concurrency:4})
YIELD nodes, setCount, loadMillis, computeMillis, writeMillis
- finds connected partitions and potentially writes back to the node as a property partition.</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 49. Parameters</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">optional</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">label</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">label to load from the graph. If null load all nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship-type to load from the graph. If null load all relationships</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">weightProperty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">property name that contains weight, if null treats the graph as unweighted. Must be numeric.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">write</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if result should be written back as node property</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">partitionProperty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'partition'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">property name written back the id of the partition particular node belongs to</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">threshold</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value of the weight above which the relationship is not thrown away</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">defaultValue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">default value of the weight in case it is missing or invalid</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">concurrency</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">available CPUs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of concurrent threads</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">graph</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'heavy'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">use 'heavy' when describing the subset of the graph with label and relationship-type parameter, 'cypher' for describing the subset with cypher node-statement and relationship-statement</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 50. Results</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nodes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of nodes considered</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">setCount</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of partitions found</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">loadMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for loading data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">computeMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for running the algorithm</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">writeMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for writing result data back</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Running algorithm and streaming results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.unionFind.stream(label:String, relationship:String, {weightProperty:'weight', threshold:0.42, defaultValue:1.0, concurrency:4})
YIELD nodeId, setId - yields a setId to each node id</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 51. Parameters</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">optional</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">label</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">label to load from the graph, if null load all nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship-type to load from the graph, if null load all relationships</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">concurrency</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">available CPUs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of concurrent threads</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">weightProperty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">property name that contains weight, if null treats the graph as unweighted. Must be numeric.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">threshold</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value of the weight above which the relationship is not thrown away</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">defaultValue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">default value of the weight in case it is missing or invalid</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">graph</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'heavy'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">use 'heavy' when describing the subset of the graph with label and relationship-type parameter, 'cypher' for describing the subset with cypher node-statement and relationship-statement</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 52. Results</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nodeId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">node id</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">setId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">partition id</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_cypher_projection_9"><a class="link" href="#_cypher_projection_9">Cypher projection</a></h4>
<div class="paragraph">
<p>If label and relationship-type are not selective enough to describe your subgraph to run the algorithm on, you can use Cypher statements to load or project subsets of your graph.
Can be also used to run algorithms on a virtual graph.
Set <code>graph:'cypher'</code> in the config.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.unionFind(
  'MATCH (p:User) RETURN id(p) as id',
  'MATCH (p1:User)-[f:FRIEND]-&gt;(p2:User)
   RETURN id(p1) as source, id(p2) as target, f.weight as weight',
  {graph:'cypher',write:true}
);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_implementations_4"><a class="link" href="#_implementations_4">Implementations</a></h4>
<div class="paragraph">
<p><code>algo.unionFind</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>if a threshold configuration parameter is supplied only relationships with a property value higher then the threshold
are merged</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>algo.unionFind.queue</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>parallel UnionFind using ExecutorService only.</p>
</li>
<li>
<p>Algorithm based on the idea that DisjointSetStruct can be built using just a partition of the nodes
which are then merged pairwise.</p>
</li>
<li>
<p>The implementation is based on a queue which acts as a buffer for each computed DSS. As long as there are
more elements on the queue the algorithm takes two, merges them and adds its result to the queue until only
1 element remains.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>algo.unionFind.forkJoinMerge</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Like in <strong>exp1</strong> the resulting DSS of each node-partition is merged by the ForkJoin pool while
the calculation of the DSS is done by the ExecutorService.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>algo.unionFind.forkJoin</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>calculation and merge using forkJoinPool</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>algo.unionFind.mscoloring</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>coloring based parallel algorithm</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_references_10"><a class="link" href="#_references_10">References</a></h4>
<div class="ulist">
<ul>
<li>
<p><a href="http://math.hws.edu/eck/cs327_s04/chapter9.pdf" class="bare">http://math.hws.edu/eck/cs327_s04/chapter9.pdf</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Connected_component_(graph_theory" class="bare">https://en.wikipedia.org/wiki/Connected_component_(graph_theory</a>)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_community_detection_strongly_connected_components"><a class="link" href="#_community_detection_strongly_connected_components">Community detection: Strongly Connected Components</a></h3>
<div class="paragraph">
<p><em>SCC</em> is a class algorithms for finding groups of nodes where each node is directly reachable from every other node in the group.
The strongly connected components  of an arbitrary directed graph form a partition into subgraphs that are themselves strongly connected.There are several algorithms to compute the SCC.</p>
</div>
<div class="sect3">
<h4 id="_history_explanation_12"><a class="link" href="#_history_explanation_12">History, Explanation</a></h4>
<div class="paragraph">
<p>Decomposing a directed graph into its strongly connected components is a classic application of depth-first search.
The problem of finding connected components is at the heart of many graph application.
Generally speaking, the connected components of the graph correspond to different classes of objects.
The first linear-time algorithm for strongly connected components is due to Tarjan (1972).</p>
</div>
</div>
<div class="sect3">
<h4 id="_when_to_use_it_use_cases_13"><a class="link" href="#_when_to_use_it_use_cases_13">When to use it / use-cases</a></h4>
<div class="paragraph">
<p><em>SCC</em> algorithms can be used as a first step in many graph algorithms that work only on strongly connected graph.
In social networks, a group of people are generally strongly connected (For example, students of a class or any other common place).
Many people in these groups generally like some common pages or play common games.
The SCC algorithms can be used to find such groups and suggest the commonly liked pages or games to the people in the group who have not yet liked commonly liked a page or played a game.</p>
</div>
</div>
<div class="sect3">
<h4 id="_constraints_when_not_to_use_it_13"><a class="link" href="#_constraints_when_not_to_use_it_13">Constraints / when not to use it</a></h4>

</div>
<div class="sect3">
<h4 id="_algorithm_explanation_on_simple_sample_graph_12"><a class="link" href="#_algorithm_explanation_on_simple_sample_graph_12">Algorithm explanation on simple sample graph</a></h4>
<div class="imageblock">
<div class="content">
<img src="https://github.com/neo4j-contrib/neo4j-graph-algorithms/raw/3.2/doc/img/strongly_connected_components.png" alt="strongly connected components">
</div>
</div>
<div class="paragraph">
<p>A directed graph is strongly connected if there is a path between all pairs of vertices.
This algorithms treats the graph as directed, so the direction of the relationship is important and strongly connected compoment exists only if there are relationships between nodes in both direction.</p>
</div>
<div class="listingblock">
<div class="title">Create sample graph</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CREATE (nAlice:User {id:'Alice'})
,(nBridget:User {id:'Bridget'})
,(nCharles:User {id:'Charles'})
,(nDoug:User {id:'Doug'})
,(nMark:User {id:'Mark'})
,(nMichael:User {id:'Michael'})
CREATE (nAlice)-[:FOLLOW]-&gt;(nBridget)
,(nAlice)-[:FOLLOW]-&gt;(nCharles)
,(nMark)-[:FOLLOW]-&gt;(nDoug)
,(nMark)-[:FOLLOW]-&gt;(nMichael)
,(nBridget)-[:FOLLOW]-&gt;(nMichael)
,(nDoug)-[:FOLLOW]-&gt;(nMark)
,(nMichael)-[:FOLLOW]-&gt;(nAlice)
,(nAlice)-[:FOLLOW]-&gt;(nMichael)
,(nBridget)-[:FOLLOW]-&gt;(nAlice)
,(nMichael)-[:FOLLOW]-&gt;(nBridget);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Running algorithm and writing back results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.scc('User','FOLLOW', {write:true,partitionProperty:'partition'})
YIELD loadMillis, computeMillis, writeMillis, setCount, maxSetSize, minSetSize;</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 53. Results</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">partition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Alice</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bridget</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Michael</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Charles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Doug</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mark</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>We can see that we have 2 strongly connected components in our sample graph. The first and biggest component has members Alice,Bridget,Michael and the second component has Doug and Mark.</p>
</div>
<div class="listingblock">
<div class="title">Find the largest partition</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">MATCH (u:User)
RETURN u.partition as partition,count(*) as size_of_partition ORDER by size_of_partition DESC LIMIT 1</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_example_usage_11"><a class="link" href="#_example_usage_11">Example Usage</a></h4>

</div>
<div class="sect3">
<h4 id="_syntax_11"><a class="link" href="#_syntax_11">Syntax</a></h4>
<div class="listingblock">
<div class="title">Running algorithm and writing back results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.scc(label:String, relationship:String,
{write:true,partitionProperty:'partition',concurrency:4, graph:'heavy'})
YIELD loadMillis, computeMillis, writeMillis, setCount, maxSetSize, minSetSize

- finds strongly connected partitions and potentially writes back to the node as a property partition.</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 54. Parameters</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">optional</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">label</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">label to load from the graph. If null load all nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship-type to load from the graph. If null load all relationships</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">write</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if result should be written back as node property</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">partitionProperty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'partition'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">property name written back to</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">concurrency</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">available CPUs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of concurrent threads</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">graph</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'heavy'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">use 'heavy' when describing the subset of the graph with label and relationship-type parameter, 'cypher' for describing the subset with cypher node-statement and relationship-statement</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 55. Results</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">setCount</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of partitions found</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">maxSetSize</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of members in biggest partition</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">minSetSize</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of members in smallest partition</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">loadMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for loading data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">computeMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for running the algorithm</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">writeMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">milliseconds for writing result data back</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Running algorithm and streaming results</div>
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.scc.stream(label:String, relationship:String, {concurrency:4})
YIELD nodeId, partition - yields a partition to each node id</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 56. Parameters</caption>
<colgroup>
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">optional</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">label</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">label to load from the graph, if null load all nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relationship-type to load from the graph, if null load all relationships</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">concurrency</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">available CPUs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of concurrent threads</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">graph</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'heavy'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">use 'heavy' when describing the subset of the graph with label and relationship-type parameter, 'cypher' for describing the subset with cypher node-statement and relationship-statement</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 57. Results</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nodeId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">node id</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">partition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">partition id</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_cypher_projection_10"><a class="link" href="#_cypher_projection_10">Cypher projection</a></h4>
<div class="paragraph">
<p>If label and relationship-type are not selective enough to describe your subgraph to run the algorithm on, you can use Cypher statements to load or project subsets of your graph.
Can be also used to run algorithms on a virtual graph.
Set <code>graph:'cypher'</code> in the config.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL algo.scc(
  'MATCH (u:User) RETURN id(u) as id',
  'MATCH (u1:User)-[:FOLLOW]-&gt;(u2:User) RETURN id(u1) as source,id(u2) as target',
  {write:true,graph:'cypher'})
YIELD loadMillis, computeMillis, writeMillis;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_implementations_5"><a class="link" href="#_implementations_5">Implementations</a></h4>
<div class="paragraph">
<p><code>algo.scc</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>iterative</strong> adaptation (same as <code>algo.scc.iterative</code>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>algo.scc.recursive.tarjan</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>original <strong>recursive</strong> tarjan implementation</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>algo.scc.recursive.tunedTarjan</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>also a <strong>recursive</strong> tarjan implementation</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>algo.scc.iterative</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>iterative</strong> adaption of tarjan algorithm</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>algo.scc.multistep</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>parallel scc algorithm</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_references_11"><a class="link" href="#_references_11">References</a></h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://pdfs.semanticscholar.org/61db/6892a92d1d5bdc83e52cc18041613cf895fa.pdf" class="bare">https://pdfs.semanticscholar.org/61db/6892a92d1d5bdc83e52cc18041613cf895fa.pdf</a></p>
</li>
<li>
<p><a href="http://code.activestate.com/recipes/578507-strongly-connected-components-of-a-directed-graph/" class="bare">http://code.activestate.com/recipes/578507-strongly-connected-components-of-a-directed-graph/</a></p>
</li>
<li>
<p><a href="http://www.sandia.gov/~srajama/publications/BFS_and_Coloring.pdf" class="bare">http://www.sandia.gov/~srajama/publications/BFS_and_Coloring.pdf</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementers_section"><a class="link" href="#_implementers_section">Implementers Section</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_algorithm_procedures_api_discussion"><a class="link" href="#_algorithm_procedures_api_discussion">Algorithm Procedures API Discussion</a></h3>
<div class="paragraph">
<p>We would like to discuss design of the procedure API for algorithms.
There are several concerns:</p>
</div>
<div class="sect3">
<h4 id="_naming"><a class="link" href="#_naming">Naming</a></h4>
<div class="ulist">
<ul>
<li>
<p>simple procedure names,</p>
</li>
<li>
<p>consistent spelling and casing</p>
</li>
<li>
<p>discriminate between write-back and result-streaming procedure with <code>.stream</code> suffix</p>
</li>
<li>
<p>default algorithm name should be the best implementation</p>
</li>
<li>
<p>other implementations can provided via suffixes</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_input_graph_data"><a class="link" href="#_input_graph_data">Input Graph Data</a></h4>
<div class="ulist">
<ul>
<li>
<p>load via label/rel-type selection and optional weight/values</p>
</li>
<li>
<p>load via cypher statements</p>
</li>
<li>
<p>the requirements for node-id&#8217;s, degrees, weights, relationships etc. comes from the algorithm</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_algorithm_parameters"><a class="link" href="#_algorithm_parameters">Algorithm parameters</a></h4>
<div class="ulist">
<ul>
<li>
<p>start-nodes</p>
</li>
<li>
<p>iterations, dampening</p>
</li>
<li>
<p>concurrency, batch-sizes</p>
</li>
<li>
<p>thresholds</p>
</li>
<li>
<p>write-back, write-back properties</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_id_mapping"><a class="link" href="#_id_mapping">Id-Mapping</a></h4>
<div class="ulist">
<ul>
<li>
<p>original node-ids from the graph are mapped to a consecutive id-range to be used for the algorithm</p>
</li>
<li>
<p>this allows simple array offsets to be used within the computation</p>
</li>
<li>
<p>this also allows mapping of larger id-ranges to the computational range of the algorithm ()</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_result_parameters"><a class="link" href="#_result_parameters">Result parameters</a></h4>
<div class="ulist">
<ul>
<li>
<p>output statistics: number of nodes and rels touched</p>
</li>
<li>
<p>time for loading, processing, and writing</p>
</li>
<li>
<p>property written to</p>
</li>
<li>
<p>errors</p>
</li>
<li>
<p>data summary, e.g.</p>
<div class="ulist">
<ul>
<li>
<p>min,max,avg of a centrality, rank or weight measure</p>
</li>
<li>
<p>output of all clusters, their sizes and perhaps the root node</p>
</li>
</ul>
</div>
</li>
<li>
<p>alternatively streaming back node-ids and the computed value (score)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_constraints"><a class="link" href="#_constraints">Constraints:</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>there is no overloading so we need differing names</p>
</li>
<li>
<p>there are default procedure parameters so we need to require only what&#8217;s really required to run</p>
</li>
<li>
<p>we should use sensible defaults</p>
</li>
<li>
<p>result values/columns have to be pre-declared, there is no inheritance or generics</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_suggestions"><a class="link" href="#_suggestions">Suggestions:</a></h4>
<div class="sect4">
<h5 id="_naming_2_variants_per_algorithm"><a class="link" href="#_naming_2_variants_per_algorithm">Naming: 2 variants per algorithm</a></h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>returning summary statistics after run: <code>algo.pageRank(&#8230;&#8203;)</code></p>
</li>
<li>
<p>returning a stream of data: <code>algo.pageRank.stream(&#8230;&#8203;)</code>
default should be the one with statistics, as the scroll back from a medium size / large grap will kill the client</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_parameters"><a class="link" href="#_parameters">Parameters</a></h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>node-selector or null - label(s) or cypher statement: ":Person|User" / "MATCH (u:User) RETURN id(u) as id, u.name as value"</p>
</li>
<li>
<p>relationship-selector or null - rel-type(s) or cypher statement ":KNOWS|FRIEND" / "MATCH (u1:User)-[r:KNOWS|FRIEND]-(u2:User) RETURN id(u1) as source, id(u2) as target, r.strength as weight"</p>
</li>
<li>
<p>configuration map with optinal parameters but sensible defaults: {iterations: 5, write:true, nodeValue:"value",nodeWeight:"weight",relationshipWeight:"weight", threshold: 0.85}</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>We could have the configuration map come from a function (per algorithm?) that handles validation and returns a correct map object for that algorithm? Or just pass the plain map?</p>
</div>
</div>
<div class="sect4">
<h5 id="_example"><a class="link" href="#_example">Example:</a></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">call algo.pageRank("Person","KNOWS",{iterations:10, write:true, [property:"pagerank"]});

call algo.unionFind.stream('
MATCH (p:Person) RETURN id(p) as id
','
MATCH (p1:Person)-[:KNOWS]-(p2:Person) RETURN id(p1) as source, id(p2) as target
', {}) YIELD nodeId, clusterId</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_api_documentation"><a class="link" href="#_api_documentation">API Documentation</a></h3>
<div class="sect3">
<h4 id="_development_notes"><a class="link" href="#_development_notes">Development Notes</a></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
When implementing a procedure that yields any results (is not <code>void</code>) and writes back to the database, make sure to consume the <code>Result</code> after running the algorithm call!
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Algorithms are executed within a transaction, that is opened and closed by Cypher.
The transaction is only marked successful if the results are consumed.
Closing the Result directly will fail and rollback any open transactions and thus will revert all write-back operations.</p>
</div>
</div>
<div class="sect3">
<h4 id="_the_model"><a class="link" href="#_the_model">The Model</a></h4>
<div class="paragraph">
<p>The basic idea behind our model is to have a fast cache for the topology of the graph containing only relevant nodes, relations and in addition the weights.
It implicitly maps (long) node-id&#8217;s to an internal integer-id (32bit) in ascending order which ensures that no id gets bigger
then the maximum node count.
This approach allows us to use primitive arrays as container for example.</p>
</div>
<div class="sect4">
<h5 id="_graph_interface"><a class="link" href="#_graph_interface">Graph Interface</a></h5>
<div class="paragraph">
<p>The <code>Graph</code> interface specifies methods for iterating over all nodes of the graph as well as iterating over relationships of a given node in the form of <code>forEach&#8230;&#8203;(..)</code>-methods.
The Graph knows the <code>nodeCount</code> and <code>degree</code> of each node and can map nodeId to internalId and vice versa.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Collection&lt;PrimitiveIntIterable&gt; batchIterables(int batchSize);</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">return a collection of iterables over every node, partitioned by the given batch size.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean contains(long nodeId);</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true iff the nodeId is mapped, otherwise false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int degree(int nodeId, Direction direction);</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">degree of the node in that direction</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>void forEachNode(IntPredicate consumer);</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Iterate over each nodeId</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>void forEachRelationship(int nodeId, Direction direction, RelationshipConsumer consumer);</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Iterate over all relationships of a node</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>void forEachRelationship(int nodeId, Direction direction, WeightedRelationshipConsumer consumer);</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Iterate over all weighted relationships of a node</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int nodeCount();</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">count of nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PrimitiveIntIterator nodeIterator();</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">iterate over all nodes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int toMappedNodeId(long nodeId);</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map neo4j nodeId to internal nodeId</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>long toOriginalNodeId(int nodeId);</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map internal nodeId back to original nodeId</p></td>
</tr>
</tbody>
</table>
<div class="imageblock">
<div class="content">
<img src="images/diag-c7aa032e8c661d5a6bd35bc00da9209f.png" alt="diag c7aa032e8c661d5a6bd35bc00da9209f" width="710" height="294">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Currently we have 3 different implementations aiming for different goals like performance, memory consumption and accuracy.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>HeavyGraph</code></p>
</div>
<div class="paragraph">
<p>This implementations utilizes an int-matrix for storing connections between vertices.
It has a higher memory consumption but performs basic calculations on the graph around 3 times faster then the memory efficient implementation.
Furthermore the number of edges per node is limited only to the maximum array size (2bn) of the JVM.
Relationships can be added in arbitrary order.</p>
</div>
<div class="paragraph">
<p><code>LightGraph</code></p>
</div>
<div class="paragraph">
<p>This implementation takes 3 times less heap due to a more intelligent memory layout.
The drawback is slightly higher evaluation time and that the data cannot be loaded in parallel (yet).</p>
</div>
<div class="paragraph">
<p><code>GraphView</code></p>
</div>
<div class="paragraph">
<p>The View is just a simple wrapper around the Neo4j Kernel API.
It has been implemented for tests and benchmarks baselines.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_import_2"><a class="link" href="#_import_2">Import</a></h4>
<div class="paragraph">
<p>A fair amount of the work is to fetch the relevant data from Neo4j and import it into our model.
Fortunately we can use a multithreading approach to load the graph.
This is part of the current implementation.</p>
</div>
<div class="paragraph">
<p>The abstract <code>GraphFactory</code> specifies a constructor and the <code>build</code> method.
It is responsible for creating the Graph using the Neo4j Kernel API.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/diag-9851458f6bf1935b4418f88d5cce6713.png" alt="diag 9851458f6bf1935b4418f88d5cce6713" width="800" height="238">
</div>
</div>
<div class="paragraph">
<p>Loading the Graph is done by using the GraphLoader which implements a simple fluent Builder Pattern.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final Graph graph = new GraphLoader( graphDatabaseAPI )
        .setLabel( .. )
        .setRelation( .. )
        .setProperty( .. )
        .setThreadPool( .. )
        .load( FactoryImpl.class );</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_pagerank"><a class="link" href="#_pagerank">PageRank</a></h3>
<div class="sect3">
<h4 id="_implementation_details"><a class="link" href="#_implementation_details">Implementation Details</a></h4>
<div class="paragraph">
<p><em>PageRank</em> is Googles popular search algorithm.</p>
</div>
<div class="paragraph">
<p>More: <a href="https://en.wikipedia.org/wiki/PageRank" class="bare">https://en.wikipedia.org/wiki/PageRank</a></p>
</div>
<div class="sect4">
<h5 id="_progress"><a class="link" href="#_progress">Progress</a></h5>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10003; single threaded implementation</p>
</li>
<li>
<p>&#10003; tests</p>
</li>
<li>
<p>&#10003; simple benchmark</p>
</li>
<li>
<p>&#10003; implement procedure</p>
</li>
<li>
<p>&#10003; benchmark on bigger graphs</p>
</li>
<li>
<p>&#10003; parallelization</p>
</li>
<li>
<p>&#10003; evaluation</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_requirements"><a class="link" href="#_requirements">Requirements</a></h5>
<div class="ulist">
<ul>
<li>
<p>NodeIterator</p>
</li>
<li>
<p>Incoming Relationships</p>
</li>
<li>
<p>Outgoing Degrees</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_data_structured_involved"><a class="link" href="#_data_structured_involved">Data structured involved</a></h5>
<div class="paragraph">
<p>Our current approach needs one double array for storing ranks.</p>
</div>
</div>
<div class="sect4">
<h5 id="_todo"><a class="link" href="#_todo">ToDo</a></h5>
<div class="sect5">
<h6 id="_parallelization"><a class="link" href="#_parallelization">parallelization</a></h6>
<div class="paragraph">
<p>One approach to parallelize <em>PageRank</em> might be to partition the node into batches - one for each thread. Nonetheless we may need to sync them at the end of each iteration.</p>
</div>
</div>
<div class="sect5">
<h6 id="_evaluation"><a class="link" href="#_evaluation">evaluation</a></h6>
<div class="ulist">
<ul>
<li>
<p>Performance tests on different dataset sizes / level of concurrency</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_future_improvements"><a class="link" href="#_future_improvements">Future Improvements</a></h5>
<div class="ulist">
<ul>
<li>
<p>we might scale up the ranks to ints for faster multiplication.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_details"><a class="link" href="#_details">Details</a></h5>
<div class="paragraph">
<p>Partition based parallel PageRank based on "An Efficient Partition-Based Parallel PageRank Algorithm" [1]-</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Each partition thread has its local array of only the nodes that it is responsible for,
not for all nodes. Combined, all partitions hold all page rank scores for every node once.
Instead of writing partition files and transferring them across the network
(as done in the paper since they were concerned with parallelising across multiple nodes),
we use integer arrays to write the results to.
The actual score is upscaled from a double to an integer by multiplying it with {@code 100_000}.</p>
</li>
<li>
<p>To avoid contention by writing to a shared array, we partition the result array.</p>
</li>
<li>
<p>During execution, the scores arrays are shaped like this:</p>
<div class="literalblock">
<div class="content">
<pre>[ executing partition ] -&gt; [ calculated partition ] -&gt; [ local page rank scores ]</pre>
</div>
</div>
</li>
<li>
<p>Each single partition writes in a partitioned array, calculation the scores
for every receiving partition. A single partition only sees:</p>
<div class="literalblock">
<div class="content">
<pre>[ calculated partition ] -&gt; [ local page rank scores ]</pre>
</div>
</div>
</li>
<li>
<p>The coordinating thread then builds the transpose of all written partitions from every partition:</p>
<div class="literalblock">
<div class="content">
<pre>[ calculated partition ] -&gt; [ executing partition ] -&gt; [ local page rank scores ]</pre>
</div>
</div>
</li>
<li>
<p>This step does not happen in parallel, but does not involve extensive copying.
The local page rank scores needn&#8217;t be copied, only the partitioning arrays.
All in all, {@code concurrency^2} array element reads and assignments have to
be performed.</p>
</li>
<li>
<p>For the next iteration, every partition first updates its scores, in parallel.
A single partition now sees:</p>
<div class="literalblock">
<div class="content">
<pre>[ executing partition ] -&gt; [ local page rank scores ]</pre>
</div>
</div>
</li>
<li>
<p>That is, a list of all calculated scores for it self, grouped by the partition that
calculated these scores.
This means, most of the synchronization happens in parallel, too.</p>
</li>
<li>
<p>Partitioning is not done by number of nodes but by the accumulated degree 
as described in "Fast Parallel PageRank: A Linear System Approach" [2].
Every partition should have about the same number of relationships to operate on.</p>
</li>
<li>
<p>This is done to avoid having one partition with super nodes and instead have
all partitions run in approximately equal time.
Smaller partitions are merged down until we have at most {@code concurrency} partitions,
in order to batch partitions and keep the number of threads in use predictable/configurable.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>[1]: An Efficient Partition-Based Parallel PageRank Algorithm
[2]: &lt;a href="https://www.cs.purdue.edu/homes/dgleich/</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_betweenness_centrality_2"><a class="link" href="#_betweenness_centrality_2">Betweenness Centrality</a></h3>
<div class="sect3">
<h4 id="_implementation_details_2"><a class="link" href="#_implementation_details_2">Implementation Details</a></h4>
<div class="paragraph">
<p>In graph theory, betweenness centrality is a measure of centrality in a graph based on shortest paths. For every pair of nodes in a connected graph, there exists at least one shortest path between the nodes such that either the number of relationships that the path passes through (for unweighted graphs) or the sum of the weights of the relationships (for weighted graphs) is minimized. The betweenness centrality for each vertex is the number of these shortest paths that pass through the vertex.</p>
</div>
<div class="sect4">
<h5 id="_progress_2"><a class="link" href="#_progress_2">Progress</a></h5>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10003; adapt apoc-procedure to algorithm-api</p>
</li>
<li>
<p>&#10003; implement procedure</p>
</li>
<li>
<p>&#10003; tests</p>
</li>
<li>
<p>&#10003; relationship case tests</p>
</li>
<li>
<p>&#10003; simple benchmark</p>
</li>
<li>
<p>&#10003; benchmark on bigger graphs</p>
</li>
<li>
<p>&#10003; parallelization</p>
</li>
<li>
<p>&#10003; evaluation</p>
</li>
<li>
<p>&#10003; documentation</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_details_2"><a class="link" href="#_details_2">Details</a></h5>
<div class="sect5">
<h6 id="_algo_betweenness"><a class="link" href="#_algo_betweenness">algo.betweenness</a></h6>
<div class="ulist">
<ul>
<li>
<p>implementation of brandes-bc algorithm and nodePartitioning extension</p>
</li>
<li>
<p><a href="http://www.algo.uni-konstanz.de/publications/b-fabc-01.pdf" class="bare">http://www.algo.uni-konstanz.de/publications/b-fabc-01.pdf</a></p>
</li>
<li>
<p>if <code>concurrency</code> parameter is set (and &gt;1) ParallelBetweennessCentrality is used</p>
</li>
<li>
<p>ParallelBC spawns N(given by the concurrency param) concurrent threads for calculation where each one
calculates the BC for one node at a time</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_algo_betweenness_exp1"><a class="link" href="#_algo_betweenness_exp1">algo.betweenness.exp1</a></h6>
<div class="ulist">
<ul>
<li>
<p>brandes-like algorithm which uses successor sets instead of predecessor sets</p>
</li>
<li>
<p>The algorithm is based on Brandes definition but with some changes
regarding the dependency-accumulation step.</p>
</li>
<li>
<p><a href="http://cass-mt.pnnl.gov/docs/pubs/georgiatechlbnlpnnlfastbc-mtaap2009.pdf" class="bare">http://cass-mt.pnnl.gov/docs/pubs/georgiatechlbnlpnnlfastbc-mtaap2009.pdf</a></p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_algo_betweenness_sampled"><a class="link" href="#_algo_betweenness_sampled">algo.betweenness.sampled.*</a></h6>
<div class="ulist">
<ul>
<li>
<p>Calculates betweenness-dependencies on a subset of pivot nodes (instead of all nodes). Up to now 2 randomization strategies are implemented which can be set using the optional argument strategy:</p>
</li>
<li>
<p>random selection(default): strategy:'random': (takes optional argument probability:double(0-1) or log10(N) / e^2 as default)</p>
</li>
<li>
<p>degree based randomization: strategy:'degree': (makes dense nodes more likely)</p>
</li>
<li>
<p>optional Arguments: maxDepth:int</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_closeness_centrality_2"><a class="link" href="#_closeness_centrality_2">Closeness Centrality</a></h3>
<div class="sect3">
<h4 id="_implementation_details_3"><a class="link" href="#_implementation_details_3">Implementation Details</a></h4>
<div class="paragraph">
<p><em>Closeness Centrality</em> of a node is a measure of centrality in a network, calculated as the sum of the length of the shortest paths between the node and all other nodes in the graph.
Thus the more central a node is, the closer it is to all other nodes.</p>
</div>
<div class="sect4">
<h5 id="_details_3"><a class="link" href="#_details_3">Details</a></h5>
<div class="ulist">
<ul>
<li>
<p>use <code>org.neo4j.graphalgo.impl.msbfs.MultiSourceBFS</code> for BFS</p>
</li>
<li>
<p>MSBFS gives depth and number of sources.</p>
</li>
<li>
<p>in this scheme the farness can be calculated as follows</p>
<div class="literalblock">
<div class="content">
<pre>farness(v) = farness(v) + numberOfSources(v) * depth(v)</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_harmonic_centrality_2"><a class="link" href="#_harmonic_centrality_2">Harmonic Centrality</a></h3>
<div class="sect3">
<h4 id="_implementation_details_4"><a class="link" href="#_implementation_details_4">Implementation Details</a></h4>
<div class="paragraph">
<p>&#8230;&#8203;</p>
</div>
</div>
<div class="sect3">
<h4 id="_details_4"><a class="link" href="#_details_4">Details</a></h4>
<div class="ulist">
<ul>
<li>
<p>use <code>org.neo4j.graphalgo.impl.msbfs.MultiSourceBFS</code> for BFS</p>
</li>
<li>
<p>MSBFS gives depth and number of sources.</p>
</li>
<li>
<p>in this scheme the farness can be calculated as follows</p>
<div class="literalblock">
<div class="content">
<pre>inverseFarness(v) = inverseFarness(v) + numberOfSources(v) * (1/depth(v))</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_minimum_weight_spanning_tree_2"><a class="link" href="#_minimum_weight_spanning_tree_2">Minimum Weight Spanning Tree</a></h3>
<div class="sect3">
<h4 id="_implementation_details_5"><a class="link" href="#_implementation_details_5">Implementation Details</a></h4>
<div class="paragraph">
<p>A <em>Minimum Weight Spanning Tree</em> is a acyclic undirected graph which consists of all connected nodes and whose relationship weights are minimal. It can be used to cluster the graph (KMeans). Our current approach uses <em>Prim&#8217;s Algorithm</em> to calculate the MST starting at a given node. This might not cover the whole graph. But if the nodes are connected the MST is always identical regardless at which node the execution starts.</p>
</div>
<div class="sect4">
<h5 id="_progress_3"><a class="link" href="#_progress_3">Progress</a></h5>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10003; single threaded implementation</p>
</li>
<li>
<p>&#10003; tests</p>
</li>
<li>
<p>&#10003; simple benchmark</p>
</li>
<li>
<p>&#10003; implement procedure</p>
</li>
<li>
<p>&#10003; benchmark on bigger graphs</p>
</li>
<li>
<p>[?] parallelization</p>
</li>
<li>
<p>&#10063; evaluation</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_requirements_2"><a class="link" href="#_requirements_2">Requirements</a></h5>
<div class="paragraph">
<p><code>BothRelationshipIterator</code> &amp; <code>Weights</code></p>
</div>
</div>
<div class="sect4">
<h5 id="_data_structured_involved_2"><a class="link" href="#_data_structured_involved_2">Data structured involved</a></h5>
<div class="ulist">
<ul>
<li>
<p><code>org.neo4j.graphalgo.core.utils.container.UndirectedTree</code> as container for efficient splitting and iterate</p>
</li>
<li>
<p>An int-based Fibonacci Heap priority queue.</p>
</li>
<li>
<p>Container for visited state</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_todo_2"><a class="link" href="#_todo_2">ToDo</a></h5>
<div class="sect5">
<h6 id="_benchmark"><a class="link" href="#_benchmark">benchmark</a></h6>
<div class="paragraph">
<p>Implement benchmark on big graph</p>
</div>
</div>
<div class="sect5">
<h6 id="_parallelization_2"><a class="link" href="#_parallelization_2">parallelization</a></h6>

</div>
<div class="sect5">
<h6 id="_evaluation_2"><a class="link" href="#_evaluation_2">evaluation</a></h6>
<div class="ulist">
<ul>
<li>
<p>Performance tests on different dataset sizes / level of concurrency</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_single_shortest_path"><a class="link" href="#_single_shortest_path">Single Shortest Path</a></h3>
<div class="sect3">
<h4 id="_implementation_details_6"><a class="link" href="#_implementation_details_6">Implementation Details</a></h4>
<div class="paragraph">
<p>A <em>Single Source Shortest Path</em> algorithms calculates a path between a pair of nodes whose summed weights are minimal. A common algorithm used is Dijkstra. <em>All Pairs Shortest Path</em> on the other hand calculates a shortest path forest containing all paths between the nodes in the graph. An algorithm to solve this is Floyd Warshall or Parallel Johnson&#8217;s algorithm.</p>
</div>
<div class="sect4">
<h5 id="_progress_4"><a class="link" href="#_progress_4">Progress</a></h5>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10003; single threaded implementation</p>
</li>
<li>
<p>&#10003; tests</p>
</li>
<li>
<p>&#10003; simple benchmark</p>
</li>
<li>
<p>&#10003; implement procedure</p>
</li>
<li>
<p>&#10063; benchmark on bigger graphs</p>
</li>
<li>
<p>&#10063; parallelization</p>
</li>
<li>
<p>&#10063; evaluation</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_requirements_3"><a class="link" href="#_requirements_3">Requirements</a></h5>
<div class="paragraph">
<p><code>(Outgoing)RelationshipIterator</code> &amp; <code>Weights</code></p>
</div>
</div>
<div class="sect4">
<h5 id="_data_structured_involved_3"><a class="link" href="#_data_structured_involved_3">Data structured involved</a></h5>
<div class="ulist">
<ul>
<li>
<p>An int-based Fibonacci Heap which implements an efficient priority queue.</p>
</li>
<li>
<p>Different Container for Costs / visited state / paths</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_todo_3"><a class="link" href="#_todo_3">ToDo</a></h5>
<div class="sect5">
<h6 id="_benchmark_2"><a class="link" href="#_benchmark_2">benchmark</a></h6>
<div class="paragraph">
<p>Implement benchmark on big graph</p>
</div>
</div>
<div class="sect5">
<h6 id="_parallelization_3"><a class="link" href="#_parallelization_3">parallelization</a></h6>
<div class="paragraph">
<p>Parallizing <em>All Pairs Shortest Path</em> might be easy using Dijkstra on each thread for a different node. An easy approach for <em>Single Source SP</em> may use two threads. One starting at the start-node, one at the end-node. The first wins. [More](<a href="https://www.cs.rice.edu/~vs3/comp422/lecture-notes/comp422-lec24-s08-v2.pdf" class="bare">https://www.cs.rice.edu/~vs3/comp422/lecture-notes/comp422-lec24-s08-v2.pdf</a>)</p>
</div>
</div>
<div class="sect5">
<h6 id="_evaluation_3"><a class="link" href="#_evaluation_3">evaluation</a></h6>
<div class="ulist">
<ul>
<li>
<p>Performance tests on different dataset sizes / level of concurrency</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_details_5"><a class="link" href="#_details_5">Details</a></h5>
<div class="sect5">
<h6 id="_algo_shortestpath"><a class="link" href="#_algo_shortestpath">algo.shortestPath</a></h6>
<div class="ulist">
<ul>
<li>
<p>Dijkstra single source shortest path algorithm</p>
</li>
<li>
<p>The algorithm computes a shortest path on weighted graphs
between a given start and target-NodeId. It returns result tuples of [nodeId, distance] of each node
in the path</p>
</li>
<li>
<p>there may be more then one shortest path, algo returns only one</p>
</li>
<li>
<p>if initialized with an not-existing weight-property and a defaultWeight of 1.0 the resulting path is minimal in
terms of count of nodes in the path.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_algo_shortestpaths"><a class="link" href="#_algo_shortestpaths">algo.shortestPaths</a></h6>
<div class="ulist">
<ul>
<li>
<p>Dijkstra single source shortest path algorithm</p>
</li>
<li>
<p>returns minimum distance to <strong>all other nodes</strong></p>
</li>
<li>
<p>if initialized with an not-existing weight-property and a defaultWeight of 1.0 the resulting path is minimal in terms of count of nodes in the path.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_algo_shortestpath_deltastepping"><a class="link" href="#_algo_shortestpath_deltastepping">algo.shortestPath.deltaStepping</a></h6>
<div class="paragraph">
<p>TODO naming!?
- parallel non-negative single source shortest path algorithm for weighted graphs
- It can be tweaked using the delta-parameter which controls the grade of concurrency.
- returns minimum distance to <strong>all other nodes</strong>
- if initialized with an non-existing weight-property and a defaultWeight of 1.0 its result can be interpreted as
 the number of nodes to reach the target</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_all_pairs_shortest_path_2"><a class="link" href="#_all_pairs_shortest_path_2">All Pairs Shortest Path</a></h3>
<div class="sect3">
<h4 id="_references_12"><a class="link" href="#_references_12">References</a></h4>
<div class="ulist">
<ul>
<li>
<p>[1] <a href="http://web.mit.edu/urban_or_book/www/book/" target="_blank">Urban Operations Research</a> - Richard C. Larson and Amedeo R. Odoni</p>
</li>
<li>
<p>[2] <a href="https://cs.uwaterloo.ca/research/tr/2011/CS-2011-21.pdf" target="_blank">REWIRE: An optimization-based framework for unstructured data center network design</a> - Andrew R. Curtis, Tommy Carpenter, Mustafa Elsheikh, Alejandro Lpez-Ortiz, S. Keshav</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_implementation_details_7"><a class="link" href="#_implementation_details_7">Implementation Details</a></h4>
<div class="sect4">
<h5 id="_details_6"><a class="link" href="#_details_6">Details</a></h5>
<div class="sect5">
<h6 id="_algo_allshortestpaths_stream"><a class="link" href="#_algo_allshortestpaths_stream">algo.allShortestPaths.stream</a></h6>
<div class="ulist">
<ul>
<li>
<p>returns a stream of source-target node to distance tuples for each pair of nodes</p>
</li>
<li>
<p>Since all nodeId&#8217;s have already been ordered by the idMapping we can use an integer
instead of a queue which just count&#8217;s up for each startNodeId as long as it is
&lt; nodeCount.</p>
</li>
<li>
<p>Each thread tries to take one int from the counter at one time and starts its computation on it.</p>
</li>
<li>
<p>The {@link AllShortestPaths#concurrency} value determines the count of workers that should be spawned.</p>
</li>
<li>
<p>Due to the high memory footprint the result set would have we emit each result into
a blocking queue. The result stream takes elements from the queue while the workers
add elements to it.</p>
</li>
<li>
<p>The result stream is limited by N^2. If the stream gets closed prematurely the workers get closed too.</p>
</li>
<li>
<p>writeback not supported!</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_triangle_count"><a class="link" href="#_triangle_count">Triangle Count</a></h3>
<div class="sect3">
<h4 id="_implementation_details_8"><a class="link" href="#_implementation_details_8">Implementation Details</a></h4>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10003; single threaded implementation</p>
</li>
<li>
<p>&#10003; tests</p>
</li>
<li>
<p>&#10063; edge case tests</p>
</li>
<li>
<p>&#10003; implement procedure</p>
</li>
<li>
<p>&#10003; simple benchmark</p>
</li>
<li>
<p>&#10003; benchmark on bigger graphs</p>
</li>
<li>
<p>&#10003; parallelization</p>
</li>
<li>
<p>&#10003; evaluation</p>
</li>
<li>
<p>&#10003; documentation</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_details_7"><a class="link" href="#_details_7">Details</a></h5>
<div class="paragraph">
<p><em>algo.triangle.stream(..)</em> returns a Stream of Triples with nodeIds for each triangle.</p>
</div>
<div class="paragraph">
<p><em>algo.triangleCount(..)</em> counts the number of triangles a node is member of and writes it back.
It also counts the triangle in the whole graph and returns it in the Stats</p>
</div>
<div class="paragraph">
<p><em>algo.triangleCount.stream(..)</em> counts number of triangles a node is member of and returns
a stream with nodeId and triangleCount</p>
</div>
<div class="paragraph">
<p><strong>Note</strong></p>
</div>
<div class="paragraph">
<p><strong>sum(triangleCount) == triangleCount * 3</strong> because every triangle adds 1 to each of its 3 nodes.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_label_propagation"><a class="link" href="#_label_propagation">Label Propagation</a></h3>
<div class="sect3">
<h4 id="_implementation_details_9"><a class="link" href="#_implementation_details_9">Implementation Details</a></h4>
<div class="paragraph">
<p><em>Label Propagation</em> is a graph partitioning algorithm already implemented in current apoc-procedures.</p>
</div>
<div class="sect4">
<h5 id="_progress_5"><a class="link" href="#_progress_5">Progress</a></h5>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10003; adapt apoc-procedure to algorithm api</p>
</li>
<li>
<p>&#10003; single threaded implementation</p>
</li>
<li>
<p>&#10003; tests</p>
</li>
<li>
<p>&#10063; edge case tests</p>
</li>
<li>
<p>&#10003; implement procedure</p>
</li>
<li>
<p>&#10003; simple benchmark</p>
</li>
<li>
<p>&#10003; benchmark on bigger graphs</p>
</li>
<li>
<p>&#10003; parallelization</p>
</li>
<li>
<p>&#10003; evaluation</p>
</li>
<li>
<p>&#10003; documentation</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_todo_4"><a class="link" href="#_todo_4">TODO</a></h5>
<div class="ulist">
<ul>
<li>
<p>adapt existing procedure to algorithm api</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_louvain"><a class="link" href="#_louvain">Louvain</a></h3>
<div class="sect3">
<h4 id="_implementation_details_10"><a class="link" href="#_implementation_details_10">Implementation Details</a></h4>
<div class="paragraph">
<p><em>Louvain</em> is an algorithm for detecting graph partitions in networks that relies upon a heuristic for maximizing the modularity.</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10003; single threaded implementation</p>
</li>
<li>
<p>&#10003; tests</p>
</li>
<li>
<p>&#10063; edge case tests</p>
</li>
<li>
<p>&#10003; implement procedure</p>
</li>
<li>
<p>&#10003; simple benchmark</p>
</li>
<li>
<p>&#10003; benchmark on bigger graphs</p>
</li>
<li>
<p>&#10003; parallelization</p>
</li>
<li>
<p>&#10063; evaluation</p>
</li>
<li>
<p>&#10003; documentation</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_details_8"><a class="link" href="#_details_8">Details</a></h5>

</div>
</div>
</div>
<div class="sect2">
<h3 id="_weakly_connected_components"><a class="link" href="#_weakly_connected_components">Weakly Connected Components</a></h3>
<div class="sect3">
<h4 id="_implementation_details_11"><a class="link" href="#_implementation_details_11">Implementation Details</a></h4>
<div class="paragraph">
<p><em>Connected Components</em> or <em>UnionFind</em> basically finds sets of connected nodes where each node is reachable from any other node in the same set. One implementation also evaluates a Predicate on each relation which allows partitioning of the graph based on Relationships and Properties.</p>
</div>
<div class="sect4">
<h5 id="_progress_6"><a class="link" href="#_progress_6">Progress</a></h5>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10003; single threaded implementation</p>
</li>
<li>
<p>&#10003; tests</p>
</li>
<li>
<p>&#10003; simple benchmark</p>
</li>
<li>
<p>&#10003; implement procedure</p>
</li>
<li>
<p>&#10003; benchmark on bigger graphs</p>
</li>
<li>
<p>&#10003; parallelization</p>
</li>
<li>
<p>&#10003; evaluation</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_requirements_4"><a class="link" href="#_requirements_4">Requirements</a></h5>
<div class="paragraph">
<p><code>AllRelationshipIterator</code> &amp; <code>Weights</code></p>
</div>
</div>
<div class="sect4">
<h5 id="_data_structured_involved_4"><a class="link" href="#_data_structured_involved_4">Data structured involved</a></h5>
<div class="paragraph">
<p>We use a disjoint-set-structure which is based on a parent-array-tree. The DSS can be used to efficiently ask if two nodes are reachable by each other. [More](<a href="https://en.wikipedia.org/wiki/Disjoint-set_data_structure" class="bare">https://en.wikipedia.org/wiki/Disjoint-set_data_structure</a>)</p>
</div>
</div>
<div class="sect4">
<h5 id="_todo_5"><a class="link" href="#_todo_5">ToDo</a></h5>
<div class="sect5">
<h6 id="_benchmark_3"><a class="link" href="#_benchmark_3">benchmark</a></h6>
<div class="paragraph">
<p>Implement benchmark on big graph &amp;</p>
</div>
<div class="ulist">
<ul>
<li>
<p>stream nodeId-setId pairs</p>
</li>
<li>
<p>calculate setSize-setCount</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_parallelization_4"><a class="link" href="#_parallelization_4">parallelization</a></h6>
<div class="paragraph">
<p>One approach to parallelize <em>UnionFind</em> might be <em>relationship partitioning</em> where each thread performs the execution into it&#8217;s own DSS instance on a subset of relationships. So each thread calculates a distinct set of unions. Later we can merge each DSS pairwise which can also be perfomed in parallel. Nonetheless the memory consumption might be high due to the preallocated array in DSS. We could also switch to a growing container if this is a problem.</p>
</div>
</div>
<div class="sect5">
<h6 id="_evaluation_4"><a class="link" href="#_evaluation_4">evaluation</a></h6>
<div class="ulist">
<ul>
<li>
<p>Performance tests on different dataset sizes / level of concurrency</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_details_9"><a class="link" href="#_details_9">Details</a></h5>
<div class="ulist">
<ul>
<li>
<p>writes a cluster-id to each node representing the a connected component where each node
is reachable from any other node</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_algo_unionfind"><a class="link" href="#_algo_unionfind">algo.unionFind</a></h6>
<div class="ulist">
<ul>
<li>
<p>if a threshold configuration parameter is supplied only relationships with a property value higher then the threshold
are merged</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_algo_unionfind_queue"><a class="link" href="#_algo_unionfind_queue">algo.unionFind.queue</a></h6>
<div class="ulist">
<ul>
<li>
<p>parallel UnionFind using ExecutorService only.</p>
</li>
<li>
<p>Algorithm based on the idea that DisjointSetStruct can be built using just a partition of the nodes
which are then merged pairwise.</p>
</li>
<li>
<p>The implementation is based on a queue which acts as a buffer for each computed DSS. As long as there are
more elements on the queue the algorithm takes two, merges them and adds its result to the queue until only
1 element remains.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_algo_unionfind_forkjoinmerge"><a class="link" href="#_algo_unionfind_forkjoinmerge">algo.unionFind.forkJoinMerge</a></h6>
<div class="ulist">
<ul>
<li>
<p>Like in <strong>exp1</strong> the resulting DSS of each node-partition is merged by the ForkJoin pool while
the calculation of the DSS is done by the ExecutorService.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_algo_unionfind_forkjoin"><a class="link" href="#_algo_unionfind_forkjoin">algo.unionFind.forkJoin</a></h6>
<div class="ulist">
<ul>
<li>
<p>calculation and merge using forkJoinPool</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_strongly_connected_components"><a class="link" href="#_strongly_connected_components">Strongly Connected Components</a></h3>
<div class="sect3">
<h4 id="_implementation_details_12"><a class="link" href="#_implementation_details_12">Implementation Details</a></h4>
<div class="paragraph">
<p><em>SCC</em> is a class algorithms for finding groups of nodes where each node is directly reachable from every other node in the group. There are several algorithms to compute the SCC. Our current implementation (still in graphtest project) implements <em>Tarjan&#8217;s</em> SCC algorithm.</p>
</div>
<div class="sect4">
<h5 id="_progress_7"><a class="link" href="#_progress_7">Progress</a></h5>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p>&#10003; implement procedure</p>
</li>
<li>
<p>&#10003; tests</p>
</li>
<li>
<p>&#10003; edge case tests</p>
</li>
<li>
<p>&#10003; simple benchmark</p>
</li>
<li>
<p>&#10003; benchmark on bigger graphs</p>
</li>
<li>
<p>&#10003; parallelization</p>
</li>
<li>
<p>&#10003; evaluation</p>
</li>
<li>
<p>&#10003; documentation</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_details_10"><a class="link" href="#_details_10">Details</a></h5>
<div class="sect5">
<h6 id="_algo_scc_tarjan"><a class="link" href="#_algo_scc_tarjan">algo.scc.tarjan</a></h6>
<div class="ulist">
<ul>
<li>
<p>original <strong>recursive</strong> tarjan implementation</p>
</li>
<li>
<p>result is a cluster-id at all nodes</p>
</li>
<li>
<p>each cluster is a scc</p>
</li>
<li>
<p>Builds sets of node-Ids which represent a strongly connected component
within the graph. Also calculates minimum and maximum setSize as well
as the count of distinct sets.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_algo_scc_tunedtarjan"><a class="link" href="#_algo_scc_tunedtarjan">algo.scc.tunedTarjan</a></h6>
<div class="ulist">
<ul>
<li>
<p>also a recursive tarjan implementation</p>
</li>
<li>
<p>result is a cluster-id at all nodes</p>
</li>
<li>
<p><a href="https://pdfs.semanticscholar.org/61db/6892a92d1d5bdc83e52cc18041613cf895fa.pdf" class="bare">https://pdfs.semanticscholar.org/61db/6892a92d1d5bdc83e52cc18041613cf895fa.pdf</a></p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_algo_scc_iterative"><a class="link" href="#_algo_scc_iterative">algo.scc.iterative</a></h6>
<div class="ulist">
<ul>
<li>
<p><strong>iterative</strong> adaption of tarjan algorithm</p>
</li>
<li>
<p>result is a cluster-id at all nodes</p>
</li>
<li>
<p><a href="http://code.activestate.com/recipes/578507-strongly-connected-components-of-a-directed-graph/" class="bare">http://code.activestate.com/recipes/578507-strongly-connected-components-of-a-directed-graph/</a></p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_algo_scc_multistep"><a class="link" href="#_algo_scc_multistep">algo.scc.multistep</a></h6>
<div class="ulist">
<ul>
<li>
<p>parallel scc algorithm</p>
</li>
<li>
<p>composition of several scc algorithms (FWBW, coloring, tarjan)</p>
</li>
<li>
<p>uses FWBW + coloring to find big scc&#8217;s</p>
</li>
<li>
<p>starts simple tarjan once the cutoff threshold is reached</p>
</li>
<li>
<p><a href="http://www.sandia.gov/~srajama/publications/BFS_and_Coloring.pdf" class="bare">http://www.sandia.gov/~srajama/publications/BFS_and_Coloring.pdf</a></p>
</li>
</ul>
</div>
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.13/css/jquery.dataTables.min.css">
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://cdn.datatables.net/1.10.13/js/jquery.dataTables.min.js"></script>
<script>
$(document).ready(function() {
    $('#table-all').DataTable();
} );
</script>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2018-01-31 14:07:53 UTC
</div>
</div>
</body>
</html>